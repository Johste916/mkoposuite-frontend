import{r as d,j as e,b as m}from"./index-1gkhjes9.js";function w(a){if(!a)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(a))return a;try{const l=new Date(a);return Number.isNaN(l.getTime())?"":l.toISOString().slice(0,10)}catch{return""}}function O(){const[a,l]=d.useState(null),[i,f]=d.useState(null),[x,c]=d.useState(""),[u,b]=d.useState(!1),[v,p]=d.useState(!0),o=async()=>{var t,n,r,h,j,N,k;c(""),p(!0);try{const s=await m.get("/tenants/me"),E=await m.get("/tenants/me/entitlements"),D={...s.data,trialEndsAt:w((t=s.data)==null?void 0:t.trialEndsAt),planCode:((n=s.data)==null?void 0:n.planCode)||"basic",graceDays:typeof((r=s.data)==null?void 0:r.graceDays)=="number"?s.data.graceDays:7,autoDisableOverdue:!!((h=s.data)!=null&&h.autoDisableOverdue),billingEmail:((j=s.data)==null?void 0:j.billingEmail)||""};l(D),f(E.data||{})}catch(s){c(((k=(N=s==null?void 0:s.response)==null?void 0:N.data)==null?void 0:k.error)||s.message)}finally{p(!1)}};d.useEffect(()=>{o()},[]);const y=async()=>{var t,n;if(a){b(!0),c("");try{await m.patch("/tenants/me",{planCode:a.planCode,trialEndsAt:a.trialEndsAt||null,autoDisableOverdue:!!a.autoDisableOverdue,graceDays:Number(a.graceDays??0),billingEmail:a.billingEmail||null}),await o()}catch(r){c(((n=(t=r==null?void 0:r.response)==null?void 0:t.data)==null?void 0:n.error)||r.message)}finally{b(!1)}}};if(x)return e.jsxs("div",{className:"p-4 text-sm text-rose-600 dark:text-rose-400",children:["Error: ",x]});if(v||!a||!i)return e.jsx("div",{className:"p-4 text-sm text-slate-500 dark:text-slate-400",children:"Loading…"});const g=i!=null&&i.modules&&typeof i.modules=="object"?i.modules:{};return e.jsxs("div",{className:"bg-white dark:bg-slate-900 border dark:border-slate-800 rounded-2xl p-4 md:p-6 space-y-5",children:[e.jsxs("header",{children:[e.jsx("h1",{className:"text-xl font-semibold text-slate-900 dark:text-slate-100",children:"Organization"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Plan, tenant details and entitlements"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-5 text-sm",children:[e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"block text-xs text-slate-500 dark:text-slate-400 mb-1",children:"Plan"}),e.jsxs("select",{value:a.planCode,onChange:t=>l({...a,planCode:t.target.value}),className:"ms-select w-full h-10",children:[e.jsx("option",{value:"basic",children:"Basic"}),e.jsx("option",{value:"pro",children:"Pro"}),e.jsx("option",{value:"premium",children:"Premium"})]})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"block text-xs text-slate-500 dark:text-slate-400 mb-1",children:"Trial ends"}),e.jsx("input",{type:"date",value:a.trialEndsAt||"",onChange:t=>l({...a,trialEndsAt:t.target.value}),className:"ms-input h-10 w-full"})]}),e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:!!a.autoDisableOverdue,onChange:t=>l({...a,autoDisableOverdue:t.target.checked}),className:"h-4 w-4"}),e.jsx("span",{children:"Auto suspend overdue"})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"block text-xs text-slate-500 dark:text-slate-400 mb-1",children:"Grace days"}),e.jsx("input",{type:"number",min:0,value:a.graceDays??7,onChange:t=>l({...a,graceDays:Number(t.target.value)}),className:"ms-input h-10 w-full"})]}),e.jsxs("label",{className:"block md:col-span-2",children:[e.jsx("span",{className:"block text-xs text-slate-500 dark:text-slate-400 mb-1",children:"Billing email"}),e.jsx("input",{type:"email",value:a.billingEmail||"",onChange:t=>l({...a,billingEmail:t.target.value}),className:"ms-input h-10 w-full"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:y,disabled:u,className:"ms-btn h-9 px-3 text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-60",children:u?"Saving…":"Save"}),e.jsx("button",{onClick:o,className:"ms-btn h-9 px-3",children:"Refresh"})]}),e.jsxs("section",{className:"pt-3 border-t border-slate-200 dark:border-slate-800",children:[e.jsx("h2",{className:"font-semibold mb-2 text-slate-900 dark:text-slate-100",children:"Entitlements"}),Object.keys(g).length===0?e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"No entitlements found for this tenant."}):e.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-2 text-sm",children:Object.entries(g).map(([t,n])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-48 shrink-0 capitalize text-slate-700 dark:text-slate-200",children:t.replace(/_/g," ")}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${n?"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-300":"bg-slate-100 text-slate-600 dark:bg-slate-800 dark:text-slate-300"}`,children:n?"enabled":"disabled"})]},t))})]})]})}export{O as default};
