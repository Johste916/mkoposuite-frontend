import{u as f,i as N,r as n,g as p,j as e}from"./index-DyAnIdDJ.js";function M(){const b=f(),{id:o}=N(),i=!!o,[u,x]=n.useState(!1),[g,h]=n.useState(i),[j,c]=n.useState(""),[r,v]=n.useState({name:"",code:"",interestRate:"",interestPeriod:"monthly",term:"",termUnit:"months",principalMin:"",principalMax:"",fees:"",active:!0});n.useEffect(()=>{let s=!1;return(async()=>{var l,d;if(i)try{h(!0);const{data:a}=await p.get(`/loan-products/${o}`);if(s)return;v(m=>({...m,name:a.name??"",code:a.code??"",interestRate:a.interestRate??"",interestPeriod:a.interestPeriod??"monthly",term:a.term??"",termUnit:a.termUnit??"months",principalMin:a.principalMin??"",principalMax:a.principalMax??"",fees:a.fees??"",active:a.active??!0}))}catch(a){s||c(((d=(l=a==null?void 0:a.response)==null?void 0:l.data)==null?void 0:d.message)||"Failed to load product")}finally{s||h(!1)}})(),()=>{s=!0}},[o,i]);const t=s=>{const{name:l,value:d,type:a,checked:m}=s.target;v(k=>({...k,[l]:a==="checkbox"?m:d}))},y=async s=>{var l,d;s.preventDefault(),c(""),x(!0);try{const a={...r,interestRate:Number(r.interestRate)||0,term:Number(r.term)||0,principalMin:Number(r.principalMin)||0,principalMax:Number(r.principalMax)||0,fees:Number(r.fees)||0};i?await p.put(`/loan-products/${o}`,a):await p.post("/loan-products",a),b("/loans/products",{replace:!0})}catch(a){c(((d=(l=a==null?void 0:a.response)==null?void 0:l.data)==null?void 0:d.message)||"Failed to save product")}finally{x(!1)}};return e.jsxs("div",{className:"max-w-3xl",children:[e.jsx("h1",{className:"text-xl font-semibold mb-4",children:i?"Edit Loan Product":"New Loan Product"}),j&&e.jsx("div",{className:"mb-4 rounded-md border border-rose-200 bg-rose-50 text-rose-700 px-3 py-2 text-sm",children:j}),e.jsxs("form",{onSubmit:y,className:"space-y-4 rounded-xl border border-slate-200 dark:border-slate-800 p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Name"}),e.jsx("input",{name:"name",value:r.name,onChange:t,required:!0,className:"w-full rounded-md border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 px-3 py-2",placeholder:"e.g. SME Working Capital"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Code"}),e.jsx("input",{name:"code",value:r.code,onChange:t,className:"w-full rounded-md border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 px-3 py-2",placeholder:"e.g. SME-WC"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Interest Rate (%)"}),e.jsx("input",{name:"interestRate",value:r.interestRate,onChange:t,type:"number",step:"0.01",min:"0",className:"w-full rounded-md border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Interest Period"}),e.jsxs("select",{name:"interestPeriod",value:r.interestPeriod,onChange:t,className:"w-full rounded-md border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 px-3 py-2",children:[e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Term"}),e.jsx("input",{name:"term",value:r.term,onChange:t,type:"number",min:"0",className:"w-full rounded-md border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 px-3 py-2",placeholder:"e.g. 12"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Term Unit"}),e.jsxs("select",{name:"termUnit",value:r.termUnit,onChange:t,className:"w-full rounded-md border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 px-3 py-2",children:[e.jsx("option",{value:"months",children:"Months"}),e.jsx("option",{value:"weeks",children:"Weeks"}),e.jsx("option",{value:"days",children:"Days"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Principal Min"}),e.jsx("input",{name:"principalMin",value:r.principalMin,onChange:t,type:"number",min:"0",className:"w-full rounded-md border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 px-3 py-2",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Principal Max"}),e.jsx("input",{name:"principalMax",value:r.principalMax,onChange:t,type:"number",min:"0",className:"w-full rounded-md border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 px-3 py-2",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Fees (Total)"}),e.jsx("input",{name:"fees",value:r.fees,onChange:t,type:"number",min:"0",step:"0.01",className:"w-full rounded-md border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 px-3 py-2",placeholder:"0.00"})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-6",children:[e.jsx("input",{id:"active",name:"active",type:"checkbox",checked:r.active,onChange:t,className:"h-4 w-4"}),e.jsx("label",{htmlFor:"active",className:"text-sm",children:"Active"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[e.jsx("button",{type:"submit",disabled:u||g,className:"px-4 py-2 rounded-md bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",children:u?"Saving...":i?"Update Product":"Create Product"}),e.jsx("button",{type:"button",onClick:()=>b(-1),className:"px-3 py-2 rounded-md border border-slate-200 dark:border-slate-700",children:"Cancel"})]})]})]})}export{M as default};
