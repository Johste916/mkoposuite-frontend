import{r as i,j as e,b as h}from"./index-nRfDEWc-.js";function w(){const[g,m]=i.useState(!0),[x,u]=i.useState(!1),[v,r]=i.useState(""),[p,c]=i.useState(""),[l,o]=i.useState({plan:"free",currency:"USD",status:"active",billingEmail:"",invoiceEmails:[],invoiceNotes:"",autoRenew:!1,paymentProvider:"",paymentMethod:"",nextInvoiceDate:""}),b=async()=>{m(!0),r(""),c("");try{const{data:a}=await h.get("/account/billing"),s=(a==null?void 0:a.settings)||{};o({plan:s.plan||"free",currency:s.currency||"USD",status:s.status||"active",billingEmail:s.billingEmail||"",invoiceEmails:Array.isArray(s.invoiceEmails)?s.invoiceEmails:[],invoiceNotes:s.invoiceNotes||"",autoRenew:!!s.autoRenew,paymentProvider:s.paymentProvider||"",paymentMethod:s.paymentMethod||"",nextInvoiceDate:s.nextInvoiceDate||""})}catch{r("Failed to load billing settings")}finally{m(!1)}};i.useEffect(()=>{b()},[]);const N=async()=>{var a,s;u(!0),r(""),c("");try{const n={...l,invoiceEmails:l.invoiceEmails.filter(Boolean)},{data:d}=await h.put("/account/billing",n);c("Saved.");const y=(d==null?void 0:d.settings)||{};o(f=>({...f,...y}))}catch(n){r(((s=(a=n==null?void 0:n.response)==null?void 0:a.data)==null?void 0:s.message)||"Failed to save")}finally{u(!1)}},t=(a,s)=>o(n=>({...n,[a]:s})),j=a=>t("invoiceEmails",a.split(",").map(s=>s.trim()).filter(Boolean));return g?e.jsx("div",{className:"p-4 text-sm text-slate-500",children:"Loading…"}):e.jsxs("div",{className:"max-w-2xl bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-4",children:[e.jsx("h1",{className:"text-lg font-semibold",children:"Billing"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Manage your plan, invoices, and payment methods."}),p&&e.jsx("div",{className:"mt-3 text-sm text-emerald-600",children:p}),v&&e.jsx("div",{className:"mt-3 text-sm text-rose-600",children:v}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("label",{className:"text-sm",children:[e.jsx("div",{className:"mb-1",children:"Plan"}),e.jsxs("select",{className:"w-full border rounded px-2 py-2",value:l.plan,onChange:a=>t("plan",a.target.value),children:[e.jsx("option",{value:"free",children:"Free"}),e.jsx("option",{value:"pro",children:"Pro"}),e.jsx("option",{value:"enterprise",children:"Enterprise"})]})]}),e.jsxs("label",{className:"text-sm",children:[e.jsx("div",{className:"mb-1",children:"Currency"}),e.jsx("input",{className:"w-full border rounded px-3 py-2",value:l.currency,onChange:a=>t("currency",a.target.value)})]}),e.jsxs("label",{className:"text-sm",children:[e.jsx("div",{className:"mb-1",children:"Billing Email"}),e.jsx("input",{className:"w-full border rounded px-3 py-2",value:l.billingEmail,onChange:a=>t("billingEmail",a.target.value)})]}),e.jsxs("label",{className:"text-sm",children:[e.jsx("div",{className:"mb-1",children:"Invoice Emails (comma separated)"}),e.jsx("input",{className:"w-full border rounded px-3 py-2",value:l.invoiceEmails.join(", "),onChange:a=>j(a.target.value)})]}),e.jsxs("label",{className:"text-sm sm:col-span-2",children:[e.jsx("div",{className:"mb-1",children:"Invoice Notes"}),e.jsx("textarea",{className:"w-full border rounded px-3 py-2",rows:3,value:l.invoiceNotes,onChange:a=>t("invoiceNotes",a.target.value)})]}),e.jsxs("label",{className:"text-sm",children:[e.jsx("div",{className:"mb-1",children:"Auto Renew"}),e.jsx("input",{type:"checkbox",className:"h-4 w-4 align-middle",checked:l.autoRenew,onChange:a=>t("autoRenew",a.target.checked)})," ",e.jsx("span",{className:"ml-1",children:"Enabled"})]}),e.jsxs("label",{className:"text-sm",children:[e.jsx("div",{className:"mb-1",children:"Payment Provider"}),e.jsx("input",{className:"w-full border rounded px-3 py-2",value:l.paymentProvider,onChange:a=>t("paymentProvider",a.target.value)})]}),e.jsxs("label",{className:"text-sm",children:[e.jsx("div",{className:"mb-1",children:"Payment Method (masked)"}),e.jsx("input",{className:"w-full border rounded px-3 py-2",value:l.paymentMethod,onChange:a=>t("paymentMethod",a.target.value)})]}),e.jsxs("label",{className:"text-sm",children:[e.jsx("div",{className:"mb-1",children:"Next Invoice Date (ISO)"}),e.jsx("input",{className:"w-full border rounded px-3 py-2",value:l.nextInvoiceDate||"",onChange:a=>t("nextInvoiceDate",a.target.value)})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{onClick:N,disabled:x,className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",children:x?"Saving…":"Save Changes"})})]})}export{w as default};
