import{r as s,g as u}from"./index-CeHYLxUd.js";function P({url:p,params:l={},initialPage:q=1,initialLimit:E=20}){const[i,F]=s.useState(q),[f,R]=s.useState(E),[d,C]=s.useState(l.q||""),[L,h]=s.useState(!0),[N,S]=s.useState(""),[$,g]=s.useState([]),[x,m]=s.useState(0),[J,y]=s.useState(null),b=s.useMemo(()=>({...l,page:i,limit:f,q:d||void 0}),[i,f,d,JSON.stringify(l)]),w=s.useMemo(()=>(typeof u.path=="function"?u.path:e=>{var t,a;const n=(((a=(t=u)==null?void 0:t.defaults)==null?void 0:a.baseURL)||"").replace(/\/+$/,""),c=(e||"/").replace(/^\/+/,"");return`${n}/${c}`})(p||"/"),[p]),o=s.useRef(null),A=async r=>{var e,n,c;h(!0),S("");try{const t=await u.get(w,{params:b,signal:r}),a=t==null?void 0:t.data;Array.isArray(a)?(g(a),m(a.length),y(null)):a&&Array.isArray(a.data)?(g(a.data),m(((e=a.pagination)==null?void 0:e.total)??a.data.length??0),y(a.summary??null)):(g([]),m(0),y(null))}catch(t){(t==null?void 0:t.name)!=="CanceledError"&&(t==null?void 0:t.message)!=="canceled"&&S(((c=(n=t==null?void 0:t.response)==null?void 0:n.data)==null?void 0:c.error)||t.message||"Request failed")}finally{(!r||!r.aborted)&&h(!1)}};return s.useEffect(()=>{var e,n;const r=new AbortController;return(n=(e=o.current)==null?void 0:e.abort)==null||n.call(e),o.current=r,A(r.signal),()=>r.abort()},[w,JSON.stringify(b)]),{rows:$,total:x,page:i,setPage:F,limit:f,setLimit:R,q:d,setQ:C,loading:L,error:N,summary:J,refresh:()=>{var e,n;const r=new AbortController;return(n=(e=o.current)==null?void 0:e.abort)==null||n.call(e),o.current=r,A(r.signal),()=>r.abort()}}}export{P as u};
