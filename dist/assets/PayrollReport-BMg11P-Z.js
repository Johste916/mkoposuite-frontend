import{f as w,r as t,b as u,j as e}from"./index-Y30r8o2M.js";function E(){const[y]=w(),[d,j]=t.useState(""),[n,N]=t.useState(""),[i,g]=t.useState(""),[b,S]=t.useState([]),[x,f]=t.useState([]),[o,v]=t.useState({gross:0,deductions:0,net:0}),[m,p]=t.useState(""),c=y.get("runId")||"";t.useEffect(()=>{(async()=>{try{const{data:s}=await u.get("/hr/employees",{params:{limit:500}});S((s==null?void 0:s.items)||[])}catch{}})()},[]);const h=async()=>{var s,r;p("");try{const a={from:d||void 0,to:n||void 0,employeeId:i||void 0,runId:c||void 0},{data:l}=await u.get("/hr/payroll/report",{params:a});f((l==null?void 0:l.items)||[]),v((l==null?void 0:l.summary)||{gross:0,deductions:0,net:0})}catch(a){p(((r=(s=a==null?void 0:a.response)==null?void 0:s.data)==null?void 0:r.message)||a.message)}};return t.useEffect(()=>{c&&h()},[c]),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Payroll Report"}),e.jsxs("div",{className:"bg-white border rounded-xl p-3 flex flex-wrap gap-2 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500",children:"From"}),e.jsx("input",{type:"date",className:"border rounded px-2 py-1 text-sm",value:d,onChange:s=>j(s.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500",children:"To"}),e.jsx("input",{type:"date",className:"border rounded px-2 py-1 text-sm",value:n,onChange:s=>N(s.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500",children:"Employee"}),e.jsxs("select",{className:"border rounded px-2 py-1 text-sm min-w-[220px]",value:i,onChange:s=>g(s.target.value),children:[e.jsx("option",{value:"",children:"All"}),b.map(s=>e.jsxs("option",{value:s.id,children:[s.firstName," ",s.lastName]},s.id))]})]}),e.jsx("button",{onClick:h,className:"px-3 py-2 border rounded-lg bg-white hover:bg-gray-50 text-sm",children:"Run"})]}),m&&e.jsx("div",{className:"text-red-600 text-sm",children:m}),e.jsx("div",{className:"bg-white border rounded-xl overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-600 border-b",children:[e.jsx("th",{className:"py-2 px-3",children:"Employee"}),e.jsx("th",{className:"py-2 px-3",children:"Period"}),e.jsx("th",{className:"py-2 px-3",children:"Gross"}),e.jsx("th",{className:"py-2 px-3",children:"Deductions"}),e.jsx("th",{className:"py-2 px-3",children:"Net"})]})}),e.jsx("tbody",{children:x.length===0?e.jsx("tr",{children:e.jsx("td",{className:"p-3 text-gray-500",colSpan:5,children:"No data"})}):x.map(s=>{var r;return e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2 px-3",children:((r=s.employee)==null?void 0:r.name)||s.employeeName}),e.jsx("td",{className:"py-2 px-3",children:s.periodLabel||`${s.periodFrom} â†’ ${s.periodTo}`}),e.jsxs("td",{className:"py-2 px-3",children:["TZS ",Number(s.gross||0).toLocaleString()]}),e.jsxs("td",{className:"py-2 px-3",children:["TZS ",Number(s.deductions||0).toLocaleString()]}),e.jsxs("td",{className:"py-2 px-3 font-medium",children:["TZS ",Number(s.net||0).toLocaleString()]})]},s.id)})}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"font-semibold",children:[e.jsx("td",{className:"py-2 px-3",colSpan:2,children:"Totals"}),e.jsxs("td",{className:"py-2 px-3",children:["TZS ",Number(o.gross||0).toLocaleString()]}),e.jsxs("td",{className:"py-2 px-3",children:["TZS ",Number(o.deductions||0).toLocaleString()]}),e.jsxs("td",{className:"py-2 px-3",children:["TZS ",Number(o.net||0).toLocaleString()]})]})})]})})]})}export{E as default};
