import{r as n,j as s}from"./index-DSXeOGvG.js";import{l as f,b as x,k as j,m as b}from"./banking-ByWeLOjN.js";const k="bg-white rounded-2xl shadow-sm ring-1 ring-black/5 p-5 md:p-7",y="border rounded px-3 py-2";function S(){const[u,h]=n.useState([]),[a,g]=n.useState(""),[l,i]=n.useState([]),[o,d]=n.useState(!1),[m,c]=n.useState(null);n.useEffect(()=>{f().then(h).catch(e=>c((e==null?void 0:e.normalizedMessage)||String(e)))},[]);const r=async()=>{if(!a)return i([]);d(!0),c(null);try{const e=await x(a,{reconciled:"0"});i(e||[])}catch(e){c((e==null?void 0:e.normalizedMessage)||String(e)),i([])}finally{d(!1)}};n.useEffect(()=>{r()},[a]);const p=async e=>{try{e.reconciled?await j(e.id):await b(e.id,{bankRef:e.bankRef||"",note:e.note||""}),await r()}catch(t){c((t==null?void 0:t.normalizedMessage)||String(t))}};return s.jsxs("div",{className:"p-4 md:p-6 lg:p-8",children:[s.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Bank Reconciliation"}),s.jsxs("section",{className:k,children:[s.jsxs("div",{className:"mb-3 flex items-end gap-3",children:[s.jsxs("select",{className:y,value:a,onChange:e=>g(e.target.value),children:[s.jsx("option",{value:"",children:"— choose bank —"}),u.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]}),s.jsx("button",{className:"px-3 py-2 rounded border",onClick:r,disabled:!a||o,children:o?"Loading…":"Refresh"})]}),m&&s.jsx("div",{className:"text-sm text-red-600 mb-2",children:m}),s.jsxs("ul",{className:"divide-y",children:[l.map(e=>s.jsxs("li",{className:"py-3 flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm",children:[s.jsxs("div",{className:"font-medium",children:[e.occurredAt?new Date(e.occurredAt).toLocaleString():"—"," ","- ",e.type," (",e.direction,")"]}),s.jsxs("div",{className:"text-gray-500",children:[Number(e.amount).toLocaleString()," ",e.currency||"TZS"," · Ref: ",e.reference||"—"]})]}),s.jsx("button",{onClick:()=>p(e),className:"px-3 py-1 rounded border",children:e.reconciled?"Unreconcile":"Reconcile"})]},e.id)),l.length===0&&s.jsx("li",{className:"py-6 text-center text-gray-500",children:"Nothing to reconcile"})]})]})]})}export{S as default};
