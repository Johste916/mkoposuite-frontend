import{r as s,j as a,g as c}from"./index-DSXeOGvG.js";const k=()=>{const[d,i]=s.useState([]),[u,x]=s.useState(!0),[m,p]=s.useState(""),[t,h]=s.useState({borrowerId:"",reason:"",until:""}),o=async e=>{var r,b;try{x(!0);const v=e?{signal:e}:{},l=await c.get("/borrowers/blacklist/list",v),f=Array.isArray(l.data)?l.data:((r=l.data)==null?void 0:r.items)||((b=l.data)==null?void 0:b.data)||[];i(f),p("")}catch{p("Failed to load blacklist"),i([])}finally{x(!1)}};s.useEffect(()=>{const e=new AbortController;return o(e.signal),()=>e.abort()},[]);const n=e=>h(r=>({...r,[e.target.name]:e.target.value})),g=async e=>{if(e.preventDefault(),!!t.borrowerId)try{await c.post(`/borrowers/${encodeURIComponent(t.borrowerId)}/blacklist`,{reason:t.reason||null,until:t.until||null}),h({borrowerId:"",reason:"",until:""}),await o()}catch{alert("Failed to blacklist")}},j=async e=>{try{await c.delete(`/borrowers/${encodeURIComponent(e)}/blacklist`),await o()}catch{}},w=e=>e?new Date(e).toLocaleDateString():"—",N=e=>(e==null?void 0:e.name)||`${(e==null?void 0:e.firstName)||""} ${(e==null?void 0:e.lastName)||""}`.trim()||(e==null?void 0:e.id)||"—";return a.jsxs("div",{className:"p-4 md:p-6 space-y-4 bg-[var(--bg)] text-[var(--fg)]",children:[a.jsx("h1",{className:"text-2xl font-semibold",children:"Blacklist"}),a.jsxs("form",{onSubmit:g,className:"card p-4 space-y-3 max-w-2xl",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[a.jsx("input",{name:"borrowerId",placeholder:"Borrower ID",className:"input",value:t.borrowerId,onChange:n,required:!0}),a.jsx("input",{name:"reason",placeholder:"Reason",className:"input",value:t.reason,onChange:n}),a.jsx("input",{name:"until",type:"date",className:"input",value:t.until,onChange:n})]}),a.jsx("button",{className:"inline-flex items-center px-4 py-2 rounded-lg bg-rose-600 text-white hover:bg-rose-700",children:"Add to Blacklist"})]}),a.jsx("div",{className:"card overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-[var(--table-head-bg,transparent)]",children:a.jsxs("tr",{className:"text-left text-[var(--fg)]/80",children:[a.jsx("th",{className:"px-3 py-2",children:"Borrower"}),a.jsx("th",{className:"px-3 py-2",children:"Reason"}),a.jsx("th",{className:"px-3 py-2",children:"Until"}),a.jsx("th",{className:"px-3 py-2 text-right pr-4",children:"Actions"})]})}),a.jsx("tbody",{children:u?a.jsx("tr",{children:a.jsx("td",{className:"p-4 muted",colSpan:4,children:"Loading…"})}):m?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-rose-600 dark:text-rose-400",colSpan:4,children:m})}):d.length===0?a.jsx("tr",{children:a.jsx("td",{className:"p-4 muted",colSpan:4,children:"No blacklisted borrowers."})}):d.map(e=>a.jsxs("tr",{className:"border-t border-[var(--border)] odd:bg-[var(--table-row-odd,transparent)] even:bg-[var(--table-row-even,transparent)]",children:[a.jsx("td",{className:"px-3 py-2",children:N(e)}),a.jsx("td",{className:"px-3 py-2",children:e.reason||"—"}),a.jsx("td",{className:"px-3 py-2",children:w(e.until)}),a.jsx("td",{className:"px-3 py-2 text-right",children:a.jsx("button",{className:"px-2 py-1 border rounded-lg hover:bg-[var(--hover,#f9fafb)] dark:hover:bg-[color-mix(in_oklab,var(--fg)_8%,transparent)] border-[var(--border)]",onClick:()=>j(e.id),children:"Remove"})})]},e.id))})]})})]})};export{k as default};
