import{r as s,g,j as r}from"./index-BWN1fagU.js";const $=({value:e,onChange:a,placeholder:p="Search borrower…",disabled:y=!1})=>{const[o,n]=s.useState(""),[d,u]=s.useState([]),[N,m]=s.useState(!1),[w,f]=s.useState(!1),i=s.useRef(null);return s.useEffect(()=>{if(e&&typeof e=="object"){const t=e.name||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.id;n(`${t}${e.id?` (${e.id})`:""}`)}},[e]),s.useEffect(()=>{if(!o.trim()){u([]);return}f(!0),i.current&&i.current.abort(),i.current=new AbortController;const t=setTimeout(async()=>{var l,x;try{const c=await g.get("/borrowers/search",{signal:i.current.signal,params:{q:o.trim()}}),j=Array.isArray(c.data)?c.data:((l=c.data)==null?void 0:l.items)||((x=c.data)==null?void 0:x.data)||[];u(j)}catch{u([])}finally{f(!1)}},250);return()=>{clearTimeout(t),i.current&&i.current.abort()}},[o]),r.jsxs("div",{className:"relative w-full",children:[r.jsx("input",{className:"w-full border rounded-lg px-3 py-2",placeholder:p,disabled:y,value:o,onFocus:()=>m(!0),onChange:t=>{n(t.target.value),m(!0),t.target.value.trim()||a==null||a(null,null)}}),N&&r.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white border rounded-lg shadow max-h-64 overflow-auto",onMouseDown:t=>t.preventDefault(),children:w?r.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"Searching…"}):d.length===0?r.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"}):d.map(t=>{const l=t.name||`${t.firstName||""} ${t.lastName||""}`.trim()||t.id||"Borrower";return r.jsxs("button",{type:"button",className:"w-full text-left px-3 py-2 hover:bg-gray-50 text-sm",onClick:()=>{n(`${l}${t.id?` (${t.id})`:""}`),m(!1),a==null||a(t.id,t)},children:[r.jsx("div",{className:"font-medium text-gray-800",children:l}),r.jsxs("div",{className:"text-xs text-gray-500",children:[t.phone||"—"," ",t.branchName?`• ${t.branchName}`:""]})]},t.id||l)})})]})};export{$ as B};
