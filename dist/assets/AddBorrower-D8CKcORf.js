import{u as R,r as m,j as e,L as I,h as q}from"./index-p3hQqlDS.js";import{c as j}from"./createLucideIcon-DBicDY_H.js";import{U as P}from"./user-DzFXqUPN.js";import{U}from"./upload-OKdiSD9q.js";import{X as $}from"./x-eJOPX2DH.js";import{P as B,I as M}from"./phone-Bge_9QRD.js";import{C as k}from"./calendar-D0yyXJNl.js";import{S as G}from"./save-DpouZNLl.js";/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],H=j("camera",z);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],W=j("map-pin",V);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Y=j("user-plus",X),S=()=>new Date().toISOString().slice(0,10),l={page:"w-full px-4 md:px-6 lg:px-8 py-6 min-h-screen bg-[var(--bg)] text-[var(--fg)]",section:"rounded-2xl border-2 border-[var(--border-strong)] bg-[var(--card)] shadow p-4 md:p-6",input:"w-full text-sm rounded-lg px-3 py-2 border-2 bg-[var(--input-bg)] text-[var(--input-fg)] border-[var(--input-border)] placeholder:text-[var(--input-placeholder)] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[var(--ring)]",btn:"inline-flex items-center gap-2 px-3 py-2 rounded-lg font-semibold border-2 border-[var(--border-strong)] bg-[var(--card)] text-[var(--fg)] hover:bg-[var(--kpi-bg)] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[var(--ring)]",primary:"inline-flex items-center gap-2 px-4 py-2 rounded-lg font-semibold shadow-sm bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-60 disabled:cursor-not-allowed focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[var(--ring)]",link:"inline-flex items-center gap-1 font-bold underline decoration-2 underline-offset-4 rounded text-[var(--ring)] hover:opacity-90 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[var(--ring)]",label:"text-[12px] font-semibold uppercase tracking-wider text-[var(--muted)] mb-1",iconAccent:"h-5 w-5 text-[var(--ring)]",iconMuted:"h-3.5 w-3.5 text-[var(--muted)]",muted:"text-[var(--muted)]"};function ne(){const r=R(),u=[{value:"male",label:"Male"},{value:"female",label:"Female"},{value:"other",label:"Other"}],L=[{value:"employed_private",label:"Employed (Private)"},{value:"employed_public",label:"Employed (Public)"},{value:"self_employed",label:"Self-Employed"},{value:"business_owner",label:"Business Owner"},{value:"student",label:"Student"},{value:"pensioner",label:"Pensioner"},{value:"unemployed",label:"Unemployed"}],T=[{value:"national_id",label:"National ID"},{value:"passport",label:"Passport"},{value:"driver_license",label:"Driver License"},{value:"voter_id",label:"Voter ID"},{value:"other",label:"Other"}],E=[{value:"individual",label:"Individual"},{value:"group",label:"Group"}],[x,N]=m.useState(!1),[h,f]=m.useState(null),[y,w]=m.useState(null),g=m.useRef(null),[a,t]=m.useState({firstName:"",lastName:"",phone:"",secondaryPhone:"",email:"",occupation:"",gender:"",birthDate:"",addressLine:"",city:"",district:"",ward:"",street:"",houseNumber:"",employmentStatus:"",idType:"",idNumber:"",idIssuedDate:"",idExpiryDate:"",loanType:"individual",groupId:"",nextKinName:"",nextKinPhone:"",regDate:S()}),F=s=>{var p;const o=(p=s.target.files)==null?void 0:p[0];if(!o)return;f(o);const i=new FileReader;i.onload=()=>w(i.result),i.readAsDataURL(o)},O=()=>{f(null),w(null),g.current&&(g.current.value="")},_=()=>!a.firstName.trim()||!a.lastName.trim()?(alert("First & last name are required"),!1):a.phone.trim()?a.gender?!0:(alert("Gender is required"),!1):(alert("Primary phone is required"),!1),K=async s=>{var o;if(s.preventDefault(),!x&&_()){N(!0);try{const i=new FormData,p={name:`${a.firstName} ${a.lastName}`.trim(),firstName:a.firstName,lastName:a.lastName,phone:a.phone,secondaryPhone:a.secondaryPhone,email:a.email,occupation:a.occupation,gender:a.gender,birthDate:a.birthDate||null,addressLine:[a.addressLine,a.street,a.houseNumber,a.ward,a.district,a.city].filter(Boolean).join(", "),employmentStatus:a.employmentStatus,idType:a.idType,idNumber:a.idNumber,idIssuedDate:a.idIssuedDate||null,idExpiryDate:a.idExpiryDate||null,loanType:a.loanType,groupId:a.loanType==="group"&&a.groupId||null,nextKinName:a.nextKinName,nextKinPhone:a.nextKinPhone,regDate:a.regDate||S()};Object.entries(p).forEach(([v,A])=>i.append(v,A??"")),h&&i.append("photo",h);const c=await q.post("/borrowers",i);alert("Borrower saved successfully");const d=((o=c==null?void 0:c.data)==null?void 0:o.borrower)||(c==null?void 0:c.data)||{},C=d==null?void 0:d.id,D=d==null?void 0:d.tenantId;if(C){const v=D?`?tenantId=${encodeURIComponent(D)}`:"";r(`/borrowers/${encodeURIComponent(C)}${v}`)}else r("/borrowers")}catch(i){console.error(i),alert("Failed to save borrower")}finally{N(!1)}}};return e.jsxs("div",{className:l.page,children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-3xl font-extrabold tracking-tight",children:"Add Borrower"}),e.jsxs("p",{className:`text-sm ${l.muted}`,children:["Fill out KYC. ",e.jsx("strong",{children:"Branch & Loan Officer will be auto-assigned"})," from your current branch and available officers."]})]}),e.jsx(I,{to:"/borrowers",className:l.link,children:"← Back to Borrowers"})]}),e.jsxs("form",{onSubmit:K,className:"grid grid-cols-1 xl:grid-cols-3 gap-6 relative",noValidate:!0,children:[e.jsxs("div",{className:"xl:col-span-2 space-y-6 min-w-0",children:[e.jsxs("section",{className:l.section,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(H,{className:l.iconAccent}),e.jsx("h2",{className:"font-extrabold text-lg tracking-tight",children:"Profile Photo"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-28 h-28 rounded-2xl overflow-hidden border-2 border-[var(--border-strong)] bg-[var(--card)] flex items-center justify-center",children:y?e.jsx("img",{src:y,alt:"Profile preview",className:"w-full h-full object-cover"}):e.jsx(P,{className:"h-10 w-10 text-[var(--muted)]"})}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("label",{className:`${l.btn} cursor-pointer`,children:[e.jsx(U,{className:"h-4 w-4"}),e.jsx("span",{children:"Upload"}),e.jsx("input",{ref:g,type:"file",accept:"image/*",capture:"environment",className:"hidden",onChange:F})]}),h&&e.jsxs("button",{type:"button",onClick:O,className:l.btn,children:[e.jsx($,{className:"h-4 w-4"})," Remove"]})]})]})]}),e.jsxs("section",{className:l.section,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(P,{className:l.iconAccent}),e.jsx("h2",{className:"font-extrabold text-lg tracking-tight",children:"Identity"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(n,{label:"First Name",children:e.jsx("input",{className:l.input,value:a.firstName,onChange:s=>t({...a,firstName:s.target.value}),required:!0})}),e.jsx(n,{label:"Last Name",children:e.jsx("input",{className:l.input,value:a.lastName,onChange:s=>t({...a,lastName:s.target.value}),required:!0})}),e.jsx(n,{label:e.jsx(b,{Icon:B,text:"Phone"}),children:e.jsx("input",{className:l.input,value:a.phone,onChange:s=>t({...a,phone:s.target.value}),placeholder:"e.g. +2557…",required:!0})}),e.jsx(n,{label:"Secondary #",children:e.jsx("input",{className:l.input,value:a.secondaryPhone,onChange:s=>t({...a,secondaryPhone:s.target.value}),placeholder:"Optional"})}),e.jsx(n,{label:"Email",children:e.jsx("input",{type:"email",className:l.input,value:a.email,onChange:s=>t({...a,email:s.target.value}),placeholder:"name@email.com"})}),e.jsx(n,{label:"Business / Occupation",children:e.jsx("input",{className:l.input,value:a.occupation,onChange:s=>t({...a,occupation:s.target.value}),placeholder:"e.g. Retail shop"})}),e.jsx(n,{label:"Gender",children:e.jsxs("select",{className:l.input,value:a.gender,onChange:s=>t({...a,gender:s.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select…"}),u.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]})}),e.jsx(n,{label:e.jsx(b,{Icon:k,text:"Birth date"}),children:e.jsx("input",{type:"date",className:l.input,value:a.birthDate,onChange:s=>t({...a,birthDate:s.target.value})})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(n,{label:"Employment / Working Status",children:e.jsxs("select",{className:l.input,value:a.employmentStatus,onChange:s=>t({...a,employmentStatus:s.target.value}),children:[e.jsx("option",{value:"",children:"Select…"}),L.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]})})})]})]}),e.jsxs("section",{className:l.section,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(W,{className:l.iconAccent}),e.jsx("h2",{className:"font-extrabold text-lg tracking-tight",children:"Address"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx(n,{label:"Address Line",children:e.jsx("input",{className:l.input,value:a.addressLine,onChange:s=>t({...a,addressLine:s.target.value})})})}),e.jsx(n,{label:"City",children:e.jsx("input",{className:l.input,value:a.city,onChange:s=>t({...a,city:s.target.value})})}),e.jsx(n,{label:"District",children:e.jsx("input",{className:l.input,value:a.district,onChange:s=>t({...a,district:s.target.value})})}),e.jsx(n,{label:"Ward",children:e.jsx("input",{className:l.input,value:a.ward,onChange:s=>t({...a,ward:s.target.value})})}),e.jsx(n,{label:"Street",children:e.jsx("input",{className:l.input,value:a.street,onChange:s=>t({...a,street:s.target.value})})}),e.jsx(n,{label:"House #",children:e.jsx("input",{className:l.input,value:a.houseNumber,onChange:s=>t({...a,houseNumber:s.target.value})})})]})]}),e.jsxs("section",{className:l.section,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(M,{className:l.iconAccent}),e.jsx("h2",{className:"font-extrabold text-lg tracking-tight",children:"ID Document"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(n,{label:"ID Type",children:e.jsxs("select",{className:l.input,value:a.idType,onChange:s=>t({...a,idType:s.target.value}),children:[e.jsx("option",{value:"",children:"Select…"}),T.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]})}),e.jsx(n,{label:"ID Number",children:e.jsx("input",{className:l.input,value:a.idNumber,onChange:s=>t({...a,idNumber:s.target.value})})}),e.jsx(n,{label:"Issued on",children:e.jsx("input",{type:"date",className:l.input,value:a.idIssuedDate,onChange:s=>t({...a,idIssuedDate:s.target.value})})}),e.jsx(n,{label:"Expiry date",children:e.jsx("input",{type:"date",className:l.input,value:a.idExpiryDate,onChange:s=>t({...a,idExpiryDate:s.target.value})})})]})]}),e.jsxs("section",{className:l.section,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Y,{className:l.iconAccent}),e.jsx("h2",{className:"font-extrabold text-lg tracking-tight",children:"Next of Kin"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(n,{label:"Full Name",children:e.jsx("input",{className:l.input,value:a.nextKinName,onChange:s=>t({...a,nextKinName:s.target.value})})}),e.jsx(n,{label:"Phone",children:e.jsx("input",{className:l.input,value:a.nextKinPhone,onChange:s=>t({...a,nextKinPhone:s.target.value})})})]})]})]}),e.jsx("div",{className:"space-y-6 min-w-0",children:e.jsxs("section",{className:l.section,children:[e.jsx("div",{className:"flex items-center gap-2 mb-4",children:e.jsx("h2",{className:"font-extrabold text-lg tracking-tight",children:"Loan Type & Registration"})}),e.jsxs("div",{className:"grid gap-4",children:[e.jsx(n,{label:"Loan Type",children:e.jsx("select",{className:l.input,value:a.loanType,onChange:s=>t({...a,loanType:s.target.value}),children:E.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})}),a.loanType==="group"&&e.jsx(n,{label:"Group ID",children:e.jsx("input",{className:l.input,value:a.groupId,onChange:s=>t({...a,groupId:s.target.value}),placeholder:"Enter group identifier"})}),e.jsx(n,{label:e.jsx(b,{Icon:k,text:"Registration Date"}),children:e.jsx("input",{type:"date",className:l.input,value:a.regDate,onChange:s=>t({...a,regDate:s.target.value})})}),e.jsx("div",{className:"rounded-lg border-2 border-[var(--border-strong)] p-3 text-[13px] text-[var(--muted)]",children:"Branch & Loan Officer will be selected automatically using your current branch and the least-loaded officer."})]})]})}),e.jsx("div",{className:"col-span-full",children:e.jsx("div",{className:"sticky bottom-0 inset-x-0 z-20 border-t-2 backdrop-blur",style:{borderColor:"var(--border-strong)",background:"var(--card)"},children:e.jsxs("div",{className:"max-w-screen-2xl mx-auto px-4 py-3 flex justify-end gap-3",children:[e.jsx(I,{to:"/borrowers",className:l.btn,children:"Cancel"}),e.jsxs("button",{disabled:x,type:"submit",className:l.primary,children:[e.jsx(G,{className:"h-4 w-4"})," ",x?"Saving…":"Save"]})]})})})]})]})}function n({label:r,children:u}){return e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:l.label,children:r}),e.jsx("div",{className:"min-w-0",children:u})]})}function b({Icon:r,text:u}){return e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(r,{className:l.iconMuted}),u]})}export{ne as default};
