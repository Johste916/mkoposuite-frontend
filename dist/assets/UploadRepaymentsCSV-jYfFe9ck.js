import{r as o,j as e}from"./index-DwQaGI98.js";import{r as y}from"./repayments-VoleWHyp.js";import"./index-eBGn09WQ.js";function S(){const[d,c]=o.useState(null),[i,m]=o.useState(!1),[p,l]=o.useState(null),[u,n]=o.useState(""),h=t=>{var s;c(((s=t.target.files)==null?void 0:s[0])||null),l(null),n("")},b=async t=>{var s,a,x;if((s=t==null?void 0:t.preventDefault)==null||s.call(t),!d)return alert("Select a CSV file first.");m(!0),n(""),l(null);try{const{data:r}=await y.uploadCsv(d);l(r||{ok:!0})}catch(r){n(((x=(a=r==null?void 0:r.response)==null?void 0:a.data)==null?void 0:x.error)||"Upload failed")}finally{m(!1)}},f=`loanReference,amount,date,method,reference,notes
LN-10001,150000,2025-08-01,mobile,MPESA-ABC123,August part-payment
LN-10002,80000,2025-08-02,bank,DRN-89231,Branch cash deposit
`,j=()=>{const t=new Blob([f],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download="repayments_sample.csv",a.click(),URL.revokeObjectURL(s)};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Upload Repayments (CSV)"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Columns supported: ",e.jsx("code",{children:"loanReference"}),", ",e.jsx("code",{children:"amount"}),", ",e.jsx("code",{children:"date"})," (YYYY-MM-DD),",e.jsx("code",{children:"method"}),", ",e.jsx("code",{children:"reference"}),", ",e.jsx("code",{children:"notes"}),"."]})]}),e.jsx("button",{onClick:j,className:"px-3 py-2 rounded border hover:bg-gray-50 text-sm",children:"Download Sample CSV"})]}),e.jsxs("form",{onSubmit:b,className:"mt-6 space-y-4",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("input",{type:"file",accept:".csv,text/csv",onChange:h})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",disabled:!d||i,className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",children:i?"Uploadingâ€¦":"Upload"}),e.jsx("button",{type:"button",className:"px-3 py-2 rounded border hover:bg-gray-50",onClick:()=>{c(null),l(null),n("")},children:"Reset"})]})]}),u&&e.jsx("div",{className:"mt-4 p-3 rounded bg-red-50 text-red-700 text-sm border border-red-200",children:u}),p&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"font-semibold",children:"Result"}),e.jsx("pre",{className:"mt-2 p-3 text-sm bg-gray-50 dark:bg-gray-900 rounded border overflow-auto",children:JSON.stringify(p,null,2)})]})]})})}export{S as default};
