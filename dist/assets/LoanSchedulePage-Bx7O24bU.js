const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jspdf.es.min-D6nqkXNi.js","assets/index-CPMSpXx6.js","assets/index-Bu7uPZYG.css"])))=>i.map(i=>d[i]);
import{i as ee,l as te,r as N,g as T,j as t,_ as H}from"./index-CPMSpXx6.js";const n=(s,b="TZS")=>`‎${b} ${Number(s||0).toLocaleString()}`,Y=s=>s?new Date(s).toLocaleDateString():"—",R=s=>{if(!s)return"";const b=new Date(s);return Number.isNaN(b.getTime())?String(s).slice(0,10):b.toISOString().slice(0,10)};function ae(s){return s?Array.isArray(s)?s:Array.isArray(s.schedule)?s.schedule:Array.isArray(s.rows)?s.rows:Array.isArray(s.data)?s.data:[]:[]}function se(s=[],b=0){let r=Number(b||0),h=0,e=0,P=0,u=0;for(const w of s){const j=Number(w.fee??w.fees??0),_=Number(w.penalty??0),a=Number(w.interest??0),z=Number(w.principal??0);if(r<=0)break;const L=Math.min(r,j);if(u+=L,r-=L,r<=0)break;const O=Math.min(r,_);if(P+=O,r-=O,r<=0)break;const U=Math.min(r,a);if(e+=U,r-=U,r<=0)break;const k=Math.min(r,z);h+=k,r-=k}return{paidPrincipal:h,paidInterest:e,paidPenalty:P,paidFees:u}}function ie(s=[],b=[]){const r=($,m)=>$.reduce((V,F)=>V+Number((F==null?void 0:F[m])||0),0),h=r(s,"principal"),e=r(s,"interest"),P=r(s,"penalty"),u=r(s,"fee")+r(s,"fees"),w=r(s,"total")||h+e+P+u,j=b.reduce(($,m)=>$+Number(m.amount||0),0),_=r(s,"paidPrincipal")||0,a=r(s,"paidInterest")||0,z=r(s,"paidPenalty")||0,L=(r(s,"paidFees")||0)+(r(s,"paidFee")||0),U=_+a+z+L>0?{paidPrincipal:_,paidInterest:a,paidPenalty:z,paidFees:L}:se(s,j),k=Math.max(w-j,0),S=s.find($=>$.paid||$.settled?!1:Number($.balance??Number($.total||0))>0)||null;return{scheduledPrincipal:h,scheduledInterest:e,scheduledPenalty:P,scheduledFees:u,scheduledTotal:w,totalPaid:j,outstandingTotal:k,nextDue:S?{idx:S.installment??S.period??s.indexOf(S)+1,date:S.dueDate||S.date||null,amount:Number(S.total??0)}:null,...U}}async function ne(){var b,r;let s={name:"MkopoSuite",address:"",phone:"",email:"",website:"",logoUrl:""};try{const e=(await T.get("/settings")).data||{};return s={name:e.companyName||e.name||s.name,address:e.companyAddress||e.address||s.address,phone:e.companyPhone||e.phone||s.phone,email:e.companyEmail||e.email||s.email,website:e.companyWebsite||e.website||s.website,logoUrl:e.logoUrl||e.companyLogoUrl||s.logoUrl},s}catch{}try{const e=((b=(await T.get("/account")).data)==null?void 0:b.settings)||{};return s={name:e.companyName||e.name||s.name,address:e.companyAddress||e.address||s.address,phone:e.companyPhone||e.phone||s.phone,email:e.companyEmail||e.email||s.email,website:e.companyWebsite||e.website||s.website,logoUrl:e.logoUrl||e.companyLogoUrl||s.logoUrl},s}catch{}try{const e=((r=(await T.get("/settings/sidebar")).data)==null?void 0:r.app)||{};s.name=e.name||s.name,s.logoUrl=e.logoUrl||s.logoUrl}catch{}return s}function de(s=[]){const b=s.map(h=>new Date(h.dueDate||h.date)).filter(h=>!Number.isNaN(h.getTime()));if(b.length<2)return"";let r=0;for(let h=1;h<b.length;h++){const e=b[h-1],P=b[h],u=(P.getFullYear()-e.getFullYear())*12+(P.getMonth()-e.getMonth()),w=Math.abs(P.getDate()-e.getDate())<=2;u===1&&w&&r++}return r>=Math.max(1,b.length-2)?"Monthly":""}function re(){const s=ee(),[b]=te(),[r,h]=N.useState(""),[e,P]=N.useState(null),[u,w]=N.useState([]),[j,_]=N.useState(""),[a,z]=N.useState("TZS"),[L,O]=N.useState([]),[U,k]=N.useState(!1),[S,$]=N.useState(!0),[m,V]=N.useState({name:"MkopoSuite",address:"",phone:"",email:"",website:"",logoUrl:""}),F=N.useRef(null);N.useEffect(()=>{const i=s.id?String(s.id):"",g=b.get("id")||"",o=i||g||"";o&&(h(o),B(o))},[]),N.useEffect(()=>{ne().then(V).catch(()=>{})},[]);const B=async i=>{var g,o,f;if(i){k(!0);try{const[v,c]=await Promise.all([T.get(`/loans/${i}/schedule`),T.get(`/loans/${i}`)]),y=c.data||null;P(y);const M=ae(v.data);w(M);const E=((g=v.data)==null?void 0:g.interestMethod)||((o=v.data)==null?void 0:o.method)||"",C=(y==null?void 0:y.interestMethod)||"";_(E||C||"");const I=(f=v.data)==null?void 0:f.currency,p=y==null?void 0:y.currency;(I||p)&&z(I||p);const D=await T.get(`/repayments/loan/${i}`).then(x=>x.data||[]).catch(()=>[]);O(D);const A=((D==null?void 0:D.length)||0)>0,d=((y==null?void 0:y.status)||"").toLowerCase();if(A&&d&&!["active","closed"].includes(d))try{await T.patch(`/loans/${i}/status`,{status:"active"});const x=await T.get(`/loans/${i}`);P(x.data||y||null)}catch{}window.dispatchEvent(new CustomEvent("loan:updated",{detail:{id:i}}))}catch{w([]),O([]),P(null),_("")}finally{k(!1)}}},Z=async i=>{i.preventDefault(),await B(r.trim())};N.useEffect(()=>{const i=()=>r&&B(r.trim());return window.addEventListener("focus",i),()=>window.removeEventListener("focus",i)},[r]),N.useEffect(()=>{if(!(!r||!S))return F.current&&clearInterval(F.current),F.current=setInterval(()=>B(r.trim()),1e4),()=>F.current&&clearInterval(F.current)},[r,S]);const l=N.useMemo(()=>ie(u||[],L||[]),[u,L]),G=N.useMemo(()=>de(u),[u]),X=()=>{var I;if(!u.length)return;const i=(e==null?void 0:e.releaseDate)||(e==null?void 0:e.startDate)||"",g=[["Company",m.name],["Address",m.address],["Phone",m.phone],["Email",m.email],["Website",m.website],[],["Loan ID",(e==null?void 0:e.id)??r],["Borrower",((I=e==null?void 0:e.Borrower)==null?void 0:I.name)||(e==null?void 0:e.borrowerName)||""],["Status",(e==null?void 0:e.status)||""],["Currency",a],["Interest Method",j],["Disbursed",R(i)],["Generated At",new Date().toLocaleString()],[]],o=["Installment","Due Date","Principal","Interest","Total P&I","Penalty","Fees","Paid Principal","Paid Interest","Outstanding","Settled"],f=u.map((p,D)=>{const A=Number(p.principal||0)+Number(p.interest||0),d=p.balance!=null?Number(p.balance):p.paid||p.settled?0:p.total!=null?Number(p.total):A+Number(p.penalty||0)+Number(p.fee??p.fees??0);return[p.installment??p.period??D+1,R(p.dueDate??p.date??""),Number(p.principal??0),Number(p.interest??0),Number(A),Number(p.penalty??0),Number(p.fee??p.fees??0),p.paidPrincipal!=null?Number(p.paidPrincipal):"",p.paidInterest!=null?Number(p.paidInterest):"",d,p.paid||p.settled?"YES":"NO"]}),v=[[],["Totals","",l.scheduledPrincipal,l.scheduledInterest,l.scheduledPrincipal+l.scheduledInterest,l.scheduledPenalty,l.scheduledFees,l.paidPrincipal,l.paidInterest,l.outstandingTotal,""],["Total Paid","","","","","","","","",l.totalPaid,""]],y=[...g,o,...f,...v].map(p=>p.map(D=>`"${String(D??"").replace(/"/g,'""')}"`).join(",")).join(`
`),M=new Blob([y],{type:"text/csv;charset=utf-8;"}),E=URL.createObjectURL(M),C=document.createElement("a");C.href=E,C.download=`loan_${(e==null?void 0:e.id)??r}_schedule.csv`,C.click(),URL.revokeObjectURL(E)},J=async()=>{var D,A;if(!u.length)return;let i,g;try{i=(await H(async()=>{const{default:d}=await import("./jspdf.es.min-D6nqkXNi.js").then(x=>x.j);return{default:d}},__vite__mapDeps([0,1,2]))).default,g=(await H(async()=>{const{default:d}=await import("./jspdf.plugin.autotable-CfO62xhj.js");return{default:d}},[])).default}catch{return Q()}const o=new i({unit:"pt",format:"a4"}),f=o.internal.pageSize.getWidth(),v=40;let c=40;if(m.logoUrl)try{const d=await fetch(m.logoUrl).then(q=>q.blob()),x=new FileReader,K=new Promise(q=>{x.onload=()=>q(x.result)});x.readAsDataURL(d);const W=await K;o.addImage(W,"PNG",v,c,120,40)}catch{}o.setFontSize(14),o.text(m.name||"Company",v,c+65),o.setFontSize(10),[m.address,[m.phone,m.email].filter(Boolean).join("  •  "),m.website].filter(Boolean).forEach((d,x)=>o.text(String(d),v,c+80+x*14)),o.setFontSize(16),o.text("Loan Repayment Schedule",f-40,50,{align:"right"}),o.setFontSize(10),[`Loan ID: ${(e==null?void 0:e.id)??r}`,`Borrower: ${((D=e==null?void 0:e.Borrower)==null?void 0:D.name)||(e==null?void 0:e.borrowerName)||""}`,`Status: ${(e==null?void 0:e.status)||""}`,`Currency: ${a}`,`Interest Method: ${j||""}`,`Disbursed: ${R((e==null?void 0:e.releaseDate)||(e==null?void 0:e.startDate)||"")}`,`Generated: ${new Date().toLocaleString()}`].forEach((d,x)=>o.text(d,f-40,68+x*14,{align:"right"}));const E=[{header:"#",dataKey:"idx"},{header:"Due Date",dataKey:"dueDate"},{header:"Principal",dataKey:"principal"},{header:"Interest",dataKey:"interest"},{header:"Total P&I",dataKey:"pi"},{header:"Penalty",dataKey:"penalty"},{header:"Fees",dataKey:"fees"},{header:"Paid Principal",dataKey:"paidP"},{header:"Paid Interest",dataKey:"paidI"},{header:"Outstanding",dataKey:"outstanding"},{header:"Settled",dataKey:"settled"}],C=u.map((d,x)=>{const K=Number(d.principal||0)+Number(d.interest||0),W=d.balance!=null?Number(d.balance):d.paid||d.settled?0:d.total!=null?Number(d.total):K+Number(d.penalty||0)+Number(d.fee??d.fees??0);return{idx:d.installment??d.period??x+1,dueDate:R(d.dueDate??d.date??""),principal:n(d.principal,a),interest:n(d.interest,a),pi:n(K,a),penalty:n(d.penalty||0,a),fees:n(d.fee??d.fees??0,a),paidP:d.paidPrincipal!=null?n(d.paidPrincipal,a):"—",paidI:d.paidInterest!=null?n(d.paidInterest,a):"—",outstanding:n(W,a),settled:d.paid||d.settled?"YES":"NO"}});g(o,{head:[E.map(d=>d.header)],body:C.map(d=>E.map(x=>d[x.dataKey])),startY:140,styles:{fontSize:9},headStyles:{fillColor:[243,244,246],textColor:20},alternateRowStyles:{fillColor:[250,250,250]},margin:{left:40,right:40},didDrawPage:()=>{const d=`Page ${o.internal.getNumberOfPages()}`;o.setFontSize(9),o.text(d,f-40,o.internal.pageSize.getHeight()-20,{align:"right"})}});let I=((A=o.lastAutoTable)==null?void 0:A.finalY)||140;I+=16,o.setFontSize(11),o.text("Summary",40,I),I+=8,o.setFontSize(10),[["Principal (Sched.)",n(l.scheduledPrincipal,a)],["Interest (Sched.)",n(l.scheduledInterest,a)],["Total P&I (Sched.)",n(l.scheduledPrincipal+l.scheduledInterest,a)],["Penalty (Sched.)",n(l.scheduledPenalty,a)],["Fees (Sched.)",n(l.scheduledFees,a)],["Total Payable",n(l.scheduledTotal,a)],["Paid Principal",n(l.paidPrincipal,a)],["Paid Interest",n(l.paidInterest,a)],["Total Paid",n(l.totalPaid,a)],["Outstanding",n(l.outstandingTotal,a)]].forEach((d,x)=>{o.text(d[0],40,I+16+x*14),o.text(d[1],f-40,I+16+x*14,{align:"right"})}),o.save(`loan_${(e==null?void 0:e.id)??r}_schedule.pdf`)},Q=()=>{var v;const i=u.map((c,y)=>{const M=Number(c.principal||0)+Number(c.interest||0),E=c.balance!=null?Number(c.balance):c.paid||c.settled?0:c.total!=null?Number(c.total):M+Number(c.penalty||0)+Number(c.fee??c.fees??0);return`
          <tr>
            <td>${c.installment??c.period??y+1}</td>
            <td>${R(c.dueDate??c.date??"")}</td>
            <td>${n(c.principal,a)}</td>
            <td>${n(c.interest,a)}</td>
            <td>${n(M,a)}</td>
            <td>${n(c.penalty||0,a)}</td>
            <td>${n(c.fee??c.fees??0,a)}</td>
            <td>${c.paidPrincipal!=null?n(c.paidPrincipal,a):"—"}</td>
            <td>${c.paidInterest!=null?n(c.paidInterest,a):"—"}</td>
            <td>${n(E,a)}</td>
            <td>${c.paid||c.settled?"YES":"NO"}</td>
          </tr>
        `}).join(""),g=m.logoUrl?`<img src="${m.logoUrl}" style="height:48px;object-fit:contain;margin-right:12px;" />`:"",o=`
      <html>
        <head>
          <meta charset="utf-8" />
          <title>Loan ${(e==null?void 0:e.id)??r} Schedule</title>
          <style>
            body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Noto Sans', 'Helvetica Neue', Arial; color:#111827; }
            .container { max-width: 1024px; margin: 24px auto; }
            .header { display:flex; align-items:center; justify-content:space-between; }
            .company { display:flex; align-items:center; }
            .company h1 { margin:0; font-size:18px; }
            .muted { color:#6B7280; font-size:12px; }
            table { width:100%; border-collapse: collapse; margin-top: 16px; }
            th, td { border: 1px solid #E5E7EB; padding: 6px 8px; font-size: 12px; }
            thead { background:#F3F4F6; }
            .summary { margin-top:16px; display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap:8px; }
            .card { border:1px solid #E5E7EB; padding:8px 10px; border-radius:8px; }
            .cal { margin-top:10px; display:flex; flex-wrap: wrap; gap:6px; font-size:12px; }
            .pill { border:1px solid #E5E7EB; border-radius:9999px; padding:3px 8px; background:#fff; }
            @media print { .no-print { display:none; } }
          </style>
        </head>
        <body>
          <div class="container">
            <div class="header">
              <div class="company">
                ${g}
                <div>
                  <h1>${m.name||""}</h1>
                  <div class="muted">
                    ${[m.address,m.phone,m.email,m.website].filter(Boolean).join(" • ")}
                  </div>
                </div>
              </div>
              <div>
                <div style="font-weight:600;">Loan Repayment Schedule</div>
                <div class="muted">Generated: ${new Date().toLocaleString()}</div>
              </div>
            </div>

            <div style="margin-top:12px;font-size:12px;">
              <div><b>Loan ID:</b> ${(e==null?void 0:e.id)??r}</div>
              <div><b>Borrower:</b> ${((v=e==null?void 0:e.Borrower)==null?void 0:v.name)||(e==null?void 0:e.borrowerName)||""}</div>
              <div><b>Status:</b> ${(e==null?void 0:e.status)||""}</div>
              <div><b>Currency:</b> ${a} &nbsp; • &nbsp; <b>Interest Method:</b> ${j||""}</div>
              <div><b>Disbursed:</b> ${R((e==null?void 0:e.releaseDate)||(e==null?void 0:e.startDate)||"")}</div>
            </div>

            <div class="cal">
              ${u.map((c,y)=>`<span class="pill">#${c.installment??c.period??y+1}: ${R(c.dueDate||c.date||"")}</span>`).join("")}
            </div>

            <table>
              <thead>
                <tr>
                  <th>#</th>
                  <th>Due Date</th>
                  <th>Principal</th>
                  <th>Interest</th>
                  <th>Total P&I</th>
                  <th>Penalty</th>
                  <th>Fees</th>
                  <th>Paid Principal</th>
                  <th>Paid Interest</th>
                  <th>Outstanding</th>
                  <th>Settled</th>
                </tr>
              </thead>
              <tbody>
                ${i}
              </tbody>
            </table>

            <div class="summary">
              <div class="card"><div class="muted">Principal (Sched.)</div><div><b>${n(l.scheduledPrincipal,a)}</b></div></div>
              <div class="card"><div class="muted">Interest (Sched.)</div><div><b>${n(l.scheduledInterest,a)}</b></div></div>
              <div class="card"><div class="muted">Total P&I (Sched.)</div><div><b>${n(l.scheduledPrincipal+l.scheduledInterest,a)}</b></div></div>
              <div class="card"><div class="muted">Penalty (Sched.)</div><div><b>${n(l.scheduledPenalty,a)}</b></div></div>
              <div class="card"><div class="muted">Fees (Sched.)</div><div><b>${n(l.scheduledFees,a)}</b></div></div>
              <div class="card"><div class="muted">Total Payable</div><div><b>${n(l.scheduledTotal,a)}</b></div></div>
              <div class="card"><div class="muted">Paid Principal</div><div><b>${n(l.paidPrincipal,a)}</b></div></div>
              <div class="card"><div class="muted">Paid Interest</div><div><b>${n(l.paidInterest,a)}</b></div></div>
              <div class="card"><div class="muted">Total Paid</div><div><b>${n(l.totalPaid,a)}</b></div></div>
              <div class="card"><div class="muted">Outstanding</div><div><b>${n(l.outstandingTotal,a)}</b></div></div>
            </div>

            <div class="no-print" style="margin-top:16px;">
              <button onclick="window.print()" style="padding:8px 12px;border:1px solid #E5E7EB;border-radius:8px;background:white;cursor:pointer;">Print / Save as PDF</button>
            </div>
          </div>
        </body>
      </html>
    `,f=window.open("","_blank","noopener,noreferrer,width=1024,height=768");f&&(f.document.open(),f.document.write(o),f.document.close())};return t.jsxs("div",{className:"p-4 space-y-4",children:[t.jsxs("div",{className:"flex items-start justify-between flex-wrap gap-3",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold",children:"Loan Schedule"}),e&&t.jsxs("p",{className:"text-sm text-gray-600",children:["Loan ",t.jsxs("b",{children:["#",e.id]})," — Status: ",t.jsx("span",{className:"inline-block rounded-full px-2 py-0.5 text-xs bg-slate-100 border",children:e.status})]}),t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[m.name,m.address?` • ${m.address}`:"",m.phone?` • ${m.phone}`:"",m.email?` • ${m.email}`:""]}),e&&t.jsxs("p",{className:"text-xs text-gray-700 mt-1",children:[t.jsx("b",{children:"Disbursed:"})," ",Y(e.releaseDate||e.startDate),G&&t.jsxs(t.Fragment,{children:[" ","• ",t.jsx("b",{children:"Frequency:"})," ",G]})]}),(l==null?void 0:l.nextDue)&&t.jsxs("p",{className:"text-xs text-gray-700 mt-1",children:["Next Installment #",l.nextDue.idx," on ",Y(l.nextDue.date)," —"," ",t.jsx("b",{children:n(l.nextDue.amount,a)})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>r&&B(r.trim()),className:"px-3 py-2 rounded border hover:bg-gray-50",children:"Refresh"}),t.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[t.jsx("input",{type:"checkbox",checked:S,onChange:i=>$(i.target.checked)}),"Auto-refresh"]}),t.jsx("button",{onClick:X,disabled:!u.length,className:"px-3 py-2 rounded border hover:bg-gray-50 disabled:opacity-50",title:"Download as CSV",children:"Download CSV"}),t.jsx("button",{onClick:J,disabled:!u.length,className:"bg-indigo-600 text-white px-3 py-2 rounded hover:bg-indigo-700 disabled:opacity-50",title:"Download as PDF",children:"Download PDF"})]})]}),t.jsxs("form",{onSubmit:Z,className:"flex gap-2 flex-wrap",children:[t.jsx("input",{className:"border px-3 py-2 rounded w-64",placeholder:"Enter Loan ID",value:r,onChange:i=>h(i.target.value)}),t.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded",children:U?"Loading…":"Load"}),j&&t.jsxs("div",{className:"self-center text-sm text-gray-700",children:["Interest Method: ",t.jsx("b",{children:j})]})]}),!!u.length&&t.jsxs("div",{className:"bg-white rounded border shadow p-3",children:[t.jsxs("div",{className:"grid sm:grid-cols-3 lg:grid-cols-6 gap-3 text-sm",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500 text-xs",children:"Principal (Sched.)"}),t.jsx("div",{className:"font-semibold",children:n(l.scheduledPrincipal,a)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500 text-xs",children:"Interest (Sched.)"}),t.jsx("div",{className:"font-semibold",children:n(l.scheduledInterest,a)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500 text-xs",children:"Total P&I (Sched.)"}),t.jsx("div",{className:"font-semibold",children:n(l.scheduledPrincipal+l.scheduledInterest,a)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500 text-xs",children:"Penalty (Sched.)"}),t.jsx("div",{className:"font-semibold",children:n(l.scheduledPenalty,a)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500 text-xs",children:"Fees (Sched.)"}),t.jsx("div",{className:"font-semibold",children:n(l.scheduledFees,a)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500 text-xs",children:"Total Payable"}),t.jsx("div",{className:"font-semibold",children:n(l.scheduledTotal,a)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500 text-xs",children:"Paid Principal"}),t.jsx("div",{className:"font-semibold",children:n(l.paidPrincipal,a)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500 text-xs",children:"Paid Interest"}),t.jsx("div",{className:"font-semibold",children:n(l.paidInterest,a)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500 text-xs",children:"Total Paid"}),t.jsx("div",{className:"font-semibold",children:n(l.totalPaid,a)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500 text-xs",children:"Outstanding"}),t.jsx("div",{className:"font-semibold",children:n(l.outstandingTotal,a)})]})]}),t.jsx("div",{className:"mt-3 flex flex-wrap gap-2 text-xs",children:u.map((i,g)=>t.jsxs("span",{className:"px-2 py-1 rounded-full border bg-white",children:["#",i.installment??i.period??g+1,": ",Y(i.dueDate||i.date)]},g))})]}),!!u.length&&t.jsx("div",{className:"overflow-auto rounded border shadow",children:t.jsxs("table",{className:"min-w-full bg-white",children:[t.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:t.jsxs("tr",{className:"text-left text-sm",children:[t.jsx("th",{className:"p-2 border",children:"#"}),t.jsx("th",{className:"p-2 border",children:"Due Date"}),t.jsx("th",{className:"p-2 border",children:"Principal"}),t.jsx("th",{className:"p-2 border",children:"Interest"}),t.jsx("th",{className:"p-2 border",children:"Total P&I"}),t.jsx("th",{className:"p-2 border",children:"Penalty"}),t.jsx("th",{className:"p-2 border",children:"Fees"}),t.jsx("th",{className:"p-2 border",children:"Paid Principal"}),t.jsx("th",{className:"p-2 border",children:"Paid Interest"}),t.jsx("th",{className:"p-2 border",children:"Outstanding"}),t.jsx("th",{className:"p-2 border",children:"Status"})]})}),t.jsx("tbody",{className:"text-sm",children:u.map((i,g)=>{const o=i.installment??i.period??g+1,f=Number(i.principal||0)+Number(i.interest||0),v=i.balance!=null?Number(i.balance):i.paid||i.settled?0:i.total!=null?Number(i.total):f+Number(i.penalty||0)+Number(i.fee??i.fees??0),c=i.paid||i.settled?"Settled":"Pending";return t.jsxs("tr",{className:g%2?"bg-gray-50":"",children:[t.jsx("td",{className:"border px-2 py-1 whitespace-nowrap",children:o}),t.jsx("td",{className:"border px-2 py-1 whitespace-nowrap",children:Y(i.dueDate||i.date)}),t.jsx("td",{className:"border px-2 py-1 whitespace-nowrap",children:n(i.principal,a)}),t.jsx("td",{className:"border px-2 py-1 whitespace-nowrap",children:n(i.interest,a)}),t.jsx("td",{className:"border px-2 py-1 whitespace-nowrap",children:n(f,a)}),t.jsx("td",{className:"border px-2 py-1 whitespace-nowrap",children:n(i.penalty||0,a)}),t.jsx("td",{className:"border px-2 py-1 whitespace-nowrap",children:n(i.fee??i.fees??0,a)}),t.jsx("td",{className:"border px-2 py-1 whitespace-nowrap",children:i.paidPrincipal!=null?n(i.paidPrincipal,a):"—"}),t.jsx("td",{className:"border px-2 py-1 whitespace-nowrap",children:i.paidInterest!=null?n(i.paidInterest,a):"—"}),t.jsx("td",{className:"border px-2 py-1 whitespace-nowrap",children:n(v,a)}),t.jsx("td",{className:"border px-2 py-1 whitespace-nowrap",children:c==="Settled"?t.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-emerald-50 text-emerald-700 ring-1 ring-emerald-200",children:"Settled"}):t.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-amber-50 text-amber-700 ring-1 ring-amber-200",children:"Pending"})})]},g)})})]})}),!U&&r&&!u.length&&t.jsx("p",{className:"text-sm text-gray-600",children:"No schedule found for this loan."})]})}export{re as default};
