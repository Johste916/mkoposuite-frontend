import{u as v,r as t,j as e,L as w}from"./index-2ZVrRahO.js";import{l as A,g as C,d as E}from"./banking--f58KXLt.js";import{C as B}from"./circle-plus-iRGi_jRI.js";import{c as m}from"./createLucideIcon-BVcvDw0D.js";/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],M=m("eye",L);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],_=m("pencil",S);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],D=m("trash-2",T),z="bg-white rounded-2xl shadow-sm ring-1 ring-black/5 p-5 md:p-7",F="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500/40 focus:border-indigo-500 transition-all";function H(){const c=v(),[n,a]=t.useState([]),[N,u]=t.useState({}),[j,h]=t.useState(!0),[i,g]=t.useState(""),l=t.useRef(),o=async r=>{h(!0);try{const[s,d]=await Promise.all([A({search:i,signal:r}),C({signal:r})]),b=Array.isArray(s)?s:Array.isArray(s==null?void 0:s.items)?s.items:Array.isArray(s==null?void 0:s.rows)?s.rows:[];a(b);const x={},k=(d==null?void 0:d.items)||[];for(const y of k)x[y.bankId]=y;u(x)}catch(s){if((s==null?void 0:s.code)==="ERR_CANCELED")return;console.error(s),a([]),u({})}finally{h(!1)}};t.useEffect(()=>{const r=new AbortController;return o(r.signal),()=>r.abort()},[]),t.useEffect(()=>{l.current&&clearTimeout(l.current);const r=new AbortController;return l.current=setTimeout(()=>o(r.signal),350),()=>{clearTimeout(l.current),r.abort()}},[i]);const f=async r=>{if(window.confirm("Delete this bank?"))try{await E(r);const s=new AbortController;await o(s.signal),s.abort()}catch(s){console.error(s),alert((s==null?void 0:s.normalizedMessage)||"Failed to delete bank")}},p=t.useMemo(()=>Array.isArray(n)?n:[],[n]);return e.jsxs("div",{className:"p-4 md:p-6 lg:p-8",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:"Banks"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Tenant-scoped bank & balance overview (disbursements, repayments, transfers)."})]}),e.jsxs(w,{to:"/banks/add",className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg border hover:bg-gray-50",children:[e.jsx(B,{className:"h-4 w-4"})," Add Bank"]})]}),e.jsxs("section",{className:z,children:[e.jsx("div",{className:"mb-3",children:e.jsx("input",{className:F,placeholder:"Search by name, code, account…",value:i,onChange:r=>g(r.target.value),"aria-label":"Search banks"})}),j?e.jsx("p",{className:"text-sm text-gray-500",children:"Loading…"}):p.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No banks found. Click “Add Bank” to create one."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-600",children:[e.jsx("th",{className:"py-2 pr-4",children:"Name"}),e.jsx("th",{className:"py-2 pr-4",children:"Code"}),e.jsx("th",{className:"py-2 pr-4",children:"Branch"}),e.jsx("th",{className:"py-2 pr-4",children:"Account Name"}),e.jsx("th",{className:"py-2 pr-4",children:"Account #"}),e.jsx("th",{className:"py-2 pr-4",children:"Currency"}),e.jsx("th",{className:"py-2 pr-4",children:"Current"}),e.jsx("th",{className:"py-2 pr-4"})]})}),e.jsx("tbody",{children:p.map(r=>{const s=N[r.id]||{};return e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"py-2 pr-4",children:r.name}),e.jsx("td",{className:"py-2 pr-4",children:r.code||"—"}),e.jsx("td",{className:"py-2 pr-4",children:r.branch||"—"}),e.jsx("td",{className:"py-2 pr-4",children:r.accountName||"—"}),e.jsx("td",{className:"py-2 pr-4",children:r.accountNumber||"—"}),e.jsx("td",{className:"py-2 pr-4",children:r.currency||"—"}),e.jsx("td",{className:"py-2 pr-4 font-medium",children:s.current!=null?I(s.current,r.currency):"—"}),e.jsx("td",{className:"py-2 pr-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>c(`/banks/${r.id}`),className:"px-2 py-1 rounded border hover:bg-gray-50 inline-flex items-center gap-1",title:"View",children:[e.jsx(M,{className:"h-4 w-4"})," View"]}),e.jsxs("button",{onClick:()=>c(`/banks/${r.id}/edit`),className:"px-2 py-1 rounded border hover:bg-gray-50 inline-flex items-center gap-1",title:"Edit",children:[e.jsx(_,{className:"h-4 w-4"})," Edit"]}),e.jsxs("button",{onClick:()=>f(r.id),className:"px-2 py-1 rounded border hover:bg-gray-50 inline-flex items-center gap-1",title:"Delete",children:[e.jsx(D,{className:"h-4 w-4"})," Delete"]})]})})]},r.id)})})]})})]})]})}function I(c,n){const a=Number(c);if(!Number.isFinite(a))return"—";try{return new Intl.NumberFormat(void 0,{style:"currency",currency:n||"TZS"}).format(a)}catch{return a.toLocaleString()}}export{H as default};
