import{r as L,j as e,b as O}from"./index-Beh6sWFf.js";import{u as _}from"./useSettingsResource-CscC1ZTS.js";function R(){var N,v,S,C,w;const{data:a,setData:r,loading:n,saving:l,error:o,save:i,reload:c}=_({getUrl:"/settings/general",putUrl:"/settings/general",initial:{company:{name:"MkopoSuite",email:"info@example.com",phone:"+255700000000",website:"https://example.com",address1:"",address2:"",city:"",country:"Tanzania",logoUrl:"",profileImageUrl:""},branding:{primaryColor:"#1d4ed8",secondaryColor:"#0ea5e9"},locale:{currency:"TZS",timezone:"Africa/Dar_es_Salaam",language:"en",currencyInWords:"Shillings",dateFormat:"dd/mm/yyyy"},numberFormats:{thousandSeparator:",",decimalSeparator:".",currencyPosition:"prefix"},dashboard:{landingWidgets:["kpis","recent-activity","collections"],showTicker:!0}}}),[x,d]=L.useState(""),h=async()=>{try{await i(),d("Settings saved successfully."),window.clearTimeout(h._t||0),h._t=window.setTimeout(()=>d(""),2500)}catch{d("")}},j=async(s,t)=>{var k;if(!s)return;const m=new FormData;m.append("file",s);const p=((k=(await O.post("/uploads/image",m,{headers:{"Content-Type":"multipart/form-data"}})).data)==null?void 0:k.url)||"";r(J=>{var T;const F=D(J),b=t.split(".");let u=F;for(let f=0;f<b.length-1;f++)u=u[T=b[f]]||(u[T]={});return u[b.at(-1)]=p,F})};return n?e.jsx("div",{className:"p-4 text-sm text-slate-500",children:"Loading…"}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("header",{className:"bg-white dark:bg-slate-900 border rounded-2xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold",children:"General Settings"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Branding, company info, locale and formats."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-3 py-1.5 rounded border bg-white hover:bg-gray-50 text-sm",onClick:c,disabled:n||l,children:"Reload"}),e.jsx("button",{className:"px-3 py-1.5 rounded bg-blue-600 text-white text-sm disabled:opacity-60",disabled:l,onClick:h,children:l?"Saving…":"Save Changes"})]})]})}),o&&e.jsx("div",{className:"bg-rose-50 text-rose-700 border border-rose-200 rounded-lg p-3 text-sm",children:o}),x&&e.jsx("div",{className:"bg-emerald-50 text-emerald-700 border border-emerald-200 rounded-lg p-3 text-sm",children:x}),e.jsxs("section",{className:"bg-white dark:bg-slate-900 border rounded-2xl p-4 space-y-4",children:[e.jsx("h2",{className:"font-semibold",children:"Company"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-start",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Logo"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:((N=a.company)==null?void 0:N.logoUrl)||"https://via.placeholder.com/80x80?text=Logo",alt:"Logo",className:"w-16 h-16 rounded bg-slate-100 object-cover"}),e.jsx("input",{type:"file",accept:"image/*",onChange:s=>{var t;return j((t=s.target.files)==null?void 0:t[0],"company.logoUrl")},className:"text-sm"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Profile Image (optional)"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:((v=a.company)==null?void 0:v.profileImageUrl)||"https://via.placeholder.com/80x80?text=Img",alt:"Profile",className:"w-16 h-16 rounded bg-slate-100 object-cover"}),e.jsx("input",{type:"file",accept:"image/*",onChange:s=>{var t;return j((t=s.target.files)==null?void 0:t[0],"company.profileImageUrl")},className:"text-sm"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[["Company Name","company.name","text","MkopoSuite"],["Email","company.email","email","info@example.com"],["Phone","company.phone","tel","+255700000000"],["Website","company.website","url","https://example.com"],["Address line 1","company.address1","text",""],["Address line 2","company.address2","text",""],["City","company.city","text",""],["Country","company.country","text","Tanzania"]].map(([s,t,m,y])=>e.jsx(I,{label:s,type:m,placeholder:y,value:P(a,t)||"",onChange:p=>g(r,t,p)},t))})]}),e.jsxs("section",{className:"bg-white dark:bg-slate-900 border rounded-2xl p-4 space-y-4",children:[e.jsx("h2",{className:"font-semibold",children:"Branding"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(U,{label:"Primary Color",value:((S=a.branding)==null?void 0:S.primaryColor)||"#1d4ed8",onChange:s=>g(r,"branding.primaryColor",s)}),e.jsx(U,{label:"Secondary Color",value:((C=a.branding)==null?void 0:C.secondaryColor)||"#0ea5e9",onChange:s=>g(r,"branding.secondaryColor",s)})]})]}),e.jsxs("section",{className:"bg-white dark:bg-slate-900 border rounded-2xl p-4 space-y-4",children:[e.jsx("h2",{className:"font-semibold",children:"Locale & Formats"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[[["Currency","locale.currency","text","TZS"],["Currency in Words","locale.currencyInWords","text","Shillings"],["Timezone","locale.timezone","text","Africa/Dar_es_Salaam"],["Language","locale.language","text","en"],["Date Format","locale.dateFormat","text","dd/mm/yyyy"],["Thousand Separator","numberFormats.thousandSeparator","text",","],["Decimal Separator","numberFormats.decimalSeparator","text","."]].map(([s,t,m,y])=>e.jsx(I,{label:s,type:m,placeholder:y,value:P(a,t)??"",onChange:p=>g(r,t,p)},t)),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm",children:"Currency Position"}),e.jsxs("select",{className:"mt-1 w-full rounded border px-3 py-2 text-sm",value:((w=a.numberFormats)==null?void 0:w.currencyPosition)||"prefix",onChange:s=>g(r,"numberFormats.currencyPosition",s.target.value),children:[e.jsx("option",{value:"prefix",children:"Prefix (TZS 1,000)"}),e.jsx("option",{value:"suffix",children:"Suffix (1,000 TZS)"})]})]})]})]}),e.jsxs("section",{className:"bg-white dark:bg-slate-900 border rounded-2xl p-4 space-y-2",children:[e.jsx("h2",{className:"font-semibold",children:"Advanced"}),e.jsx("label",{className:"text-xs text-gray-500",children:"Raw Settings (JSON)"}),e.jsx("textarea",{className:"w-full h-48 border rounded p-2 text-sm font-mono",value:z(a),onChange:s=>{try{const t=JSON.parse(s.target.value||"{}");r(t)}catch{}}}),e.jsx("div",{className:"text-[11px] text-slate-500",children:"You can edit the JSON directly; all keys will be saved."})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{className:"px-3 py-1.5 rounded bg-blue-600 text-white text-sm",disabled:l,onClick:h,children:l?"Saving…":"Save Changes"})})]})}function P(a,r){return r.split(".").reduce((n,l)=>n?n[l]:void 0,a)}function g(a,r,n){a(l=>{var x;const o=D(l),i=r.split(".");let c=o;for(let d=0;d<i.length-1;d++)c=c[x=i[d]]||(c[x]={});return c[i.at(-1)]=n,o})}function I({label:a,type:r="text",value:n,onChange:l,placeholder:o}){return e.jsxs("div",{children:[e.jsx("label",{className:"text-sm",children:a}),e.jsx("input",{type:r,className:"mt-1 w-full rounded border px-3 py-2 text-sm",value:n,onChange:i=>l(i.target.value),placeholder:o})]})}function U({label:a,value:r,onChange:n}){return e.jsxs("div",{children:[e.jsx("label",{className:"text-sm",children:a}),e.jsxs("div",{className:"mt-1 flex items-center gap-3",children:[e.jsx("input",{type:"color",className:"w-10 h-10 rounded border",value:r,onChange:l=>n(l.target.value)}),e.jsx("input",{type:"text",className:"flex-1 rounded border px-3 py-2 text-sm",value:r,onChange:l=>n(l.target.value),placeholder:"#1d4ed8"})]})]})}function z(a){try{return JSON.stringify(a??{},null,2)}catch{return"{}"}}function D(a){return typeof structuredClone=="function"?structuredClone(a):JSON.parse(JSON.stringify(a??{}))}export{R as default};
