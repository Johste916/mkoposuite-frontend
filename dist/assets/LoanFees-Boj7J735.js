import{j as s}from"./index-my7z7wz1.js";import{u as b}from"./useSettingsResource-Cq4Wjk8y.js";import{S as m}from"./settings-NleZKq07.js";import"./index-RLxl0L8b.js";const j=()=>typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now().toString(36)}-${Math.random().toString(36).slice(2,10)}`;function k(){const{data:o,setData:n,loading:x,saving:i,error:l,success:c,save:u}=b(m.getLoanFees,m.saveLoanFees,{fees:[]}),p=()=>n(e=>({...e,fees:[...e.fees||[],{id:j(),name:"",mode:"fixed",amount:0,productIds:[],active:!0}]})),d=(e,t)=>n(a=>({...a,fees:(a.fees||[]).map(r=>r.id===e?{...r,...t}:r)})),h=e=>n(t=>({...t,fees:(t.fees||[]).filter(a=>a.id!==e)})),g=e=>{if(e===""||e===null||typeof e>"u")return 0;const t=Number(e);return Number.isFinite(t)?t:0};return x?s.jsx("div",{className:"p-4 text-sm text-slate-500",children:"Loading…"}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("header",{className:"bg-white dark:bg-slate-900 border rounded-2xl p-4",children:[s.jsx("h1",{className:"text-xl font-semibold",children:"Loan Fees"}),s.jsx("p",{className:"text-sm text-slate-500",children:"Configure fixed/percent fees and link them to products."})]}),l&&s.jsx("div",{className:"text-sm text-rose-600",children:l}),c&&s.jsx("div",{className:"text-sm text-emerald-600",children:c}),s.jsxs("div",{className:"bg-white dark:bg-slate-900 border rounded-2xl p-4 space-y-3",children:[s.jsx("button",{className:"px-3 py-1.5 rounded bg-slate-100",onClick:p,children:"Add Fee"}),(o.fees||[]).length===0?s.jsx("div",{className:"text-sm text-slate-500",children:"No fees yet."}):s.jsx("div",{className:"space-y-3",children:o.fees.map(e=>s.jsxs("div",{className:"p-3 border rounded-lg grid grid-cols-1 md:grid-cols-6 gap-2",children:[s.jsx("input",{className:"rounded border px-3 py-2 text-sm",placeholder:"Name",value:e.name||"",onChange:t=>d(e.id,{name:t.target.value})}),s.jsxs("select",{className:"rounded border px-3 py-2 text-sm",value:e.mode||"fixed",onChange:t=>d(e.id,{mode:t.target.value}),children:[s.jsx("option",{value:"fixed",children:"Fixed (amount)"}),s.jsx("option",{value:"percent",children:"Percent (%)"})]}),s.jsx("input",{type:"number",className:"rounded border px-3 py-2 text-sm",placeholder:"Amount / %",value:e.amount??0,onChange:t=>d(e.id,{amount:g(t.target.value)})}),s.jsx("input",{className:"rounded border px-3 py-2 text-sm",placeholder:"Product IDs (comma)",value:(e.productIds||[]).join(","),onChange:t=>d(e.id,{productIds:t.target.value.split(",").map(a=>a.trim()).filter(Boolean).map(a=>Number(a)).filter(a=>Number.isFinite(a))})}),s.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[s.jsx("input",{type:"checkbox",checked:!!e.active,onChange:t=>d(e.id,{active:t.target.checked})}),"Active"]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("button",{className:"px-3 py-1.5 rounded bg-rose-50 text-rose-700",onClick:()=>h(e.id),children:"Delete"})})]},e.id))})]}),s.jsx("button",{className:"px-3 py-1.5 rounded bg-blue-600 text-white text-sm",disabled:i,onClick:()=>u(),children:i?"Saving…":"Save"})]})}export{k as default};
