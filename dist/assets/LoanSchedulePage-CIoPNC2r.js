const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jspdf.es.min-jApFZpkQ.js","assets/index-L976ZryY.js","assets/index-Bo2NLxGI.css"])))=>i.map(i=>d[i]);
import{i as se,l as ne,r as f,h as T,j as t,_ as X}from"./index-L976ZryY.js";const i=(s,g="TZS")=>`‎${g} ${Number(s||0).toLocaleString()}`,q=s=>s?new Date(s).toLocaleDateString():"—",z=s=>{if(!s)return"";const g=new Date(s);return Number.isNaN(g.getTime())?String(s).slice(0,10):g.toISOString().slice(0,10)};function ie(s){return s?Array.isArray(s)?s:Array.isArray(s.schedule)?s.schedule:Array.isArray(s.rows)?s.rows:Array.isArray(s.data)?s.data:[]:[]}function de(s=[],g=0){let l=Number(g||0),h=0,e=0,P=0,m=0;for(const w of s){const j=Number(w.fee??w.fees??0),_=Number(w.penalty??0),a=Number(w.interest??0),O=Number(w.principal??0);if(l<=0)break;const E=Math.min(l,j);if(m+=E,l-=E,l<=0)break;const B=Math.min(l,_);if(P+=B,l-=B,l<=0)break;const U=Math.min(l,a);if(e+=U,l-=U,l<=0)break;const k=Math.min(l,O);h+=k,l-=k}return{paidPrincipal:h,paidInterest:e,paidPenalty:P,paidFees:m}}function re(s=[],g=[]){const l=($,M)=>$.reduce((K,u)=>K+Number((u==null?void 0:u[M])||0),0),h=l(s,"principal"),e=l(s,"interest"),P=l(s,"penalty"),m=l(s,"fee")+l(s,"fees"),w=l(s,"total")||h+e+P+m,j=g.reduce(($,M)=>$+Number(M.amount||0),0),_=l(s,"paidPrincipal")||0,a=l(s,"paidInterest")||0,O=l(s,"paidPenalty")||0,E=(l(s,"paidFees")||0)+(l(s,"paidFee")||0),U=_+a+O+E>0?{paidPrincipal:_,paidInterest:a,paidPenalty:O,paidFees:E}:de(s,j),k=Math.max(w-j,0),S=s.find($=>$.paid||$.settled?!1:Number($.balance??Number($.total||0))>0)||null;return{scheduledPrincipal:h,scheduledInterest:e,scheduledPenalty:P,scheduledFees:m,scheduledTotal:w,totalPaid:j,outstandingTotal:k,nextDue:S?{idx:S.installment??S.period??s.indexOf(S)+1,date:S.dueDate||S.date||null,amount:Number(S.total??0)}:null,...U}}async function le(){var g,l;let s={name:"MkopoSuite",address:"",phone:"",email:"",website:"",logoUrl:""};try{const e=(await T.get("/settings")).data||{};return s={name:e.companyName||e.name||s.name,address:e.companyAddress||e.address||s.address,phone:e.companyPhone||e.phone||s.phone,email:e.companyEmail||e.email||s.email,website:e.companyWebsite||e.website||s.website,logoUrl:e.logoUrl||e.companyLogoUrl||s.logoUrl},s}catch{}try{const e=((g=(await T.get("/account")).data)==null?void 0:g.settings)||{};return s={name:e.companyName||e.name||s.name,address:e.companyAddress||e.address||s.address,phone:e.companyPhone||e.phone||s.phone,email:e.companyEmail||e.email||s.email,website:e.companyWebsite||e.website||s.website,logoUrl:e.logoUrl||e.companyLogoUrl||s.logoUrl},s}catch{}try{const e=((l=(await T.get("/settings/sidebar")).data)==null?void 0:l.app)||{};s.name=e.name||s.name,s.logoUrl=e.logoUrl||s.logoUrl}catch{}return s}function ce(s=[]){const g=s.map(h=>new Date(h.dueDate||h.date)).filter(h=>!Number.isNaN(h.getTime()));if(g.length<2)return"";let l=0;for(let h=1;h<g.length;h++){const e=g[h-1],P=g[h],m=(P.getFullYear()-e.getFullYear())*12+(P.getMonth()-e.getMonth()),w=Math.abs(P.getDate()-e.getDate())<=2;m===1&&w&&l++}return l>=Math.max(1,g.length-2)?"Monthly":""}function pe(){const s=se(),[g]=ne(),[l,h]=f.useState(""),[e,P]=f.useState(null),[m,w]=f.useState([]),[j,_]=f.useState(""),[a,O]=f.useState("TZS"),[E,B]=f.useState([]),[U,k]=f.useState(!1),[S,$]=f.useState(!0),[M,K]=f.useState(""),[u,J]=f.useState({name:"MkopoSuite",address:"",phone:"",email:"",website:"",logoUrl:""}),Y=f.useRef(null),L=f.useRef(!1);f.useEffect(()=>{L.current=!0;const n=s.id?String(s.id):"",x=g.get("id")||"",o=n||x||"";return o&&(h(o),W(o)),()=>{L.current=!1}},[]),f.useEffect(()=>{le().then(n=>L.current&&J(n)).catch(()=>{})},[]);const W=async n=>{var x,o,v;if(n){k(!0),K("");try{const[N,c]=await Promise.all([T.get(`/loans/${n}/schedule`),T.get(`/loans/${n}`)]),y=c.data||null;if(!L.current)return;P(y);const C=ie(N.data);w(C);const F=((x=N.data)==null?void 0:x.interestMethod)||((o=N.data)==null?void 0:o.method)||"",A=(y==null?void 0:y.interestMethod)||"";_(F||A||"");const I=(v=N.data)==null?void 0:v.currency,p=y==null?void 0:y.currency;(I||p)&&O(I||p);const D=await T.get(`/repayments/loan/${n}`).then(b=>b.data||[]).catch(()=>[]);if(!L.current)return;B(D);const R=((D==null?void 0:D.length)||0)>0,d=((y==null?void 0:y.status)||"").toLowerCase();if(R&&d&&!["active","closed"].includes(d))try{await T.patch(`/loans/${n}/status`,{status:"active"});const b=await T.get(`/loans/${n}`);L.current&&P(b.data||y||null)}catch{}window.dispatchEvent(new CustomEvent("loan:updated",{detail:{id:n}}))}catch{if(!L.current)return;w([]),B([]),P(null),_(""),K("We couldn’t load this loan or its schedule. Please verify the Loan ID and try again.")}finally{L.current&&k(!1)}}},Q=async n=>{n.preventDefault();const x=l.trim();if(!x){K("Please enter a Loan ID.");return}await W(x)};f.useEffect(()=>{const n=()=>l&&W(l.trim());return window.addEventListener("focus",n),()=>window.removeEventListener("focus",n)},[l]),f.useEffect(()=>{if(!(!l||!S))return Y.current&&clearInterval(Y.current),Y.current=setInterval(()=>{document.visibilityState==="visible"&&W(l.trim())},1e4),()=>Y.current&&clearInterval(Y.current)},[l,S]);const r=f.useMemo(()=>re(m||[],E||[]),[m,E]),Z=f.useMemo(()=>ce(m),[m]),ee=()=>{var I;if(!m.length)return;const n=(e==null?void 0:e.releaseDate)||(e==null?void 0:e.startDate)||"",x=[["Company",u.name],["Address",u.address],["Phone",u.phone],["Email",u.email],["Website",u.website],[],["Loan ID",(e==null?void 0:e.id)??l],["Borrower",((I=e==null?void 0:e.Borrower)==null?void 0:I.name)||(e==null?void 0:e.borrowerName)||""],["Status",(e==null?void 0:e.status)||""],["Currency",a],["Interest Method",j],["Disbursed",z(n)],["Generated At",new Date().toLocaleString()],[]],o=["Installment","Due Date","Principal","Interest","Total P&I","Penalty","Fees","Paid Principal","Paid Interest","Outstanding","Settled"],v=m.map((p,D)=>{const R=Number(p.principal||0)+Number(p.interest||0),d=p.balance!=null?Number(p.balance):p.paid||p.settled?0:p.total!=null?Number(p.total):R+Number(p.penalty||0)+Number(p.fee??p.fees??0);return[p.installment??p.period??D+1,z(p.dueDate??p.date??""),Number(p.principal??0),Number(p.interest??0),Number(R),Number(p.penalty??0),Number(p.fee??p.fees??0),p.paidPrincipal!=null?Number(p.paidPrincipal):"",p.paidInterest!=null?Number(p.paidInterest):"",d,p.paid||p.settled?"YES":"NO"]}),N=[[],["Totals","",r.scheduledPrincipal,r.scheduledInterest,r.scheduledPrincipal+r.scheduledInterest,r.scheduledPenalty,r.scheduledFees,r.paidPrincipal,r.paidInterest,r.outstandingTotal,""],["Total Paid","","","","","","","","",r.totalPaid,""]],y=[...x,o,...v,...N].map(p=>p.map(D=>`"${String(D??"").replace(/"/g,'""')}"`).join(",")).join(`
`),C=new Blob([y],{type:"text/csv;charset=utf-8;"}),F=URL.createObjectURL(C),A=document.createElement("a");A.href=F,A.download=`loan_${(e==null?void 0:e.id)??l}_schedule.csv`,A.click(),URL.revokeObjectURL(F)},te=async()=>{var D,R;if(!m.length)return;let n,x;try{n=(await X(async()=>{const{default:d}=await import("./jspdf.es.min-jApFZpkQ.js").then(b=>b.j);return{default:d}},__vite__mapDeps([0,1,2]))).default,x=(await X(async()=>{const{default:d}=await import("./jspdf.plugin.autotable-CfO62xhj.js");return{default:d}},[])).default}catch{return ae()}const o=new n({unit:"pt",format:"a4"}),v=o.internal.pageSize.getWidth(),N=40;let c=40;if(u.logoUrl)try{const d=await fetch(u.logoUrl).then(H=>H.blob()),b=new FileReader,V=new Promise(H=>{b.onload=()=>H(b.result)});b.readAsDataURL(d);const G=await V;o.addImage(G,"PNG",N,c,120,40)}catch{}o.setFontSize(14),o.text(u.name||"Company",N,c+65),o.setFontSize(10),[u.address,[u.phone,u.email].filter(Boolean).join("  •  "),u.website].filter(Boolean).forEach((d,b)=>o.text(String(d),N,c+80+b*14)),o.setFontSize(16),o.text("Loan Repayment Schedule",v-40,50,{align:"right"}),o.setFontSize(10),[`Loan ID: ${(e==null?void 0:e.id)??l}`,`Borrower: ${((D=e==null?void 0:e.Borrower)==null?void 0:D.name)||(e==null?void 0:e.borrowerName)||""}`,`Status: ${(e==null?void 0:e.status)||""}`,`Currency: ${a}`,`Interest Method: ${j||""}`,`Disbursed: ${z((e==null?void 0:e.releaseDate)||(e==null?void 0:e.startDate)||"")}`,`Generated: ${new Date().toLocaleString()}`].forEach((d,b)=>o.text(d,v-40,68+b*14,{align:"right"}));const F=[{header:"#",dataKey:"idx"},{header:"Due Date",dataKey:"dueDate"},{header:"Principal",dataKey:"principal"},{header:"Interest",dataKey:"interest"},{header:"Total P&I",dataKey:"pi"},{header:"Penalty",dataKey:"penalty"},{header:"Fees",dataKey:"fees"},{header:"Paid Principal",dataKey:"paidP"},{header:"Paid Interest",dataKey:"paidI"},{header:"Outstanding",dataKey:"outstanding"},{header:"Settled",dataKey:"settled"}],A=m.map((d,b)=>{const V=Number(d.principal||0)+Number(d.interest||0),G=d.balance!=null?Number(d.balance):d.paid||d.settled?0:d.total!=null?Number(d.total):V+Number(d.penalty||0)+Number(d.fee??d.fees??0);return{idx:d.installment??d.period??b+1,dueDate:z(d.dueDate??d.date??""),principal:i(d.principal,a),interest:i(d.interest,a),pi:i(V,a),penalty:i(d.penalty||0,a),fees:i(d.fee??d.fees??0,a),paidP:d.paidPrincipal!=null?i(d.paidPrincipal,a):"—",paidI:d.paidInterest!=null?i(d.paidInterest,a):"—",outstanding:i(G,a),settled:d.paid||d.settled?"YES":"NO"}});x(o,{head:[F.map(d=>d.header)],body:A.map(d=>F.map(b=>d[b.dataKey])),startY:140,styles:{fontSize:9},headStyles:{fillColor:[243,244,246],textColor:20},alternateRowStyles:{fillColor:[250,250,250]},margin:{left:40,right:40},didDrawPage:()=>{const d=`Page ${o.internal.getNumberOfPages()}`;o.setFontSize(9),o.text(d,v-40,o.internal.pageSize.getHeight()-20,{align:"right"})}});let I=((R=o.lastAutoTable)==null?void 0:R.finalY)||140;I+=16,o.setFontSize(11),o.text("Summary",40,I),I+=8,o.setFontSize(10),[["Principal (Sched.)",i(r.scheduledPrincipal,a)],["Interest (Sched.)",i(r.scheduledInterest,a)],["Total P&I (Sched.)",i(r.scheduledPrincipal+r.scheduledInterest,a)],["Penalty (Sched.)",i(r.scheduledPenalty,a)],["Fees (Sched.)",i(r.scheduledFees,a)],["Total Payable",i(r.scheduledTotal,a)],["Paid Principal",i(r.paidPrincipal,a)],["Paid Interest",i(r.paidInterest,a)],["Total Paid",i(r.totalPaid,a)],["Outstanding",i(r.outstandingTotal,a)]].forEach((d,b)=>{o.text(d[0],40,I+16+b*14),o.text(d[1],v-40,I+16+b*14,{align:"right"})}),o.save(`loan_${(e==null?void 0:e.id)??l}_schedule.pdf`)},ae=()=>{var N;const n=m.map((c,y)=>{const C=Number(c.principal||0)+Number(c.interest||0),F=c.balance!=null?Number(c.balance):c.paid||c.settled?0:c.total!=null?Number(c.total):C+Number(c.penalty||0)+Number(c.fee??c.fees??0);return`
          <tr>
            <td>${c.installment??c.period??y+1}</td>
            <td>${z(c.dueDate??c.date??"")}</td>
            <td>${i(c.principal,a)}</td>
            <td>${i(c.interest,a)}</td>
            <td>${i(C,a)}</td>
            <td>${i(c.penalty||0,a)}</td>
            <td>${i(c.fee??c.fees??0,a)}</td>
            <td>${c.paidPrincipal!=null?i(c.paidPrincipal,a):"—"}</td>
            <td>${c.paidInterest!=null?i(c.paidInterest,a):"—"}</td>
            <td>${i(F,a)}</td>
            <td>${c.paid||c.settled?"YES":"NO"}</td>
          </tr>
        `}).join(""),x=u.logoUrl?`<img src="${u.logoUrl}" style="height:48px;object-fit:contain;margin-right:12px;" />`:"",o=`
      <html>
        <head>
          <meta charset="utf-8" />
          <title>Loan ${(e==null?void 0:e.id)??l} Schedule</title>
          <style>
            body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Noto Sans', 'Helvetica Neue', Arial; color:#111827; }
            .container { max-width: 1024px; margin: 24px auto; }
            .header { display:flex; align-items:center; justify-content:space-between; }
            .company { display:flex; align-items:center; }
            .company h1 { margin:0; font-size:18px; }
            .muted { color:#6B7280; font-size:12px; }
            table { width:100%; border-collapse: collapse; margin-top: 16px; }
            th, td { border: 1px solid #E5E7EB; padding: 6px 8px; font-size: 12px; }
            thead { background:#F3F4F6; }
            .summary { margin-top:16px; display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap:8px; }
            .card { border:1px solid #E5E7EB; padding:8px 10px; border-radius:8px; }
            .cal { margin-top:10px; display:flex; flex-wrap: wrap; gap:6px; font-size:12px; }
            .pill { border:1px solid #E5E7EB; border-radius:9999px; padding:3px 8px; background:#fff; }
            @media print { .no-print { display:none; } }
          </style>
        </head>
        <body>
          <div class="container">
            <div class="header">
              <div class="company">
                ${x}
                <div>
                  <h1>${u.name||""}</h1>
                  <div class="muted">
                    ${[u.address,u.phone,u.email,u.website].filter(Boolean).join(" • ")}
                  </div>
                </div>
              </div>
              <div>
                <div style="font-weight:600;">Loan Repayment Schedule</div>
                <div class="muted">Generated: ${new Date().toLocaleString()}</div>
              </div>
            </div>

            <div style="margin-top:12px;font-size:12px;">
              <div><b>Loan ID:</b> ${(e==null?void 0:e.id)??l}</div>
              <div><b>Borrower:</b> ${((N=e==null?void 0:e.Borrower)==null?void 0:N.name)||(e==null?void 0:e.borrowerName)||""}</div>
              <div><b>Status:</b> ${(e==null?void 0:e.status)||""}</div>
              <div><b>Currency:</b> ${a} &nbsp; • &nbsp; <b>Interest Method:</b> ${j||""}</div>
              <div><b>Disbursed:</b> ${z((e==null?void 0:e.releaseDate)||(e==null?void 0:e.startDate)||"")}</div>
            </div>

            <div class="cal">
              ${m.map((c,y)=>`<span class="pill">#${c.installment??c.period??y+1}: ${z(c.dueDate||c.date||"")}</span>`).join("")}
            </div>

            <table>
              <thead>
                <tr>
                  <th>#</th>
                  <th>Due Date</th>
                  <th>Principal</th>
                  <th>Interest</th>
                  <th>Total P&I</th>
                  <th>Penalty</th>
                  <th>Fees</th>
                  <th>Paid Principal</th>
                  <th>Paid Interest</th>
                  <th>Outstanding</th>
                  <th>Settled</th>
                </tr>
              </thead>
              <tbody>
                ${n}
              </tbody>
            </table>

            <div class="summary">
              <div class="card"><div class="muted">Principal (Sched.)</div><div><b>${i(r.scheduledPrincipal,a)}</b></div></div>
              <div class="card"><div class="muted">Interest (Sched.)</div><div><b>${i(r.scheduledInterest,a)}</b></div></div>
              <div class="card"><div class="muted">Total P&I (Sched.)</div><div><b>${i(r.scheduledPrincipal+r.scheduledInterest,a)}</b></div></div>
              <div class="card"><div class="muted">Penalty (Sched.)</div><div><b>${i(r.scheduledPenalty,a)}</b></div></div>
              <div class="card"><div class="muted">Fees (Sched.)</div><div><b>${i(r.scheduledFees,a)}</b></div></div>
              <div class="card"><div class="muted">Total Payable</div><div><b>${i(r.scheduledTotal,a)}</b></div></div>
              <div class="card"><div class="muted">Paid Principal</div><div><b>${i(r.paidPrincipal,a)}</b></div></div>
              <div class="card"><div class="muted">Paid Interest</div><div><b>${i(r.paidInterest,a)}</b></div></div>
              <div class="card"><div class="muted">Total Paid</div><div><b>${i(r.totalPaid,a)}</b></div></div>
              <div class="card"><div class="muted">Outstanding</div><div><b>${i(r.outstandingTotal,a)}</b></div></div>
            </div>

            <div class="no-print" style="margin-top:16px;">
              <button onclick="window.print()" style="padding:8px 12px;border:1px solid #E5E7EB;border-radius:8px;background:white;cursor:pointer;">Print / Save as PDF</button>
            </div>
          </div>
        </body>
      </html>
    `,v=window.open("","_blank","noopener,noreferrer,width=1024,height=768");v&&(v.document.open(),v.document.write(o),v.document.close())};return t.jsxs("div",{className:"p-4 space-y-4",children:[t.jsxs("div",{className:"flex items-start justify-between flex-wrap gap-3",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold",children:"Loan Schedule"}),e&&t.jsxs("p",{className:"text-sm text-gray-600",children:["Loan ",t.jsxs("b",{children:["#",e.id]})," — Status: ",t.jsx("span",{className:"inline-block rounded-full px-2 py-0.5 text-xs bg-slate-100 border",children:e.status})]}),t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[u.name,u.address?` • ${u.address}`:"",u.phone?` • ${u.phone}`:"",u.email?` • ${u.email}`:""]}),e&&t.jsxs("p",{className:"text-xs text-gray-700 mt-1",children:[t.jsx("b",{children:"Disbursed:"})," ",q(e.releaseDate||e.startDate),Z&&t.jsxs(t.Fragment,{children:[" • ",t.jsx("b",{children:"Frequency:"})," ",Z]})]}),(r==null?void 0:r.nextDue)&&t.jsxs("p",{className:"text-xs text-gray-700 mt-1",children:["Next Installment #",r.nextDue.idx," on ",q(r.nextDue.date)," —"," ",t.jsx("b",{children:i(r.nextDue.amount,a)})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>l&&W(l.trim()),className:"px-3 py-2 rounded border hover:bg-gray-50",children:"Refresh"}),t.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[t.jsx("input",{type:"checkbox",checked:S,onChange:n=>$(n.target.checked)}),"Auto-refresh"]}),t.jsx("button",{onClick:ee,disabled:!m.length,className:"px-3 py-2 rounded border hover:bg-gray-50 disabled:opacity-50",title:"Download as CSV",children:"Download CSV"}),t.jsx("button",{onClick:te,disabled:!m.length,className:"bg-indigo-600 text-white px-3 py-2 rounded hover:bg-indigo-700 disabled:opacity-50",title:"Download as PDF",children:"Download PDF"})]})]}),t.jsxs("form",{onSubmit:Q,className:"flex gap-2 flex-wrap",children:[t.jsx("input",{className:"border px-3 py-2 rounded w-64",placeholder:"Enter Loan ID",value:l,onChange:n=>h(n.target.value)}),t.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded",children:U?"Loading…":"Load"}),j&&t.jsxs("div",{className:"self-center text-sm text-gray-700",children:["Interest Method: ",t.jsx("b",{children:j})]})]}),M&&t.jsx("div",{className:"text-sm text-red-600 border border-red-200 bg-red-50 rounded px-3 py-2",children:M}),!!m.length&&t.jsxs("div",{className:"bg-white rounded border shadow p-3",children:[t.jsxs("div",{className:"grid sm:grid-cols-3 lg:grid-cols-6 gap-3 text-sm",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500 text-xs",children:"Principal (Sched.)"}),t.jsx("div",{className:"font-semibold",children:i(r.scheduledPrincipal,a)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500 text-xs",children:"Interest (Sched.)"}),t.jsx("div",{className:"font-semibold",children:i(r.scheduledInterest,a)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500 text-xs",children:"Total P&I (Sched.)"}),t.jsx("div",{className:"font-semibold",children:i(r.scheduledPrincipal+r.scheduledInterest,a)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500 text-xs",children:"Penalty (Sched.)"}),t.jsx("div",{className:"font-semibold",children:i(r.scheduledPenalty,a)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500 text-xs",children:"Fees (Sched.)"}),t.jsx("div",{className:"font-semibold",children:i(r.scheduledFees,a)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500 text-xs",children:"Total Payable"}),t.jsx("div",{className:"font-semibold",children:i(r.scheduledTotal,a)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500 text-xs",children:"Paid Principal"}),t.jsx("div",{className:"font-semibold",children:i(r.paidPrincipal,a)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500 text-xs",children:"Paid Interest"}),t.jsx("div",{className:"font-semibold",children:i(r.paidInterest,a)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500 text-xs",children:"Total Paid"}),t.jsx("div",{className:"font-semibold",children:i(r.totalPaid,a)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500 text-xs",children:"Outstanding"}),t.jsx("div",{className:"font-semibold",children:i(r.outstandingTotal,a)})]})]}),t.jsx("div",{className:"mt-3 flex flex-wrap gap-2 text-xs",children:m.map((n,x)=>t.jsxs("span",{className:"px-2 py-1 rounded-full border bg-white",children:["#",n.installment??n.period??x+1,": ",q(n.dueDate||n.date)]},x))})]}),!!m.length&&t.jsx("div",{className:"overflow-auto rounded border shadow",children:t.jsxs("table",{className:"min-w-full bg-white",children:[t.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:t.jsxs("tr",{className:"text-left text-sm",children:[t.jsx("th",{className:"p-2 border",children:"#"}),t.jsx("th",{className:"p-2 border",children:"Due Date"}),t.jsx("th",{className:"p-2 border",children:"Principal"}),t.jsx("th",{className:"p-2 border",children:"Interest"}),t.jsx("th",{className:"p-2 border",children:"Total P&I"}),t.jsx("th",{className:"p-2 border",children:"Penalty"}),t.jsx("th",{className:"p-2 border",children:"Fees"}),t.jsx("th",{className:"p-2 border",children:"Paid Principal"}),t.jsx("th",{className:"p-2 border",children:"Paid Interest"}),t.jsx("th",{className:"p-2 border",children:"Outstanding"}),t.jsx("th",{className:"p-2 border",children:"Status"})]})}),t.jsx("tbody",{className:"text-sm",children:m.map((n,x)=>{const o=n.installment??n.period??x+1,v=Number(n.principal||0)+Number(n.interest||0),N=n.balance!=null?Number(n.balance):n.paid||n.settled?0:n.total!=null?Number(n.total):v+Number(n.penalty||0)+Number(n.fee??n.fees??0),c=n.paid||n.settled?"Settled":"Pending";return t.jsxs("tr",{className:x%2?"bg-gray-50":"",children:[t.jsx("td",{className:"border px-2 py-1 whitespace-nowrap",children:o}),t.jsx("td",{className:"border px-2 py-1 whitespace-nowrap",children:q(n.dueDate||n.date)}),t.jsx("td",{className:"border px-2 py-1 whitespace-nowrap",children:i(n.principal,a)}),t.jsx("td",{className:"border px-2 py-1 whitespace-nowrap",children:i(n.interest,a)}),t.jsx("td",{className:"border px-2 py-1 whitespace-nowrap",children:i(v,a)}),t.jsx("td",{className:"border px-2 py-1 whitespace-nowrap",children:i(n.penalty||0,a)}),t.jsx("td",{className:"border px-2 py-1 whitespace-nowrap",children:i(n.fee??n.fees??0,a)}),t.jsx("td",{className:"border px-2 py-1 whitespace-nowrap",children:n.paidPrincipal!=null?i(n.paidPrincipal,a):"—"}),t.jsx("td",{className:"border px-2 py-1 whitespace-nowrap",children:n.paidInterest!=null?i(n.paidInterest,a):"—"}),t.jsx("td",{className:"border px-2 py-1 whitespace-nowrap",children:i(N,a)}),t.jsx("td",{className:"border px-2 py-1 whitespace-nowrap",children:c==="Settled"?t.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-emerald-50 text-emerald-700 ring-1 ring-emerald-200",children:"Settled"}):t.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-amber-50 text-amber-700 ring-1 ring-amber-200",children:"Pending"})})]},x)})})]})}),!U&&l&&!m.length&&!M&&t.jsx("p",{className:"text-sm text-gray-600",children:"No schedule found for this loan."})]})}export{pe as default};
