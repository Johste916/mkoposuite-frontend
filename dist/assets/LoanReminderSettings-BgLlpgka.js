import{j as e}from"./index-C7zRMVMn.js";import{u as g}from"./useSettingsResource-B9n2cTOd.js";import{S as u}from"./settings-BBqQ4PwN.js";import"./index-BQw7zDX7.js";const j=()=>typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now().toString(36)}-${Math.random().toString(36).slice(2,10)}`,v=(n,d=0)=>{if(n===""||n===null||typeof n>"u")return d;const l=Number(n);return Number.isFinite(l)?l:d};function D(){const{data:n,setData:d,loading:l,saving:o,error:c,success:m,save:p}=g(u.getLoanReminders,u.saveLoanReminders,{rules:[]}),x=()=>d(s=>({...s,rules:[...s.rules||[],{id:j(),name:"Due in 3 days",offsetDays:-3,channels:["sms"],productIds:[],active:!0}]})),r=(s,t)=>d(a=>({...a,rules:(a.rules||[]).map(i=>i.id===s?{...i,...t}:i)})),h=s=>d(t=>({...t,rules:(t.rules||[]).filter(a=>a.id!==s)}));return l?e.jsx("div",{className:"p-4 text-sm text-slate-500",children:"Loading…"}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("header",{className:"bg-white dark:bg-slate-900 border rounded-2xl p-4",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Loan Reminder Settings"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Define reminder rules per loan product or category."})]}),c&&e.jsx("div",{className:"text-sm text-rose-600",children:c}),m&&e.jsx("div",{className:"text-sm text-emerald-600",children:m}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 border rounded-2xl p-4 space-y-3",children:[e.jsx("button",{className:"px-3 py-1.5 rounded bg-slate-100",onClick:x,children:"Add Rule"}),(n.rules||[]).length===0?e.jsx("div",{className:"text-sm text-slate-500",children:"No rules yet."}):e.jsx("div",{className:"space-y-3",children:n.rules.map(s=>e.jsxs("div",{className:"p-3 border rounded-lg grid grid-cols-1 md:grid-cols-7 gap-2",children:[e.jsx("input",{className:"rounded border px-3 py-2 text-sm",placeholder:"Name",value:s.name||"",onChange:t=>r(s.id,{name:t.target.value})}),e.jsx("input",{type:"number",className:"rounded border px-3 py-2 text-sm",placeholder:"Offset days (e.g. -3)",value:s.offsetDays??-3,onChange:t=>r(s.id,{offsetDays:v(t.target.value,-3)})}),e.jsxs("select",{multiple:!0,className:"rounded border px-3 py-2 text-sm",value:s.channels||[],onChange:t=>r(s.id,{channels:[...t.target.selectedOptions].map(a=>a.value)}),children:[e.jsx("option",{value:"sms",children:"SMS"}),e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"push",children:"Push"})]}),e.jsx("input",{className:"rounded border px-3 py-2 text-sm",placeholder:"Product IDs (comma)",value:(s.productIds||[]).join(","),onChange:t=>r(s.id,{productIds:t.target.value.split(",").map(a=>a.trim()).filter(Boolean).map(Number)})}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:!!s.active,onChange:t=>r(s.id,{active:t.target.checked})}),"Active"]}),e.jsx("div",{className:"md:col-span-2 flex items-center gap-2",children:e.jsx("button",{className:"px-3 py-1.5 rounded bg-rose-50 text-rose-700",onClick:()=>h(s.id),children:"Delete"})})]},s.id))})]}),e.jsx("button",{className:"px-3 py-1.5 rounded bg-blue-600 text-white text-sm",disabled:o,onClick:()=>p(),children:o?"Saving…":"Save"})]})}export{D as default};
