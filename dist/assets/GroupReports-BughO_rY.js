import{r as n,j as s,g as x}from"./index-C40kITj2.js";function i(t){const r=(t.startsWith("/")?t:`/${t}`).replace(/^\/api\//,"/"),c=r.startsWith("/api/")?r:`/api${r}`;return Array.from(new Set([r,c]))}async function h(t=[],e={}){let r;for(const c of t)try{const a=await x.get(c,e);return a==null?void 0:a.data}catch(a){r=a}throw r||new Error("No endpoint succeeded")}function f(t){const e=(t==null?void 0:t.summary)||t||{},r=a=>Number(a||0),c=a=>typeof a=="string"&&a.trim().endsWith("%")?a:`${Number(a||0).toFixed(2).replace(/\.00$/,"")}%`;return{totalGroups:r(e.totalGroups??e.groups??e.count),activeGroups:r(e.activeGroups??e.active??e.enabled),totalLoans:r(e.totalLoans??e.groupLoans??e.loans),par:c(e.par??e.portfolioAtRisk??e.par30??0)}}const v=()=>{const[t,e]=n.useState({totalGroups:0,activeGroups:0,totalLoans:0,par:"0%"}),[r,c]=n.useState(!0),[a,l]=n.useState(""),d=async()=>{var p,m,u;try{c(!0),l("");const o=await h([...i("borrowers/groups/reports/summary"),...i("groups/reports/summary"),...i("borrower-groups/reports/summary")]);e(f(o))}catch(o){l(((p=o==null?void 0:o.response)==null?void 0:p.status)===404?"Group report endpoint not implemented.":((u=(m=o==null?void 0:o.response)==null?void 0:m.data)==null?void 0:u.error)||(o==null?void 0:o.message)||"Failed to load group report data."),e({totalGroups:0,activeGroups:0,totalLoans:0,par:"0%"})}finally{c(!1)}};return n.useEffect(()=>{d()},[]),s.jsxs("div",{className:"p-4 space-y-4 bg-[var(--bg)] text-[var(--fg)]",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h1",{className:"text-2xl font-semibold",children:"Group Reports"}),s.jsx("button",{onClick:d,className:"px-3 py-2 rounded border border-[var(--border)] hover:bg-gray-50 dark:hover:bg-slate-800",children:"Refresh"})]}),r?s.jsx("p",{className:"muted",children:"Loading group analytics..."}):a?s.jsx("p",{className:"text-rose-600 dark:text-rose-400",children:a}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"card p-4",children:[s.jsx("div",{className:"text-xs muted",children:"Total Groups"}),s.jsx("div",{className:"text-xl font-semibold",children:t.totalGroups||0})]}),s.jsxs("div",{className:"card p-4",children:[s.jsx("div",{className:"text-xs muted",children:"Active Groups"}),s.jsx("div",{className:"text-xl font-semibold",children:t.activeGroups||0})]}),s.jsxs("div",{className:"card p-4",children:[s.jsx("div",{className:"text-xs muted",children:"Total Group Loans"}),s.jsx("div",{className:"text-xl font-semibold",children:Number(t.totalLoans||0).toLocaleString()})]}),s.jsxs("div",{className:"card p-4",children:[s.jsx("div",{className:"text-xs muted",children:"PAR"}),s.jsx("div",{className:"text-xl font-semibold text-rose-600 dark:text-rose-400",children:t.par||"0%"})]})]}),s.jsx("div",{className:"card p-4",children:s.jsx("p",{className:"text-sm muted",children:"Charts and trends (by branch, officer, performance tiers) will appear here once backend analytics endpoints are available."})})]})]})};export{v as default};
