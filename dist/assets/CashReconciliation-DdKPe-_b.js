import{r as t,j as e}from"./index-DYDSVKWX.js";import{h as j,y as b,z as N,A as y}from"./banking-DaREOshH.js";function v(){const[x,h]=t.useState([]),[a,m]=t.useState(""),[r,p]=t.useState([]),[l,i]=t.useState(!1),[d,c]=t.useState(null);t.useEffect(()=>{j().then(h).catch(s=>c((s==null?void 0:s.normalizedMessage)||String(s)))},[]);const o=async()=>{if(a){i(!0),c(null);try{const s=await b(a,{status:"posted"});p(s||[])}catch(s){c((s==null?void 0:s.normalizedMessage)||String(s))}finally{i(!1)}}},u=async s=>{try{s.reconciled?await N(s.id):await y(s.id),await o()}catch(n){c((n==null?void 0:n.normalizedMessage)||String(n))}};return e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Cash Reconciliation"}),e.jsx("div",{className:"text-xs text-gray-500",children:"/api/banks/cash/transactions/:id/(un)reconcile"})]}),e.jsxs("div",{className:"flex gap-3 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm",children:"Cash Account"}),e.jsxs("select",{className:"border px-2 py-1 rounded",value:a,onChange:s=>m(s.target.value),children:[e.jsx("option",{value:"",children:"-- select --"}),x.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsx("button",{className:"bg-black text-white px-3 py-1 rounded",onClick:o,disabled:!a||l,children:l?"Loading…":"Load"})]}),d&&e.jsx("div",{className:"text-red-600 text-sm",children:d}),e.jsx("div",{className:"overflow-auto border rounded",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border px-2 py-1 text-left",children:"Date"}),e.jsx("th",{className:"border px-2 py-1",children:"Type"}),e.jsx("th",{className:"border px-2 py-1",children:"Dir"}),e.jsx("th",{className:"border px-2 py-1 text-right",children:"Amount"}),e.jsx("th",{className:"border px-2 py-1",children:"Reconciled"}),e.jsx("th",{className:"border px-2 py-1",children:"Action"})]})}),e.jsxs("tbody",{children:[r.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"border px-2 py-1",children:s.occurredAt?new Date(s.occurredAt).toLocaleString():"—"}),e.jsx("td",{className:"border px-2 py-1",children:s.type}),e.jsx("td",{className:"border px-2 py-1",children:s.direction}),e.jsx("td",{className:"border px-2 py-1 text-right",children:Number(s.amount).toLocaleString()}),e.jsx("td",{className:"border px-2 py-1",children:s.reconciled?"Yes":"No"}),e.jsx("td",{className:"border px-2 py-1",children:e.jsx("button",{className:"underline text-blue-700",onClick:()=>u(s),children:s.reconciled?"Unreconcile":"Reconcile"})})]},s.id)),!r.length&&e.jsx("tr",{children:e.jsx("td",{className:"border px-2 py-2 text-center",colSpan:6,children:"No rows"})})]})]})})]})}export{v as default};
