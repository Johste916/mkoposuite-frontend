import{r as u,j as e,g as v}from"./index-SCX1ScrD.js";function b(t){const s=(t.startsWith("/")?t:`/${t}`).replace(/^\/api\//,"/"),o=s.startsWith("/api/")?s:`/api${s}`;return Array.from(new Set([s,o]))}async function h(t=[],c,s={}){let o;for(const m of t)try{const r=await v.post(m,c,s);return r==null?void 0:r.data}catch(r){o=r}throw o||new Error("No endpoint succeeded")}const p={container:"max-w-2xl p-4 space-y-4 bg-[var(--bg)] text-[var(--fg)]",card:"rounded-2xl border-2 border-[var(--border-strong)] bg-[var(--card)] p-4 shadow",muted:"text-xs text-[var(--muted)]",primary:"px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-60 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[var(--ring)]",btn:"px-3 py-2 rounded border-2 border-[var(--border-strong)] bg-[var(--card)] hover:bg-[var(--kpi-bg)] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[var(--ring)]"},w=()=>{const[t,c]=u.useState(null),[s,o]=u.useState(!1),[m,r]=u.useState(""),f=async l=>{var d,a;if(l.preventDefault(),r(""),!t)return;const n=new FormData;n.append("file",t);try{o(!0),await h([...b("borrowers/groups/import"),...b("groups/import"),...b("borrower-groups/import")],n,{headers:{"Content-Type":"multipart/form-data"}}),r("✅ Import uploaded. Processing…"),c(null)}catch(i){const x=((a=(d=i==null?void 0:i.response)==null?void 0:d.data)==null?void 0:a.error)||(i==null?void 0:i.message)||"Import failed.";r(`❌ ${x}`)}finally{o(!1)}},g=()=>{const l=`name,branchId,officerId,meetingDay,notes,members
Group A,1,,monday,Example notes,"254700000001;254700000002"
Group B,1,,friday,,
`,n=new Blob([l],{type:"text/csv;charset=utf-8"}),d=URL.createObjectURL(n),a=document.createElement("a");a.href=d,a.download="group_import_sample.csv",document.body.appendChild(a),a.click(),URL.revokeObjectURL(d),a.remove()};return e.jsxs("div",{className:p.container,children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Group Imports"}),e.jsx("div",{className:p.card,children:e.jsxs("form",{onSubmit:f,className:"space-y-3",children:[e.jsx("input",{type:"file",accept:".csv,.xlsx",onChange:l=>{var n;return c(((n=l.target.files)==null?void 0:n[0])||null)},className:"block w-full"}),e.jsxs("div",{className:p.muted,children:["Accepted: CSV/XLSX. Columns: ",e.jsx("b",{children:"name, branchId, officerId, meetingDay, notes, members"})," ","(meetingDay must be lowercase: monday…sunday; members can be a semicolon-separated list)."]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",disabled:!t||s,className:p.primary,children:s?"Uploading…":"Upload"}),e.jsx("button",{type:"button",onClick:g,className:p.btn,children:"Download Sample"})]}),m&&e.jsx("div",{className:"text-sm",children:m})]})})]})};export{w as default};
