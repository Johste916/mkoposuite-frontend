import{r as i,j as e,b as h}from"./index-Bg9psR-u.js";function y(){const[g,n]=i.useState(null),[p,j]=i.useState(null),[x,d]=i.useState("loading"),[k,m]=i.useState("");async function u(t,l){var o;for(const N of t)try{const r=await h.get(N,l);if(r!=null&&r.data)return r.data}catch(r){if(((o=r==null?void 0:r.response)==null?void 0:o.status)!==404)throw r}const a=new Error("Not Found");throw a.code=404,a}const c=async()=>{var t,l;d("loading"),m("");try{const a=await u(["/tenants/me","/tenant/me","/account/tenant","/account/organization"],{});n(a);const o=await u(["/tenants/me/entitlements","/tenant/me/entitlements","/account/tenant/entitlements","/account/organization/entitlements"],{}).catch(()=>({}));j(o||{}),d("ready")}catch(a){(a==null?void 0:a.code)===404?d("unavailable"):(d("error"),m(((l=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:l.error)||a.message||"Unknown error"))}};if(i.useEffect(()=>{c()},[]),x==="loading")return e.jsx("div",{className:"p-4 text-sm text-slate-500 dark:text-slate-400",children:"Loading…"});if(x==="unavailable")return e.jsxs("div",{className:"ms-card p-4 space-y-3",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Organization"}),e.jsx("div",{className:"rounded border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/40 p-3",children:e.jsxs("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:["Organization settings aren’t available on this server (the ",e.jsx("code",{children:"/tenants/me"})," API is not implemented). If you don’t need this module you can ignore this page."]})})]});if(x==="error")return e.jsxs("div",{className:"p-4 text-sm text-rose-600 dark:text-rose-400",children:["Error: ",k,e.jsx("div",{className:"mt-3",children:e.jsx("button",{onClick:c,className:"h-9 px-3 rounded ms-btn",children:"Retry"})})]});const s=g||{},b=p||{},v=async()=>{var t,l;try{await h.patch("/tenants/me",{planCode:s.planCode,trialEndsAt:s.trialEndsAt,autoDisableOverdue:s.autoDisableOverdue,graceDays:s.graceDays,billingEmail:s.billingEmail}),await c()}catch(a){d("error"),m(((l=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:l.error)||a.message||"Save failed")}};return e.jsxs("div",{className:"ms-card p-4 space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Organization"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("label",{children:[e.jsx("div",{className:"block text-xs text-slate-500 dark:text-slate-400 mb-1",children:"Plan"}),e.jsxs("select",{value:s.planCode||"basic",onChange:t=>n({...s,planCode:t.target.value}),className:"border rounded px-2 py-2 w-full bg-white dark:bg-slate-900 dark:border-slate-700 dark:text-slate-200",children:[e.jsx("option",{value:"basic",children:"Basic"}),e.jsx("option",{value:"pro",children:"Pro"}),e.jsx("option",{value:"premium",children:"Premium"})]})]}),e.jsxs("label",{children:[e.jsx("div",{className:"block text-xs text-slate-500 dark:text-slate-400 mb-1",children:"Trial ends"}),e.jsx("input",{type:"date",value:s.trialEndsAt||"",onChange:t=>n({...s,trialEndsAt:t.target.value}),className:"border rounded px-2 py-2 w-full bg-white dark:bg-slate-900 dark:border-slate-700 dark:text-slate-200"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:!!s.autoDisableOverdue,onChange:t=>n({...s,autoDisableOverdue:t.target.checked}),className:"h-4 w-4"}),e.jsx("span",{children:"Auto suspend overdue"})]}),e.jsxs("label",{children:[e.jsx("div",{className:"block text-xs text-slate-500 dark:text-slate-400 mb-1",children:"Grace days"}),e.jsx("input",{type:"number",value:s.graceDays??7,onChange:t=>n({...s,graceDays:Number(t.target.value||0)}),className:"border rounded px-2 py-2 w-full bg-white dark:bg-slate-900 dark:border-slate-700 dark:text-slate-200"})]}),e.jsxs("label",{className:"md:col-span-2",children:[e.jsx("div",{className:"block text-xs text-slate-500 dark:text-slate-400 mb-1",children:"Billing email"}),e.jsx("input",{type:"email",value:s.billingEmail||"",onChange:t=>n({...s,billingEmail:t.target.value}),className:"border rounded px-2 py-2 w-full bg-white dark:bg-slate-900 dark:border-slate-700 dark:text-slate-200"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:v,className:"h-9 px-3 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Save"}),e.jsx("button",{onClick:c,className:"h-9 px-3 rounded ms-btn",children:"Refresh"})]}),e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-800 pt-3",children:[e.jsx("h3",{className:"font-semibold mb-2 text-slate-900 dark:text-slate-100",children:"Entitlements"}),e.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-2 text-sm",children:Object.entries(b.modules||{}).length===0?e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"No entitlements available."}):Object.entries(b.modules||{}).map(([t,l])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-44 capitalize text-slate-700 dark:text-slate-200",children:t.replace(/_/g," ")}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${l?"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-300":"bg-slate-100 text-slate-600 dark:bg-slate-800 dark:text-slate-300"}`,children:l?"enabled":"disabled"})]},t))})]})]})}export{y as default};
