import{r as d,j as e,g as b}from"./index-CeHYLxUd.js";const t={wrap:"w-full px-4 md:px-6 lg:px-8 py-6 text-slate-900",h1:"text-3xl font-extrabold tracking-tight",sub:"text-sm text-slate-700",card:"rounded-2xl border-2 border-slate-300 bg-white shadow",th:"bg-slate-100 text-left text-[12px] uppercase tracking-wide text-slate-700 font-semibold px-3 py-2 border-2 border-slate-200 select-none",td:"px-3 py-2 border-2 border-slate-200 text-sm",btn:"inline-flex items-center justify-center rounded-lg border-2 border-slate-300 px-3 py-2 hover:bg-slate-50"},h=(a,l="TZS")=>`‎${l} ${Number(a||0).toLocaleString()}`,j=a=>a?new Date(a).toLocaleDateString():"—";function N(){var m;const[a,l]=d.useState([]),[c,i]=d.useState(!0),[o,p]=d.useState(null),x=async()=>{var s;i(!0);try{const r=await b.get("/loans",{params:{status:"approved"}}),n=Array.isArray(r.data)?r.data:((s=r.data)==null?void 0:s.items)||[];l((n||[]).filter(u=>(u.status||"").toLowerCase()==="approved"))}catch{l([])}finally{i(!1),p(new Date)}};return d.useEffect(()=>{x()},[]),e.jsxs("div",{className:t.wrap,children:[e.jsxs("div",{className:"flex items-end justify-between gap-3 mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:t.h1,children:"Disbursement Queue"}),e.jsx("p",{className:t.sub,children:"Loans awaiting disbursement."}),o&&e.jsxs("p",{className:"text-xs text-slate-600 mt-1",children:["Last updated ",o.toLocaleString()]})]}),e.jsx("button",{onClick:x,className:t.btn,title:"Refresh",children:"Refresh"})]}),e.jsxs("div",{className:`${t.card} overflow-hidden`,children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm border-2 border-slate-300 border-collapse bg-white",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:t.th,children:"Ref"}),e.jsx("th",{className:t.th,children:"Borrower"}),e.jsx("th",{className:t.th,children:"Amount"}),e.jsx("th",{className:t.th,children:"Approved On"})]})}),e.jsx("tbody",{children:c?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:`${t.td} text-center py-10 text-slate-600`,children:"Loading…"})}):a.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:`${t.td} text-center py-10 text-slate-600`,children:"Empty"})}):a.map(s=>{var r,n;return e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:t.td,children:s.reference||`L-${s.id}`}),e.jsx("td",{className:t.td,children:((r=s.Borrower)==null?void 0:r.name)||"—"}),e.jsx("td",{className:t.td,children:h(s.amount,s.currency||"TZS")}),e.jsx("td",{className:t.td,children:j((n=s.approvalDate)==null?void 0:n.slice(0,10))})]},s.id)})})]})}),!c&&a.length>0&&e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-t-2 border-slate-300 text-sm",children:[e.jsxs("span",{className:"text-slate-700",children:[a.length.toLocaleString()," ready for disbursement"]}),e.jsxs("span",{className:"text-slate-700",children:["Total"," ",h(a.reduce((s,r)=>s+Number(r.amount||0),0),((m=a[0])==null?void 0:m.currency)||"TZS")]})]})]})]})}export{N as default};
