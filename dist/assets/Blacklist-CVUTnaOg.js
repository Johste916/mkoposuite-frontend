import{r,j as t,g as i}from"./index-8DtxmKky.js";const s={container:"w-full px-4 md:px-6 lg:px-8 py-6 text-slate-900",h1:"text-3xl font-extrabold tracking-tight",card:"rounded-2xl border-2 border-slate-300 bg-white shadow",input:"h-10 w-full rounded-lg border-2 border-slate-300 px-3 outline-none focus:ring-2 focus:ring-indigo-500/40",primary:"inline-flex items-center rounded-lg bg-rose-600 text-white px-4 py-2 font-semibold hover:bg-rose-700",tableWrap:"rounded-2xl border-2 border-slate-300 bg-white shadow overflow-x-auto",th:"bg-slate-100 text-left text-[13px] uppercase tracking-wide text-slate-700 font-semibold px-3 py-2 border-2 border-slate-200",td:"px-3 py-2 border-2 border-slate-200 text-sm",btn:"inline-flex items-center rounded-lg border-2 border-slate-300 px-3 py-1.5 hover:bg-slate-50"},I=()=>{const[c,m]=r.useState([]),[j,x]=r.useState(!0),[h,u]=r.useState(""),[a,b]=r.useState({borrowerId:"",reason:"",until:""}),n=async e=>{var l,p;try{x(!0);const y=e?{signal:e}:{},o=await i.get("/borrowers/blacklist/list",y),v=Array.isArray(o.data)?o.data:((l=o.data)==null?void 0:l.items)||((p=o.data)==null?void 0:p.data)||[];m(v),u("")}catch{u("Failed to load blacklist"),m([])}finally{x(!1)}};r.useEffect(()=>{const e=new AbortController;return n(e.signal),()=>e.abort()},[]);const d=e=>b(l=>({...l,[e.target.name]:e.target.value})),w=async e=>{if(e.preventDefault(),!!a.borrowerId)try{await i.post(`/borrowers/${encodeURIComponent(a.borrowerId)}/blacklist`,{reason:a.reason||null,until:a.until||null}),b({borrowerId:"",reason:"",until:""}),await n()}catch{alert("Failed to blacklist")}},g=async e=>{try{await i.delete(`/borrowers/${encodeURIComponent(e)}/blacklist`),await n()}catch{}},f=e=>e?new Date(e).toLocaleDateString():"—",N=e=>(e==null?void 0:e.name)||`${(e==null?void 0:e.firstName)||""} ${(e==null?void 0:e.lastName)||""}`.trim()||(e==null?void 0:e.id)||"—";return t.jsxs("div",{className:s.container,children:[t.jsx("h1",{className:s.h1,children:"Blacklist"}),t.jsxs("form",{onSubmit:w,className:`${s.card} mt-4 p-4`,children:[t.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[t.jsx("input",{name:"borrowerId",placeholder:"Borrower ID",className:s.input,value:a.borrowerId,onChange:d,required:!0}),t.jsx("input",{name:"reason",placeholder:"Reason",className:s.input,value:a.reason,onChange:d}),t.jsx("input",{name:"until",type:"date",className:s.input,value:a.until,onChange:d})]}),t.jsx("div",{className:"mt-3",children:t.jsx("button",{className:s.primary,children:"Add to Blacklist"})})]}),t.jsx("div",{className:`${s.tableWrap} mt-4`,children:t.jsxs("table",{className:"w-full table-auto text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{className:s.th,children:"Borrower"}),t.jsx("th",{className:s.th,children:"Reason"}),t.jsx("th",{className:s.th,children:"Until"}),t.jsx("th",{className:s.th,children:"Actions"})]})}),t.jsx("tbody",{children:j?t.jsx("tr",{children:t.jsx("td",{className:s.td,colSpan:4,children:"Loading…"})}):h?t.jsx("tr",{children:t.jsx("td",{className:`${s.td} text-rose-700`,colSpan:4,children:h})}):c.length===0?t.jsx("tr",{children:t.jsx("td",{className:s.td,colSpan:4,children:"No blacklisted borrowers."})}):c.map(e=>t.jsxs("tr",{children:[t.jsx("td",{className:s.td,children:N(e)}),t.jsx("td",{className:s.td,children:e.reason||"—"}),t.jsx("td",{className:s.td,children:f(e.until)}),t.jsx("td",{className:s.td,children:t.jsx("button",{className:s.btn,onClick:()=>g(e.id),children:"Remove"})})]},e.id))})]})})]})};export{I as default};
