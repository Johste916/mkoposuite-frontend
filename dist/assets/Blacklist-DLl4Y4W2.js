import{r as s,j as r,h as d}from"./index-_x_s48EO.js";const t={container:"w-full px-4 md:px-6 lg:px-8 py-6 bg-[var(--bg)] text-[var(--fg)]",h1:"text-3xl font-extrabold tracking-tight",card:"rounded-2xl border-2 border-[var(--border-strong)] bg-[var(--card)] shadow",input:"h-10 w-full rounded-lg border-2 px-3 outline-none focus:ring-2 focus:ring-[var(--ring)] bg-[var(--input-bg)] text-[var(--input-fg)] border-[var(--input-border)]",primary:"inline-flex items-center rounded-lg bg-rose-600 text-white px-4 py-2 font-semibold hover:bg-rose-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[var(--ring)]",tableWrap:"rounded-2xl border-2 border-[var(--border-strong)] bg-[var(--card)] shadow overflow-x-auto",th:"bg-[var(--kpi-bg)] text-left text-[13px] uppercase tracking-wide text-[var(--muted)] font-semibold px-3 py-2 border-2 border-[var(--border)]",td:"px-3 py-2 border-2 border-[var(--border)] text-sm",btn:"inline-flex items-center rounded-lg border-2 border-[var(--border-strong)] px-3 py-1.5 hover:bg-[var(--kpi-bg)] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[var(--ring)]",alert:"rounded-2xl px-4 py-3"},I=()=>{const[c,b]=s.useState([]),[p,u]=s.useState(!0),[x,m]=s.useState(""),[a,h]=s.useState({borrowerId:"",reason:"",until:""}),l=async e=>{var o,g;try{u(!0);const N=e?{signal:e}:{},n=await d.get("/borrowers/blacklist/list",N),y=Array.isArray(n.data)?n.data:((o=n.data)==null?void 0:o.items)||((g=n.data)==null?void 0:g.data)||[];b(y),m("")}catch{m("Failed to load blacklist"),b([])}finally{u(!1)}};s.useEffect(()=>{const e=new AbortController;return l(e.signal),()=>e.abort()},[]);const i=e=>h(o=>({...o,[e.target.name]:e.target.value})),v=async e=>{if(e.preventDefault(),!!a.borrowerId)try{await d.post(`/borrowers/${encodeURIComponent(a.borrowerId)}/blacklist`,{reason:a.reason||null,until:a.until||null}),h({borrowerId:"",reason:"",until:""}),await l()}catch{alert("Failed to blacklist")}},f=async e=>{try{await d.delete(`/borrowers/${encodeURIComponent(e)}/blacklist`),await l()}catch{}},j=e=>e?new Date(e).toLocaleDateString():"—",w=e=>(e==null?void 0:e.name)||`${(e==null?void 0:e.firstName)||""} ${(e==null?void 0:e.lastName)||""}`.trim()||(e==null?void 0:e.id)||"—";return r.jsxs("div",{className:t.container,children:[r.jsx("h1",{className:t.h1,children:"Blacklist"}),r.jsxs("form",{onSubmit:v,className:`${t.card} mt-4 p-4`,children:[r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[r.jsx("input",{name:"borrowerId",placeholder:"Borrower ID",className:t.input,value:a.borrowerId,onChange:i,required:!0}),r.jsx("input",{name:"reason",placeholder:"Reason",className:t.input,value:a.reason,onChange:i}),r.jsx("input",{name:"until",type:"date",className:t.input,value:a.until,onChange:i})]}),r.jsx("div",{className:"mt-3",children:r.jsx("button",{className:t.primary,children:"Add to Blacklist"})})]}),r.jsx("div",{className:`${t.tableWrap} mt-4`,children:r.jsxs("table",{className:"w-full table-auto text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{className:t.th,children:"Borrower"}),r.jsx("th",{className:t.th,children:"Reason"}),r.jsx("th",{className:t.th,children:"Until"}),r.jsx("th",{className:t.th,children:"Actions"})]})}),r.jsx("tbody",{children:p?r.jsx("tr",{children:r.jsx("td",{className:t.td,colSpan:4,children:"Loading…"})}):x?r.jsx("tr",{children:r.jsx("td",{className:t.td,colSpan:4,children:r.jsx("div",{className:t.alert,style:{border:"2px solid var(--danger-border)",background:"var(--danger-bg)",color:"var(--danger-fg)",borderRadius:"1rem"},children:x})})}):c.length===0?r.jsx("tr",{children:r.jsx("td",{className:t.td,colSpan:4,children:"No blacklisted borrowers."})}):c.map(e=>r.jsxs("tr",{children:[r.jsx("td",{className:t.td,children:w(e)}),r.jsx("td",{className:t.td,children:e.reason||"—"}),r.jsx("td",{className:t.td,children:j(e.until)}),r.jsx("td",{className:t.td,children:r.jsx("button",{className:t.btn,onClick:()=>f(e.id),children:"Remove"})})]},e.id))})]})})]})};export{I as default};
