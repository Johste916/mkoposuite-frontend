import{r as i,j as a,g as b}from"./index-sMnl2-1N.js";function c(t){const o=(t.startsWith("/")?t:`/${t}`).replace(/^\/api\//,"/"),l=o.startsWith("/api/")?o:`/api${o}`;return Array.from(new Set([o,l]))}async function g(t=[],r={}){let o;for(const l of t)try{const s=await b.get(l,r);return s==null?void 0:s.data}catch(s){o=s}throw o||new Error("No endpoint succeeded")}function v(t){const r=(t==null?void 0:t.summary)||t||{},o=s=>Number(s||0),l=s=>typeof s=="string"&&s.trim().endsWith("%")?s:`${Number(s||0).toFixed(2).replace(/\.00$/,"")}%`;return{totalGroups:o(r.totalGroups??r.groups??r.count),activeGroups:o(r.activeGroups??r.active??r.enabled),totalLoans:o(r.totalLoans??r.groupLoans??r.loans),par:l(r.par??r.portfolioAtRisk??r.par30??0)}}const e={container:"w-full px-4 md:px-6 lg:px-8 py-6 min-h-screen bg-[var(--bg)] text-[var(--fg)]",card:"rounded-2xl border-2 border-[var(--border-strong)] bg-[var(--card)] shadow-lg",statCard:"rounded-2xl border-2 border-[var(--border-strong)] bg-[var(--card)] shadow p-4",label:"text-[12px] font-semibold uppercase tracking-wider text-[var(--muted)]",value:"mt-1 text-2xl font-extrabold",btn:"px-3 py-2 rounded-lg border-2 border-[var(--border-strong)] bg-[var(--card)] hover:bg-[var(--kpi-bg)] font-semibold focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[var(--ring)]",muted:"text-[var(--muted)]",danger:"text-[var(--danger-fg)]"},f=()=>{const[t,r]=i.useState({totalGroups:0,activeGroups:0,totalLoans:0,par:"0%"}),[o,l]=i.useState(!0),[s,d]=i.useState(""),p=async()=>{var u,m,x;try{l(!0),d("");const n=await g([...c("borrowers/groups/reports/summary"),...c("groups/reports/summary"),...c("borrower-groups/reports/summary")]);r(v(n))}catch(n){d(((u=n==null?void 0:n.response)==null?void 0:u.status)===404?"Group report endpoint not implemented.":((x=(m=n==null?void 0:n.response)==null?void 0:m.data)==null?void 0:x.error)||(n==null?void 0:n.message)||"Failed to load group report data."),r({totalGroups:0,activeGroups:0,totalLoans:0,par:"0%"})}finally{l(!1)}};return i.useEffect(()=>{p()},[]),a.jsxs("div",{className:e.container,children:[a.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[a.jsx("h1",{className:"text-3xl font-extrabold tracking-tight",children:"Group Reports"}),a.jsx("button",{onClick:p,className:e.btn,children:"Refresh"})]}),o?a.jsx("p",{className:e.muted,children:"Loading group analytics..."}):s?a.jsx("p",{className:e.danger,children:s}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:e.statCard,children:[a.jsx("div",{className:e.label,children:"Total Groups"}),a.jsx("div",{className:e.value,children:t.totalGroups||0})]}),a.jsxs("div",{className:e.statCard,children:[a.jsx("div",{className:e.label,children:"Active Groups"}),a.jsx("div",{className:e.value,children:t.activeGroups||0})]}),a.jsxs("div",{className:e.statCard,children:[a.jsx("div",{className:e.label,children:"Total Group Loans"}),a.jsx("div",{className:e.value,children:Number(t.totalLoans||0).toLocaleString()})]}),a.jsxs("div",{className:e.statCard,children:[a.jsx("div",{className:e.label,children:"PAR"}),a.jsx("div",{className:"mt-1 text-2xl font-extrabold",children:t.par||"0%"})]})]}),a.jsx("div",{className:`${e.card} p-4 mt-4`,children:a.jsx("p",{className:`text-sm ${e.muted}`,children:"Charts and trends (by branch, officer, performance tiers) will appear here once backend analytics endpoints are available."})})]})]})};export{f as default};
