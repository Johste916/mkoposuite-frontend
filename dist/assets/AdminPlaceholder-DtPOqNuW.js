import{r as n,b as c,j as e}from"./index-Beh6sWFf.js";function y({keyProp:r,title:m}){const[d,o]=n.useState({}),[p,g]=n.useState(!0),[h,u]=n.useState(!1),[x,l]=n.useState(""),b=n.useMemo(()=>JSON.stringify(d,null,2),[d]);n.useEffect(()=>{let s=!1;return(async()=>{var i,t;g(!0),l("");try{let a;try{a=await c.get(`/api/settings/${r}`)}catch{a=await c.get("/api/settings",{params:{key:r}})}s||o(a.data||{})}catch(a){s||l(((t=(i=a==null?void 0:a.response)==null?void 0:i.data)==null?void 0:t.error)||a.message)}finally{s||g(!1)}})(),()=>{s=!0}},[r]);const f=async()=>{var s,i;u(!0),l("");try{const t=typeof d=="object"?d:{};try{await c.put(`/api/settings/${r}`,t)}catch{await c.put("/api/settings",{key:r,value:t})}try{window.dispatchEvent(new CustomEvent("app:toast",{detail:{type:"success",message:"Saved"}}))}catch{}}catch(t){l(((i=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:i.error)||t.message)}finally{u(!1)}};return e.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-6 shadow-sm space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl font-semibold",children:m}),e.jsx("div",{className:"text-xs text-slate-500",children:e.jsxs("code",{children:["/api/settings/",r]})})]}),x&&e.jsx("div",{className:"text-sm text-rose-600",children:x}),p?e.jsx("div",{className:"text-sm text-slate-500",children:"Loading…"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:["This generic editor persists JSON stored under the key ",e.jsx("code",{children:r}),". Replace it later with a tailored UI."]}),e.jsx("textarea",{className:"w-full h-72 font-mono text-xs border rounded-lg p-3 bg-white dark:bg-slate-900 dark:border-slate-700",value:b,onChange:s=>{try{const i=JSON.parse(s.target.value);o(i),l("")}catch{l("JSON is invalid — fix formatting before saving.")}}}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:f,disabled:h||!!x,className:"px-3 py-2 rounded-lg border bg-blue-600 text-white disabled:opacity-60",children:h?"Saving…":"Save"}),e.jsx("button",{onClick:()=>o({}),className:"px-3 py-2 rounded-lg border bg-white hover:bg-slate-50",children:"Reset to "})]})]})]})}export{y as default};
