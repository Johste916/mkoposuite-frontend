import{r as i,j as e,L as c,g as x}from"./index-CeHYLxUd.js";async function b(t=[],n={}){let s;for(const a of t)try{const r=await x.get(a,n);return r==null?void 0:r.data}catch(r){s=r}throw s||new Error("No endpoint succeeded")}function p(t){return(Array.isArray(t)?t:(t==null?void 0:t.items)||(t==null?void 0:t.rows)||(t==null?void 0:t.data)||[]).map(s=>{var r,l,d,o;return{id:s.id??s._id??s.groupId??s.code??s.slug??s.uuid??String(Math.random()),name:s.name??s.groupName??s.title??"—",membersCount:s.membersCount??s.memberCount??((r=s.members)==null?void 0:r.length)??s.size??0,branchName:s.branchName??((l=s.branch)==null?void 0:l.name)??"—",totalLoans:s.totalLoans??s.loanCount??((d=s.stats)==null?void 0:d.loans)??0,outstanding:s.totalLoanAmount??s.outstanding??((o=s.stats)==null?void 0:o.outstanding)??0}})}const u="w-full px-4 md:px-6 lg:px-8 py-6 min-h-screen bg-white text-slate-900",h="rounded-2xl border-2 border-slate-400 bg-white shadow-lg",f="inline-flex items-center gap-1 text-indigo-700 font-bold underline decoration-2 underline-offset-4 hover:text-indigo-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-400 rounded",j=()=>{const[t,n]=i.useState([]),[s,a]=i.useState(!0),[r,l]=i.useState("");i.useEffect(()=>{const o=new AbortController;return(async()=>{try{a(!0);const m=await b(["/borrowers/groups?include=members","/groups?include=members","/borrower-groups?include=members","/api/borrowers/groups?include=members"],{signal:o.signal});n(p(m)),l("")}catch{l("Failed to load groups (endpoint not implemented)."),n([])}finally{a(!1)}})(),()=>o.abort()},[]);const d=o=>`TZS ${Number(o||0).toLocaleString()}`;return e.jsxs("div",{className:u,children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-extrabold tracking-tight",children:"Borrower Groups"}),e.jsx(c,{to:"/borrowers/groups/add",className:"px-4 py-2 rounded-lg bg-indigo-600 text-white hover:bg-indigo-700 font-semibold",children:"Add Group"})]}),e.jsx("div",{className:`${h} overflow-hidden`,children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-[15px] border-collapse",children:[e.jsx("thead",{className:"bg-slate-100 sticky top-0",children:e.jsxs("tr",{className:"text-left",children:[e.jsx("th",{className:"px-3 py-3 font-semibold border-b-2 border-slate-200",children:"Name"}),e.jsx("th",{className:"px-3 py-3 font-semibold border-b-2 border-slate-200",children:"Members"}),e.jsx("th",{className:"px-3 py-3 font-semibold border-b-2 border-slate-200",children:"Branch"}),e.jsx("th",{className:"px-3 py-3 font-semibold border-b-2 border-slate-200",children:"Loans"}),e.jsx("th",{className:"px-3 py-3 font-semibold border-b-2 border-slate-200",children:"Outstanding"}),e.jsx("th",{className:"px-3 py-3 font-semibold border-b-2 border-slate-200 text-right pr-4",children:"Actions"})]})}),e.jsx("tbody",{children:s?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"p-4 text-slate-700",children:"Loading…"})}):r?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"p-4 text-rose-700",children:r})}):t.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"p-4 text-slate-700",children:"No groups yet."})}):t.map(o=>e.jsxs("tr",{className:"odd:bg-white even:bg-slate-50 border-t border-slate-200",children:[e.jsx("td",{className:"px-3 py-2",children:e.jsx(c,{to:`/borrowers/groups/${encodeURIComponent(o.id)}`,className:f,children:o.name})}),e.jsx("td",{className:"px-3 py-2",children:o.membersCount}),e.jsx("td",{className:"px-3 py-2",children:o.branchName}),e.jsx("td",{className:"px-3 py-2",children:o.totalLoans}),e.jsx("td",{className:"px-3 py-2",children:d(o.outstanding)}),e.jsx("td",{className:"px-3 py-2 text-right",children:e.jsx(c,{to:`/borrowers/groups/${encodeURIComponent(o.id)}`,className:"text-indigo-700 hover:text-indigo-900 underline decoration-2 underline-offset-4 font-semibold",children:"View"})})]},o.id))})]})})})]})};export{j as default};
