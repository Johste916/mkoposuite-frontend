import{r as m,j as e,g as h}from"./index-DQxdAjNY.js";function u(t){const s=(t.startsWith("/")?t:`/${t}`).replace(/^\/api\//,"/"),r=s.startsWith("/api/")?s:`/api${s}`;return Array.from(new Set([s,r]))}async function y(t=[],l,s={}){let r;for(const p of t)try{const a=await h.post(p,l,s);return a==null?void 0:a.data}catch(a){r=a}throw r||new Error("No endpoint succeeded")}const v=()=>{const[t,l]=m.useState(null),[s,r]=m.useState(!1),[p,a]=m.useState(""),b=async i=>{var d,o;if(i.preventDefault(),a(""),!t)return;const n=new FormData;n.append("file",t);try{r(!0),await y([...u("borrowers/groups/import"),...u("groups/import"),...u("borrower-groups/import")],n,{headers:{"Content-Type":"multipart/form-data"}}),a("✅ Import uploaded. Processing…"),l(null)}catch(c){const f=((o=(d=c==null?void 0:c.response)==null?void 0:d.data)==null?void 0:o.error)||(c==null?void 0:c.message)||"Import failed.";a(`❌ ${f}`)}finally{r(!1)}},x=()=>{const i=`name,branchId,officerId,meetingDay,notes,members
Group A,1,,monday,Example notes,"254700000001;254700000002"
Group B,1,,friday,,
`,n=new Blob([i],{type:"text/csv;charset=utf-8"}),d=URL.createObjectURL(n),o=document.createElement("a");o.href=d,o.download="group_import_sample.csv",document.body.appendChild(o),o.click(),URL.revokeObjectURL(d),o.remove()};return e.jsxs("div",{className:"max-w-2xl p-4 space-y-4 bg-[var(--bg)] text-[var(--fg)]",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Group Imports"}),e.jsx("div",{className:"card p-4 space-y-4",children:e.jsxs("form",{onSubmit:b,className:"space-y-3",children:[e.jsx("input",{type:"file",accept:".csv,.xlsx",onChange:i=>{var n;return l(((n=i.target.files)==null?void 0:n[0])||null)},className:"block w-full"}),e.jsxs("div",{className:"text-xs muted",children:["Accepted: CSV/XLSX. Columns: ",e.jsx("b",{children:"name, branchId, officerId, meetingDay, notes, members"})," ","(meetingDay must be lowercase: monday…sunday; members can be a semicolon-separated list)."]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",disabled:!t||s,className:"px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-60",children:s?"Uploading…":"Upload"}),e.jsx("button",{type:"button",onClick:x,className:"px-3 py-2 border rounded border-[var(--border)] hover:bg-gray-50 dark:hover:bg-slate-800",children:"Download Sample"})]}),p&&e.jsx("div",{className:"text-sm",children:p})]})})]})};export{v as default};
