import{r,j as e,g as u}from"./index-w0S6QMJE.js";const l=t=>Number(t||0).toLocaleString();function y(){const[t,p]=r.useState(""),[d,h]=r.useState([]),[b,i]=r.useState(!0),[o,x]=r.useState(""),m=async()=>{var s,a;i(!0),x("");try{const{data:c}=await u.get("/accounting/trial-balance",{params:t?{asOf:t}:{}});h(Array.isArray(c)?c:[])}catch(c){x(((a=(s=c==null?void 0:c.response)==null?void 0:s.data)==null?void 0:a.error)||c.message)}finally{i(!1)}};r.useEffect(()=>{m()},[]);const j=()=>{const s="https://mkoposuite-backend-42w2.onrender.com/api",a=t?`?asOf=${encodeURIComponent(t)}`:"";window.open(`${s}/accounting/trial-balance/export/csv${a}`,"_blank")},n=r.useMemo(()=>d.reduce((s,a)=>(s.debit+=Number(a.debit||0),s.credit+=Number(a.credit||0),s),{debit:0,credit:0}),[d]);return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow p-4",children:[e.jsxs("div",{className:"flex items-end justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Trial Balance"}),e.jsx("div",{className:"text-xs text-slate-500",children:t?`As of ${t}`:"All time"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("label",{className:"block text-xs opacity-70",children:"As of"}),e.jsx("input",{type:"date",value:t,onChange:s=>p(s.target.value),className:"border rounded px-2 py-1 dark:bg-gray-700"})]}),e.jsx("button",{onClick:m,className:"px-3 py-2 rounded bg-blue-600 text-white text-sm",children:"Run"}),e.jsx("button",{onClick:j,className:"px-3 py-2 rounded border text-sm",children:"Export CSV"})]})]}),o&&e.jsxs("div",{className:"text-red-500 text-sm mb-3",children:["Error: ",o]}),b?e.jsx("div",{className:"py-10 text-center opacity-70",children:"Loading…"}):e.jsx("div",{className:"overflow-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left border-b dark:border-gray-700",children:[e.jsx("th",{className:"px-3 py-2",children:"Account"}),e.jsx("th",{className:"px-3 py-2",children:"Debit"}),e.jsx("th",{className:"px-3 py-2",children:"Credit"}),e.jsx("th",{className:"px-3 py-2",children:"Balance"})]})}),e.jsxs("tbody",{children:[d.map(s=>e.jsxs("tr",{className:"border-b dark:border-gray-700",children:[e.jsxs("td",{className:"px-3 py-2",children:[s.accountCode||"—"," — ",s.accountName||"—"]}),e.jsx("td",{className:"px-3 py-2",children:l(s.debit)}),e.jsx("td",{className:"px-3 py-2",children:l(s.credit)}),e.jsx("td",{className:"px-3 py-2",children:l(s.balance)})]},s.accountId)),d.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-3 py-8 text-center opacity-70",children:"No data"})})]}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"font-semibold",children:[e.jsx("td",{className:"px-3 py-2 text-right",children:"Totals"}),e.jsx("td",{className:"px-3 py-2",children:l(n.debit)}),e.jsx("td",{className:"px-3 py-2",children:l(n.credit)}),e.jsx("td",{className:"px-3 py-2",children:l(n.debit-n.credit)})]})})]})})]})}export{y as default};
