import{r as n,j as e,b as j}from"./index-XjG2GIub.js";function C(){const[N,d]=n.useState(null),[k,v]=n.useState(null),[m,y]=n.useState(null),[p,f]=n.useState([]),[u,i]=n.useState("loading"),[w,h]=n.useState("");async function c(t,l){var x;for(const b of t)try{const r=await j.get(b,l);if((r==null?void 0:r.data)!==void 0)return r.data}catch(r){if(((x=r==null?void 0:r.response)==null?void 0:x.status)!==404)throw r}const a=new Error("Not Found");throw a.code=404,a}const o=async()=>{var t,l;i("loading"),h("");try{const a=await c(["/tenants/me","/tenant/me","/account/tenant","/account/organization"],{});d(a);const x=await c(["/tenants/me/entitlements","/tenant/me/entitlements","/account/tenant/entitlements","/account/organization/entitlements"],{}).catch(()=>({}));v(x||{});const b=await c(["/tenants/me/limits","/tenant/me/limits","/account/tenant/limits","/account/organization/limits"],{}).catch(()=>({}));y(b||{});const r=await c(["/tenants/me/invoices","/tenant/me/invoices","/account/tenant/invoices","/account/organization/invoices"],{}).catch(()=>[]);f(Array.isArray(r)?r:[]),i("ready")}catch(a){(a==null?void 0:a.code)===404?i("unavailable"):(i("error"),h(((l=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:l.error)||a.message||"Unknown error"))}};if(n.useEffect(()=>{o()},[]),u==="loading")return e.jsx("div",{className:"p-4 text-sm text-slate-500 dark:text-slate-400",children:"Loading…"});if(u==="unavailable")return e.jsxs("div",{className:"ms-card p-4 space-y-3",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Organization"}),e.jsx("div",{className:"rounded border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/40 p-3",children:e.jsxs("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:["Organization settings aren’t available on this server (the ",e.jsx("code",{children:"/tenants/me"})," API is not implemented). If you don’t need this module you can ignore this page."]})})]});if(u==="error")return e.jsxs("div",{className:"p-4 text-sm text-rose-600 dark:text-rose-400",children:["Error: ",w,e.jsx("div",{className:"mt-3",children:e.jsx("button",{onClick:o,className:"h-9 px-3 rounded ms-btn",children:"Retry"})})]});const s=N||{},g=k||{},E=async()=>{var t,l;try{await j.patch("/tenants/me",{planCode:s.planCode,trialEndsAt:s.trialEndsAt,autoDisableOverdue:s.autoDisableOverdue,graceDays:s.graceDays,billingEmail:s.billingEmail}),await o()}catch(a){i("error"),h(((l=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:l.error)||a.message||"Save failed")}};return e.jsxs("div",{className:"ms-card p-4 space-y-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Organization"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("label",{children:[e.jsx("div",{className:"block text-xs text-slate-500 dark:text-slate-400 mb-1",children:"Plan"}),e.jsxs("select",{value:s.planCode||"basic",onChange:t=>d({...s,planCode:t.target.value}),className:"border rounded px-2 py-2 w-full bg-white dark:bg-slate-900 dark:border-slate-700 dark:text-slate-200",children:[e.jsx("option",{value:"basic",children:"Basic"}),e.jsx("option",{value:"pro",children:"Pro"}),e.jsx("option",{value:"premium",children:"Premium"})]})]}),e.jsxs("label",{children:[e.jsx("div",{className:"block text-xs text-slate-500 dark:text-slate-400 mb-1",children:"Trial ends"}),e.jsx("input",{type:"date",value:s.trialEndsAt||"",onChange:t=>d({...s,trialEndsAt:t.target.value}),className:"border rounded px-2 py-2 w-full bg-white dark:bg-slate-900 dark:border-slate-700 dark:text-slate-200"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:!!s.autoDisableOverdue,onChange:t=>d({...s,autoDisableOverdue:t.target.checked}),className:"h-4 w-4"}),e.jsx("span",{children:"Auto suspend overdue"})]}),e.jsxs("label",{children:[e.jsx("div",{className:"block text-xs text-slate-500 dark:text-slate-400 mb-1",children:"Grace days"}),e.jsx("input",{type:"number",value:s.graceDays??7,onChange:t=>d({...s,graceDays:Number(t.target.value||0)}),className:"border rounded px-2 py-2 w-full bg-white dark:bg-slate-900 dark:border-slate-700 dark:text-slate-200",min:0,max:90})]}),e.jsxs("label",{className:"md:col-span-2",children:[e.jsx("div",{className:"block text-xs text-slate-500 dark:text-slate-400 mb-1",children:"Billing email"}),e.jsx("input",{type:"email",value:s.billingEmail||"",onChange:t=>d({...s,billingEmail:t.target.value}),className:"border rounded px-2 py-2 w-full bg-white dark:bg-slate-900 dark:border-slate-700 dark:text-slate-200"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:E,className:"h-9 px-3 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Save"}),e.jsx("button",{onClick:o,className:"h-9 px-3 rounded ms-btn",children:"Refresh"})]}),e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-800 pt-3",children:[e.jsx("h3",{className:"font-semibold mb-2 text-slate-900 dark:text-slate-100",children:"Entitlements"}),e.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-2 text-sm",children:Object.entries(g.modules||{}).length===0?e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"No entitlements available."}):Object.entries(g.modules||{}).map(([t,l])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-44 capitalize text-slate-700 dark:text-slate-200",children:t.replace(/_/g," ")}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${l?"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-300":"bg-slate-100 text-slate-600 dark:bg-slate-800 dark:text-slate-300"}`,children:l?"enabled":"disabled"})]},t))})]}),e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-800 pt-3",children:[e.jsx("h3",{className:"font-semibold mb-2 text-slate-900 dark:text-slate-100",children:"Limits"}),!m||Object.keys(m).length===0?e.jsx("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:"No limits configured."}):e.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-2 text-sm",children:Object.entries(m).map(([t,l])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-44 capitalize text-slate-700 dark:text-slate-200",children:t.replace(/_/g," ")}),e.jsx("span",{className:"text-xs px-2 py-0.5 rounded bg-slate-100 dark:bg-slate-800 dark:text-slate-200",children:String(l)})]},t))})]}),e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-800 pt-3",children:[e.jsx("h3",{className:"font-semibold mb-2 text-slate-900 dark:text-slate-100",children:"Invoices"}),p.length===0?e.jsx("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:"No invoices yet."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"text-left text-slate-500 dark:text-slate-400",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 pr-4",children:"Number"}),e.jsx("th",{className:"py-2 pr-4",children:"Amount"}),e.jsx("th",{className:"py-2 pr-4",children:"Due date"}),e.jsx("th",{className:"py-2 pr-4",children:"Status"})]})}),e.jsx("tbody",{className:"align-top",children:p.map(t=>e.jsxs("tr",{className:"border-top border-slate-100 dark:border-slate-800",children:[e.jsx("td",{className:"py-2 pr-4",children:t.number||t.id}),e.jsx("td",{className:"py-2 pr-4",children:(t.amount_cents!=null?t.amount_cents/100:0).toLocaleString(void 0,{style:"currency",currency:t.currency||"USD"})}),e.jsx("td",{className:"py-2 pr-4",children:t.due_date?String(t.due_date).slice(0,10):"-"}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${t.status==="paid"?"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-300":t.status==="past_due"?"bg-rose-100 text-rose-700 dark:bg-rose-900/30 dark:text-rose-300":"bg-slate-100 text-slate-700 dark:bg-slate-800 dark:text-slate-300"}`,children:t.status||"open"})})]},t.id))})]})})]})]})}export{C as default};
