import{j as e,g as E}from"./index-w0S6QMJE.js";import{u as R}from"./useSettingsResource-YCxcK00T.js";import{S as I}from"./settings-DqnnriMg.js";import"./index-C4aeCyx-.js";const D=(s,t,r)=>`data:image/svg+xml;utf8,${encodeURIComponent(`<svg xmlns='http://www.w3.org/2000/svg' width='${s}' height='${t}'>
      <rect width='100%' height='100%' fill='#e5e7eb'/>
      <text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle'
            fill='#6b7280' font-size='12' font-family='sans-serif'>${r}</text>
    </svg>`)}`,k=D(80,80,"Logo"),T=D(80,80,"Img"),v=s=>{const r=(s.startsWith("/")?s:`/${s}`).replace(/^\/api\//,"/"),o=r.startsWith("/api/")?r:`/api${r}`;return Array.from(new Set([r,o]))};function $(){var p,N,C,S,w;const{data:s,setData:t,loading:r,saving:o,error:c,success:d,save:m}=R(I.getGeneral,I.saveGeneral,{company:{name:"MkopoSuite",email:"info@example.com",phone:"+255700000000",website:"https://example.com",address1:"",address2:"",city:"",country:"Tanzania",logoUrl:"",profileImageUrl:""},branding:{primaryColor:"#1d4ed8",secondaryColor:"#0ea5e9"},locale:{currency:"TZS",timezone:"Africa/Dar_es_Salaam",language:"en",currencyInWords:"Shillings",dateFormat:"dd/mm/yyyy"},numberFormats:{thousandSeparator:",",decimalSeparator:".",currencyPosition:"prefix"},dashboard:{landingWidgets:["kpis","recent-activity","collections"],showTicker:!0,importantNotice:"",companyMessage:"",curatedMessage:{title:"",text:"",attachments:[]}}}),u=async(a,l)=>{var M;if(!a)return;const g=new FormData;g.append("file",a);const h=[...v("uploads/image"),...v("admin/uploads/image"),...v("files/upload")],n=await E.postFirst(h,g,{headers:{"Content-Type":"multipart/form-data"}}),L=(n==null?void 0:n.url)||((M=n==null?void 0:n.data)==null?void 0:M.url)||"";t(W=>{var F;const P=structuredClone(W),f=l.split(".");let b=P;for(let j=0;j<f.length-1;j++)b=b[F=f[j]]||(b[F]={});return b[f.at(-1)]=L,P})};return r?e.jsx("div",{className:"p-4 text-sm text-slate-500",children:"Loading…"}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("header",{className:"bg-white dark:bg-slate-900 border rounded-2xl p-4",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"General Settings"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Branding, company info, locale and dashboard messages."})]}),c&&e.jsx("div",{className:"bg-rose-50 text-rose-700 border border-rose-200 rounded-lg p-3 text-sm",children:c}),d&&e.jsx("div",{className:"bg-emerald-50 text-emerald-700 border border-emerald-200 rounded-lg p-3 text-sm",children:d}),e.jsxs("section",{className:"bg-white dark:bg-slate-900 border rounded-2xl p-4 space-y-4",children:[e.jsx("h2",{className:"font-semibold",children:"Company"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-start",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Logo"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:((p=s.company)==null?void 0:p.logoUrl)||k,onError:a=>{a.currentTarget.src=k},alt:"Logo",className:"w-16 h-16 rounded bg-slate-100 object-cover"}),e.jsx("input",{type:"file",accept:"image/*",onChange:a=>{var l;return u((l=a.target.files)==null?void 0:l[0],"company.logoUrl")},className:"text-sm"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Profile Image (optional)"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:((N=s.company)==null?void 0:N.profileImageUrl)||T,onError:a=>{a.currentTarget.src=T},alt:"Profile",className:"w-16 h-16 rounded bg-slate-100 object-cover"}),e.jsx("input",{type:"file",accept:"image/*",onChange:a=>{var l;return u((l=a.target.files)==null?void 0:l[0],"company.profileImageUrl")},className:"text-sm"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[["Company Name","company.name","text","MkopoSuite"],["Email","company.email","email","info@example.com"],["Phone","company.phone","tel","+255700000000"],["Website","company.website","url","https://example.com"],["Address line 1","company.address1","text",""],["Address line 2","company.address2","text",""],["City","company.city","text",""],["Country","company.country","text","Tanzania"]].map(([a,l,g,h])=>e.jsx(y,{label:a,type:g,placeholder:h,value:x(s,l)||"",onChange:n=>i(t,l,n)},l))})]}),e.jsxs("section",{className:"bg-white dark:bg-slate-900 border rounded-2xl p-4 space-y-4",children:[e.jsx("h2",{className:"font-semibold",children:"Branding"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(A,{label:"Primary Color",value:((C=s.branding)==null?void 0:C.primaryColor)||"#1d4ed8",onChange:a=>i(t,"branding.primaryColor",a)}),e.jsx(A,{label:"Secondary Color",value:((S=s.branding)==null?void 0:S.secondaryColor)||"#0ea5e9",onChange:a=>i(t,"branding.secondaryColor",a)})]})]}),e.jsxs("section",{className:"bg-white dark:bg-slate-900 border rounded-2xl p-4 space-y-4",children:[e.jsx("h2",{className:"font-semibold",children:"Locale & Formats"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[[["Currency","locale.currency","text","TZS"],["Currency in Words","locale.currencyInWords","text","Shillings"],["Timezone","locale.timezone","text","Africa/Dar_es_Salaam"],["Language","locale.language","text","en"],["Date Format","locale.dateFormat","text","dd/mm/yyyy"],["Thousand Separator","numberFormats.thousandSeparator","text",","],["Decimal Separator","numberFormats.decimalSeparator","text","."]].map(([a,l,g,h])=>e.jsx(y,{label:a,type:g,placeholder:h,value:x(s,l)??"",onChange:n=>i(t,l,n)},l)),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm",children:"Currency Position"}),e.jsxs("select",{className:"mt-1 w-full rounded border px-3 py-2 text-sm",value:((w=s.numberFormats)==null?void 0:w.currencyPosition)||"prefix",onChange:a=>i(t,"numberFormats.currencyPosition",a.target.value),children:[e.jsx("option",{value:"prefix",children:"Prefix (TZS 1,000)"}),e.jsx("option",{value:"suffix",children:"Suffix (1,000 TZS)"})]})]})]})]}),e.jsxs("section",{className:"bg-white dark:bg-slate-900 border rounded-2xl p-4 space-y-4",children:[e.jsx("h2",{className:"font-semibold",children:"Dashboard Messages"}),e.jsx(y,{label:"Important Notice (top amber line)",value:x(s,"dashboard.importantNotice")||"",onChange:a=>i(t,"dashboard.importantNotice",a),placeholder:"REMINDER: Submit weekly PAR review by Friday 4:00 PM."}),e.jsx(y,{label:"Company Message (blue line)",value:x(s,"dashboard.companyMessage")||"",onChange:a=>i(t,"dashboard.companyMessage",a),placeholder:"Welcome to MkopoSuite LMS — Q3 focus: Risk reduction & collections discipline."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(y,{label:"Curated Card Title (optional)",value:x(s,"dashboard.curatedMessage.title")||"",onChange:a=>i(t,"dashboard.curatedMessage.title",a),placeholder:"Quarterly Collections Drive"}),e.jsx("textarea",{className:"rounded border px-3 py-2 text-sm min-h-[96px]",placeholder:"Short text shown in a white card below the blue line.",value:x(s,"dashboard.curatedMessage.text")||"",onChange:a=>i(t,"dashboard.curatedMessage.text",a.target.value)})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{className:"px-3 py-1.5 rounded bg-blue-600 text-white text-sm",disabled:o,onClick:()=>m(),children:o?"Saving…":"Save Changes"})})]})}function x(s,t){return t.split(".").reduce((r,o)=>r?r[o]:void 0,s)}function i(s,t,r){s(o=>{var u;const c=structuredClone(o),d=t.split(".");let m=c;for(let p=0;p<d.length-1;p++)m=m[u=d[p]]||(m[u]={});return m[d.at(-1)]=r,c})}function y({label:s,type:t="text",value:r,onChange:o,placeholder:c}){return e.jsxs("div",{children:[e.jsx("label",{className:"text-sm",children:s}),e.jsx("input",{type:t,className:"mt-1 w-full rounded border px-3 py-2 text-sm",value:r,onChange:d=>o(d.target.value),placeholder:c})]})}function A({label:s,value:t,onChange:r}){return e.jsxs("div",{children:[e.jsx("label",{className:"text-sm",children:s}),e.jsxs("div",{className:"mt-1 flex items-center gap-3",children:[e.jsx("input",{type:"color",className:"w-10 h-10 rounded border",value:t,onChange:o=>r(o.target.value)}),e.jsx("input",{type:"text",className:"flex-1 rounded border px-3 py-2 text-sm",value:t,onChange:o=>r(o.target.value),placeholder:"#1d4ed8"})]})]})}export{$ as default};
