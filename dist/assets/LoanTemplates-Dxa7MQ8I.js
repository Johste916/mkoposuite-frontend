import{j as e,g as b}from"./index-C7g4An2R.js";import{u as y}from"./useSettingsResource-Dmy4806J.js";import{S as g}from"./settings-rDPwdYzj.js";import"./index-CHkgZxC-.js";const U=()=>typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now().toString(36)}-${Math.random().toString(36).slice(2,10)}`;function S(){const{data:o,setData:d,loading:u,saving:c,error:p,success:m,save:h}=y(g.getLoanTemplates,g.saveLoanTemplates,{templates:[]}),f=()=>d(a=>({...a,templates:[...a.templates||[],{id:U(),name:"",type:"application",fileUrl:"",active:!0}]})),n=(a,t)=>d(s=>({...s,templates:(s.templates||[]).map(r=>r.id===a?{...r,...t}:r)})),j=a=>d(t=>({...t,templates:(t.templates||[]).filter(s=>s.id!==a)})),v=async(a,t)=>{var s,r,x;if(a)try{const l=new FormData;l.append("file",a);const i=await b.post("/uploads/image",l,{headers:{"Content-Type":"multipart/form-data"}}),N=((s=i==null?void 0:i.data)==null?void 0:s.url)||"";n(t,{fileUrl:N})}catch(l){console.error("Upload failed:",l),alert(((x=(r=l==null?void 0:l.response)==null?void 0:r.data)==null?void 0:x.message)||l.message||"Upload failed")}};return u?e.jsx("div",{className:"p-4 text-sm text-slate-500",children:"Loading…"}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("header",{className:"bg-white dark:bg-slate-900 border rounded-2xl p-4",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Loan Templates (Applications/Agreements)"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Upload and manage template files."})]}),p&&e.jsx("div",{className:"text-sm text-rose-600",children:p}),m&&e.jsx("div",{className:"text-sm text-emerald-600",children:m}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 border rounded-2xl p-4 space-y-3",children:[e.jsx("button",{className:"px-3 py-1.5 rounded bg-slate-100",onClick:f,children:"Add Template"}),(o.templates||[]).length===0?e.jsx("div",{className:"text-sm text-slate-500",children:"No templates yet."}):e.jsx("div",{className:"space-y-3",children:o.templates.map(a=>e.jsxs("div",{className:"p-3 border rounded-lg grid grid-cols-1 md:grid-cols-6 gap-2",children:[e.jsx("input",{className:"rounded border px-3 py-2 text-sm",placeholder:"Name",value:a.name||"",onChange:t=>n(a.id,{name:t.target.value})}),e.jsxs("select",{className:"rounded border px-3 py-2 text-sm",value:a.type||"application",onChange:t=>n(a.id,{type:t.target.value}),children:[e.jsx("option",{value:"application",children:"Application"}),e.jsx("option",{value:"agreement",children:"Agreement"}),e.jsx("option",{value:"collateral",children:"Collateral"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"file",accept:".pdf,.doc,.docx,.odt,.rtf,.png,.jpg,.jpeg",onChange:t=>{var s;return v((s=t.target.files)==null?void 0:s[0],a.id)},className:"text-sm"}),a.fileUrl?e.jsx("a",{href:a.fileUrl,target:"_blank",rel:"noreferrer",className:"text-blue-600 text-sm underline",children:"View"}):e.jsx("span",{className:"text-xs text-slate-500",children:"No file"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:!!a.active,onChange:t=>n(a.id,{active:t.target.checked})}),"Active"]}),e.jsx("div",{className:"md:col-span-2 flex items-center gap-2",children:e.jsx("button",{className:"px-3 py-1.5 rounded bg-rose-50 text-rose-700",onClick:()=>j(a.id),children:"Delete"})})]},a.id))})]}),e.jsx("button",{className:"px-3 py-1.5 rounded bg-blue-600 text-white text-sm",disabled:c,onClick:()=>h(),children:c?"Saving…":"Save"})]})}export{S as default};
