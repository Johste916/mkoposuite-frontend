import{r as c,j as e}from"./index-DMb-qiOH.js";import{S as h}from"./settings-Kogy3BoH.js";function w(){const[d,p]=c.useState([]),[x,r]=c.useState(""),[o,n]=c.useState({name:"",code:""}),[i,j]=c.useState(!0),m=async()=>{var a,t;r(""),j(!0);try{const s=await h.getLoanCategories();p(Array.isArray(s)?s:[])}catch(s){r(((t=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:t.error)||s.message)}finally{j(!1)}};c.useEffect(()=>{m()},[]);const g=async()=>{var a,t;try{await h.createLoanCategory(o),n({name:"",code:""}),await m()}catch(s){r(((t=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:t.error)||s.message)}},N=async(a,t)=>{var s,l;try{await h.updateLoanCategory(a,t),await m()}catch(u){r(((l=(s=u==null?void 0:u.response)==null?void 0:s.data)==null?void 0:l.error)||u.message)}},b=async a=>{var t,s;if(confirm("Delete?"))try{await h.deleteLoanCategory(a),await m()}catch(l){r(((s=(t=l==null?void 0:l.response)==null?void 0:t.data)==null?void 0:s.error)||l.message)}};return i?e.jsx("div",{className:"p-4 text-sm text-slate-500",children:"Loadingâ€¦"}):e.jsxs("div",{className:"bg-white dark:bg-slate-900 border rounded-2xl p-4 space-y-3",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Loan Categories"}),x&&e.jsx("div",{className:"text-sm text-rose-600",children:x}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-2 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs",children:"Name"}),e.jsx("input",{className:"w-full border rounded px-2 py-1 text-sm",value:o.name,onChange:a=>n(t=>({...t,name:a.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs",children:"Code"}),e.jsx("input",{className:"w-full border rounded px-2 py-1 text-sm",value:o.code,onChange:a=>n(t=>({...t,code:a.target.value}))})]}),e.jsx("div",{children:e.jsx("button",{onClick:g,className:"px-3 py-2 border rounded bg-white",children:"Add"})})]}),e.jsx("div",{className:"overflow-x-auto border rounded-xl",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"p-2 text-left",children:"Name"}),e.jsx("th",{className:"p-2 text-left",children:"Code"}),e.jsx("th",{className:"p-2"})]})}),e.jsx("tbody",{children:d.length===0?e.jsx("tr",{children:e.jsx("td",{className:"p-3",colSpan:3,children:"No categories"})}):d.map(a=>e.jsx(y,{row:a,onSave:N,onDelete:b},a.id))})]})})]})}function y({row:d,onSave:p,onDelete:x}){const[r,o]=c.useState({name:d.name||"",code:d.code||""});return e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"p-2",children:e.jsx("input",{className:"w-full border rounded px-2 py-1",value:r.name,onChange:n=>o(i=>({...i,name:n.target.value}))})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{className:"w-full border rounded px-2 py-1",value:r.code,onChange:n=>o(i=>({...i,code:n.target.value}))})}),e.jsxs("td",{className:"p-2 text-right space-x-2",children:[e.jsx("button",{className:"px-2 py-1 text-xs border rounded",onClick:()=>p(d.id,r),children:"Save"}),e.jsx("button",{className:"px-2 py-1 text-xs border rounded",onClick:()=>x(d.id),children:"Delete"})]})]})}export{w as default};
