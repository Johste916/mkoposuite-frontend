import{w as n,j as e,g as u}from"./index-sMnl2-1N.js";function f(){const[i,d]=n.useState([]),[o,r]=n.useState(""),[g,m]=n.useState(!0),[x,h]=n.useState(null),p=async()=>{var s,l;r(""),m(!0);try{const{data:a}=await u.get("/api/settings/branch-settings");d(Array.isArray(a)?a:[])}catch(a){r(((l=(s=a==null?void 0:a.response)==null?void 0:s.data)==null?void 0:l.error)||a.message)}finally{m(!1)}};n.useEffect(()=>{p()},[]);const j=async s=>{var l,a;h(s.id),r("");try{await u.put(`/api/settings/branch-settings/${s.id}`,{name:s.name,code:s.code,meta:s.meta??null}),await p()}catch(t){r(((a=(l=t==null?void 0:t.response)==null?void 0:l.data)==null?void 0:a.error)||t.message)}finally{h(null)}};return g?e.jsx("div",{className:"p-4 text-sm text-slate-500",children:"Loading…"}):e.jsxs("div",{className:"bg-white dark:bg-slate-900 border rounded-2xl p-4 space-y-3",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Branches"}),o&&e.jsx("div",{className:"text-sm text-rose-600",children:o}),e.jsx("div",{className:"overflow-x-auto border rounded-xl",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"p-2 text-left",children:"Name"}),e.jsx("th",{className:"p-2 text-left",children:"Code"}),e.jsx("th",{className:"p-2 text-left",children:"Meta (JSON)"}),e.jsx("th",{className:"p-2"})]})}),e.jsxs("tbody",{children:[i.map(s=>e.jsxs("tr",{className:"border-b align-top",children:[e.jsx("td",{className:"p-2",children:e.jsx("input",{className:"w-full border rounded px-2 py-1",value:s.name||"",onChange:l=>d(a=>a.map(t=>t.id===s.id?{...t,name:l.target.value}:t))})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{className:"w-full border rounded px-2 py-1",value:s.code||"",onChange:l=>d(a=>a.map(t=>t.id===s.id?{...t,code:l.target.value}:t))})}),e.jsx("td",{className:"p-2",children:e.jsx("textarea",{rows:3,className:"w-full border rounded px-2 py-1 font-mono",value:s.meta?JSON.stringify(s.meta,null,2):"",onChange:l=>{const a=l.target.value;let t=a;try{t=JSON.parse(a)}catch{}d(N=>N.map(c=>c.id===s.id?{...c,meta:t}:c))}})}),e.jsx("td",{className:"p-2 text-right",children:e.jsx("button",{onClick:()=>j(s),disabled:x===s.id,className:"px-2 py-1 text-xs border rounded",children:x===s.id?"Saving…":"Save"})})]},s.id)),i.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"p-3",colSpan:4,children:"No branches"})})]})]})})]})}export{f as default};
