import{r as c,h as et,j as r,L as fe}from"./index-D7WBPAut.js";import{D as kt}from"./download-DuwwlO8x.js";import{C as Ae}from"./circle-plus-Bq4ARxGs.js";import{c as U}from"./createLucideIcon-ktMhJtcA.js";import{i as $e,S as At,a as ge,r as Nt,u as tt,R as St,b as Pt,c as It,d as Ct,g as Ot,e as at,f as Bt,h as Et,j as Lt,k as pe,l as Dt,G as Rt,C as Tt,m as rt,n as _t,L as xe,o as Mt,p as $t,t as Ft,q as Fe,s as nt,v as st,w as it,x as ot,y as Kt,z as lt,A as zt,J as Wt,B as X,D as Ut,E as Vt,F as Gt,H as qt,I as Ke,K as W,M as Xt,N as J,O as Q,P as te,Q as Ht,T as ct,U as dt,V as ut,W as Zt,X as Yt,Y as ze,Z as Jt,_ as Qt,$ as We,a0 as ea,a1 as De,a2 as Ue,a3 as ta,a4 as aa,a5 as Ne,a6 as Se,a7 as Pe,a8 as Ie,a9 as Ce,aa as Oe}from"./CartesianChart-BZx-14ao.js";import{C as ra}from"./chevron-down-BrAUW93b.js";/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]],Ve=U("chart-no-axes-column",na);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],ia=U("clipboard-list",sa);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Be=U("credit-card",oa);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const la=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],H=U("dollar-sign",la);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]],da=U("thumbs-down",ca);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Ge=U("triangle-alert",ua);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ha=U("users",ma);var fa="Invariant failed";function pa(t,e){throw new Error(fa)}var xa=["x","y"];function Re(){return Re=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)({}).hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},Re.apply(null,arguments)}function qe(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),a.push.apply(a,n)}return a}function ie(t){for(var e=1;e<arguments.length;e++){var a=arguments[e]!=null?arguments[e]:{};e%2?qe(Object(a),!0).forEach(function(n){va(t,n,a[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):qe(Object(a)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(a,n))})}return t}function va(t,e,a){return(e=ga(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function ga(t){var e=ya(t,"string");return typeof e=="symbol"?e:e+""}function ya(t,e){if(typeof t!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var n=a.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ba(t,e){if(t==null)return{};var a,n,o=ja(t,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(n=0;n<l.length;n++)a=l[n],e.indexOf(a)===-1&&{}.propertyIsEnumerable.call(t,a)&&(o[a]=t[a])}return o}function ja(t,e){if(t==null)return{};var a={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;a[n]=t[n]}return a}function wa(t,e){var{x:a,y:n}=t,o=ba(t,xa),l="".concat(a),s=parseInt(l,10),m="".concat(n),v=parseInt(m,10),u="".concat(e.height||o.height),p=parseInt(u,10),f="".concat(e.width||o.width),g=parseInt(f,10);return ie(ie(ie(ie(ie({},e),o),s?{x:s}:{}),v?{y:v}:{}),{},{height:p,width:g,name:e.name,radius:e.radius})}function mt(t){return c.createElement(At,Re({shapeType:"rectangle",propTransformer:wa,activeClassName:"recharts-active-bar"},t))}var ka=function(e){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,o)=>{if($e(e))return e;var l=$e(n)||ge(n);return l?e(n,o):(l||pa(),a)}},Aa=["onMouseEnter","onMouseLeave","onClick"],Na=["value","background","tooltipPosition"],Sa=["id"],Pa=["onMouseEnter","onClick","onMouseLeave"];function ee(){return ee=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)({}).hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},ee.apply(null,arguments)}function Xe(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),a.push.apply(a,n)}return a}function D(t){for(var e=1;e<arguments.length;e++){var a=arguments[e]!=null?arguments[e]:{};e%2?Xe(Object(a),!0).forEach(function(n){Ia(t,n,a[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):Xe(Object(a)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(a,n))})}return t}function Ia(t,e,a){return(e=Ca(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function Ca(t){var e=Oa(t,"string");return typeof e=="symbol"?e:e+""}function Oa(t,e){if(typeof t!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var n=a.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ve(t,e){if(t==null)return{};var a,n,o=Ba(t,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(n=0;n<l.length;n++)a=l[n],e.indexOf(a)===-1&&{}.propertyIsEnumerable.call(t,a)&&(o[a]=t[a])}return o}function Ba(t,e){if(t==null)return{};var a={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;a[n]=t[n]}return a}var Ea=t=>{var{dataKey:e,name:a,fill:n,legendType:o,hide:l}=t;return[{inactive:l,dataKey:e,type:o,color:n,value:at(a,e),payload:t}]};function La(t){var{dataKey:e,stroke:a,strokeWidth:n,fill:o,name:l,hide:s,unit:m}=t;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:a,strokeWidth:n,fill:o,dataKey:e,nameKey:void 0,name:at(l,e),hide:s,type:t.tooltipType,color:t.fill,unit:m}}}function Da(t){var e=pe(nt),{data:a,dataKey:n,background:o,allOtherBarProps:l}=t,{onMouseEnter:s,onMouseLeave:m,onClick:v}=l,u=ve(l,Aa),p=st(s,n),f=it(m),g=ot(v,n);if(!o||a==null)return null;var x=Kt(o,!1);return c.createElement(c.Fragment,null,a.map((N,j)=>{var{value:I,background:b,tooltipPosition:w}=N,h=ve(N,Na);if(!b)return null;var S=p(N,j),k=f(N,j),C=g(N,j),B=D(D(D(D(D({option:o,isActive:String(j)===e},h),{},{fill:"#eee"},b),x),lt(u,N,j)),{},{onMouseEnter:S,onMouseLeave:k,onClick:C,dataKey:n,index:j,className:"recharts-bar-background-rectangle"});return c.createElement(mt,ee({key:"background-bar-".concat(j)},B))}))}function ht(t){var{data:e,props:a,showLabels:n}=t,o=Ut(a),{id:l}=o,s=ve(o,Sa),{shape:m,dataKey:v,activeBar:u}=a,p=pe(nt),f=pe(Vt),{onMouseEnter:g,onClick:x,onMouseLeave:N}=a,j=ve(a,Pa),I=st(g,v),b=it(N),w=ot(x,v);return e?c.createElement(c.Fragment,null,e.map((h,S)=>{var k=u&&String(S)===p&&(f==null||v===f),C=k?u:m,B=D(D(D({},s),h),{},{isActive:k,option:C,index:S,dataKey:v});return c.createElement(xe,ee({className:"recharts-bar-rectangle"},lt(j,h,S),{onMouseEnter:I(h,S),onMouseLeave:b(h,S),onClick:w(h,S),key:"rectangle-".concat(h==null?void 0:h.x,"-").concat(h==null?void 0:h.y,"-").concat(h==null?void 0:h.value,"-").concat(S)}),c.createElement(mt,B))}),n&&Gt.renderCallByParent(a,e)):null}function Ra(t){var{props:e,previousRectanglesRef:a}=t,{data:n,layout:o,isAnimationActive:l,animationBegin:s,animationDuration:m,animationEasing:v,onAnimationEnd:u,onAnimationStart:p}=e,f=a.current,g=zt(e,"recharts-bar-"),[x,N]=c.useState(!1),j=c.useCallback(()=>{typeof u=="function"&&u(),N(!1)},[u]),I=c.useCallback(()=>{typeof p=="function"&&p(),N(!0)},[p]);return c.createElement(Wt,{begin:s,duration:m,isActive:l,easing:v,onAnimationEnd:j,onAnimationStart:I,key:g},b=>{var w=b===1?n:n==null?void 0:n.map((h,S)=>{var k=f&&f[S];if(k)return D(D({},h),{},{x:X(k.x,h.x,b),y:X(k.y,h.y,b),width:X(k.width,h.width,b),height:X(k.height,h.height,b)});if(o==="horizontal"){var C=X(0,h.height,b);return D(D({},h),{},{y:h.y+h.height-C,height:C})}var B=X(0,h.width,b);return D(D({},h),{},{width:B})});return b>0&&(a.current=w??null),w==null?null:c.createElement(xe,null,c.createElement(ht,{props:e,data:w,showLabels:!x}))})}function Ta(t){var{data:e,isAnimationActive:a}=t,n=c.useRef(null);return a&&e&&e.length&&(n.current==null||n.current!==e)?c.createElement(Ra,{previousRectanglesRef:n,props:t}):c.createElement(ht,{props:t,data:e,showLabels:!0})}var ft=0,_a=(t,e)=>{var a=Array.isArray(t.value)?t.value[1]:t.value;return{x:t.x,y:t.y,value:a,errorVal:rt(t,e)}};class Ma extends c.PureComponent{render(){var{hide:e,data:a,dataKey:n,className:o,xAxisId:l,yAxisId:s,needClip:m,background:v,id:u}=this.props;if(e)return null;var p=_t("recharts-bar",o),f=u;return c.createElement(xe,{className:p,id:u},m&&c.createElement("defs",null,c.createElement(Mt,{clipPathId:f,xAxisId:l,yAxisId:s})),c.createElement(xe,{className:"recharts-bar-rectangles",clipPath:m?"url(#clipPath-".concat(f,")"):void 0},c.createElement(Da,{data:a,dataKey:n,background:v,allOtherBarProps:this.props}),c.createElement(Ta,this.props)),this.props.children)}}var $a={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!Rt.isSsr,legendType:"rect",minPointSize:ft,xAxisId:0,yAxisId:0};function Fa(t){var{xAxisId:e,yAxisId:a,hide:n,legendType:o,minPointSize:l,activeBar:s,animationBegin:m,animationDuration:v,animationEasing:u,isAnimationActive:p}=t,{needClip:f}=Bt(e,a),g=Et(),x=tt(),N=Lt(t.children,Tt),j=pe(w=>hr(w,e,a,x,t.id,N));if(g!=="vertical"&&g!=="horizontal")return null;var I,b=j==null?void 0:j[0];return b==null||b.height==null||b.width==null?I=0:I=g==="vertical"?b.height/2:b.width/2,c.createElement(Dt,{xAxisId:e,yAxisId:a,data:j,dataPointFormatter:_a,errorBarOffset:I},c.createElement(Ma,ee({},t,{layout:g,needClip:f,data:j,xAxisId:e,yAxisId:a,hide:n,legendType:o,minPointSize:l,activeBar:s,animationBegin:m,animationDuration:v,animationEasing:u,isAnimationActive:p})))}function Ka(t){var{layout:e,barSettings:{dataKey:a,minPointSize:n},pos:o,bandSize:l,xAxis:s,yAxis:m,xAxisTicks:v,yAxisTicks:u,stackedData:p,displayedData:f,offset:g,cells:x}=t,N=e==="horizontal"?m:s,j=p?N.scale.domain():null,I=$t({numericAxis:N});return f.map((b,w)=>{var h,S,k,C,B,V;p?h=Ft(p[w],j):(h=rt(b,a),Array.isArray(h)||(h=[I,h]));var O=ka(n,ft)(h[1],w);if(e==="horizontal"){var G,[ae,q]=[m.scale(h[0]),m.scale(h[1])];S=Fe({axis:s,ticks:v,bandSize:l,offset:o.offset,entry:b,index:w}),k=(G=q??ae)!==null&&G!==void 0?G:void 0,C=o.size;var re=ae-q;if(B=qt(re)?0:re,V={x:S,y:g.top,width:C,height:g.height},Math.abs(O)>0&&Math.abs(B)<Math.abs(O)){var ce=Ke(B||O)*(Math.abs(O)-Math.abs(B));k-=ce,B+=ce}}else{var[ne,ye]=[s.scale(h[0]),s.scale(h[1])];if(S=ne,k=Fe({axis:m,ticks:u,bandSize:l,offset:o.offset,entry:b,index:w}),C=ye-ne,B=o.size,V={x:g.left,y:k,width:g.width,height:B},Math.abs(O)>0&&Math.abs(C)<Math.abs(O)){var de=Ke(C||O)*(Math.abs(O)-Math.abs(C));C+=de}}if(S==null||k==null||C==null||B==null)return null;var be=D(D({},b),{},{x:S,y:k,width:C,height:B,value:p?h:h[1],payload:b,background:V,tooltipPosition:{x:S+C/2,y:k+B/2}},x&&x[w]&&x[w].props);return be}).filter(Boolean)}function Y(t){var e=Nt(t,$a),a=tt();return c.createElement(St,{id:e.id,type:"bar"},n=>c.createElement(c.Fragment,null,c.createElement(Pt,{legendPayload:Ea(e)}),c.createElement(It,{fn:La,args:e}),c.createElement(Ct,{type:"bar",id:n,data:void 0,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:0,dataKey:e.dataKey,stackId:Ot(e.stackId),hide:e.hide,barSize:e.barSize,minPointSize:e.minPointSize,maxBarSize:e.maxBarSize,isPanorama:a}),c.createElement(Fa,ee({},e,{id:n}))))}Y.displayName="Bar";function He(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),a.push.apply(a,n)}return a}function me(t){for(var e=1;e<arguments.length;e++){var a=arguments[e]!=null?arguments[e]:{};e%2?He(Object(a),!0).forEach(function(n){za(t,n,a[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):He(Object(a)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(a,n))})}return t}function za(t,e,a){return(e=Wa(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function Wa(t){var e=Ua(t,"string");return typeof e=="symbol"?e:e+""}function Ua(t,e){if(typeof t!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var n=a.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Va=(t,e)=>e,Ga=(t,e,a)=>a,qa=(t,e,a,n)=>n,Xa=(t,e,a,n,o)=>o,le=W([dt,Xa],(t,e)=>t.filter(a=>a.type==="bar").find(a=>a.id===e)),Ha=W([le],t=>t==null?void 0:t.maxBarSize),Za=(t,e,a,n,o,l)=>l,Ze=(t,e,a)=>{var n=a??t;if(!ge(n))return De(n,e,0)},Ya=W([te,dt,Va,Ga,qa],(t,e,a,n,o)=>e.filter(l=>t==="horizontal"?l.xAxisId===a:l.yAxisId===n).filter(l=>l.isPanorama===o).filter(l=>l.hide===!1).filter(l=>l.type==="bar")),Ja=(t,e,a,n)=>{var o=te(t);return o==="horizontal"?ze(t,"yAxis",a,n):ze(t,"xAxis",e,n)},Qa=(t,e,a)=>{var n=te(t);return n==="horizontal"?We(t,"xAxis",e):We(t,"yAxis",a)},er=(t,e,a)=>{var n={},o=t.filter(ea),l=t.filter(u=>u.stackId==null),s=o.reduce((u,p)=>(u[p.stackId]||(u[p.stackId]=[]),u[p.stackId].push(p),u),n),m=Object.entries(s).map(u=>{var[p,f]=u,g=f.map(N=>N.dataKey),x=Ze(e,a,f[0].barSize);return{stackId:p,dataKeys:g,barSize:x}}),v=l.map(u=>{var p=[u.dataKey].filter(g=>g!=null),f=Ze(e,a,u.barSize);return{stackId:void 0,dataKeys:p,barSize:f}});return[...m,...v]},tr=W([Ya,Qt,Qa],er),ar=(t,e,a,n,o)=>{var l,s,m=le(t,e,a,n,o);if(m!=null){var v=te(t),u=ut(t),{maxBarSize:p}=m,f=ge(p)?u:p,g,x;return v==="horizontal"?(g=J(t,"xAxis",e,n),x=Q(t,"xAxis",e,n)):(g=J(t,"yAxis",a,n),x=Q(t,"yAxis",a,n)),(l=(s=ct(g,x,!0))!==null&&s!==void 0?s:f)!==null&&l!==void 0?l:0}},pt=(t,e,a,n)=>{var o=te(t),l,s;return o==="horizontal"?(l=J(t,"xAxis",e,n),s=Q(t,"xAxis",e,n)):(l=J(t,"yAxis",a,n),s=Q(t,"yAxis",a,n)),ct(l,s)};function rr(t,e,a,n,o){var l=n.length;if(!(l<1)){var s=De(t,a,0,!0),m,v=[];if(Ue(n[0].barSize)){var u=!1,p=a/l,f=n.reduce((b,w)=>b+(w.barSize||0),0);f+=(l-1)*s,f>=a&&(f-=(l-1)*s,s=0),f>=a&&p>0&&(u=!0,p*=.9,f=l*p);var g=(a-f)/2>>0,x={offset:g-s,size:0};m=n.reduce((b,w)=>{var h,S={stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:x.offset+x.size+s,size:u?p:(h=w.barSize)!==null&&h!==void 0?h:0}},k=[...b,S];return x=k[k.length-1].position,k},v)}else{var N=De(e,a,0,!0);a-2*N-(l-1)*s<=0&&(s=0);var j=(a-2*N-(l-1)*s)/l;j>1&&(j>>=0);var I=Ue(o)?Math.min(j,o):j;m=n.reduce((b,w,h)=>[...b,{stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:N+(j+s)*h+(j-I)/2,size:I}}],v)}return m}}var nr=(t,e,a,n,o,l,s)=>{var m=ge(s)?e:s,v=rr(a,n,o!==l?o:l,t,m);return o!==l&&v!=null&&(v=v.map(u=>me(me({},u),{},{position:me(me({},u.position),{},{offset:u.position.offset-o/2})}))),v},sr=W([tr,ut,Zt,Yt,ar,pt,Ha],nr),ir=(t,e,a,n)=>J(t,"xAxis",e,n),or=(t,e,a,n)=>J(t,"yAxis",a,n),lr=(t,e,a,n)=>Q(t,"xAxis",e,n),cr=(t,e,a,n)=>Q(t,"yAxis",a,n),dr=W([sr,le],(t,e)=>{if(!(t==null||e==null)){var a=t.find(n=>n.stackId===e.stackId&&e.dataKey!=null&&n.dataKeys.includes(e.dataKey));if(a!=null)return a.position}}),ur=(t,e)=>{var a=Jt(e);if(!(!t||a==null||e==null)){var{stackId:n}=e;if(n!=null){var o=t[n];if(o){var{stackedData:l}=o;if(l)return l.find(s=>s.key===a)}}}},mr=W([Ja,le],ur),hr=W([Xt,ir,or,lr,cr,dr,te,Ht,pt,mr,le,Za],(t,e,a,n,o,l,s,m,v,u,p,f)=>{var{chartData:g,dataStartIndex:x,dataEndIndex:N}=m;if(!(p==null||l==null||s!=="horizontal"&&s!=="vertical"||e==null||a==null||n==null||o==null||v==null)){var{data:j}=p,I;if(j!=null&&j.length>0?I=j:I=g==null?void 0:g.slice(x,N+1),I!=null)return Ka({layout:s,barSettings:p,pos:l,bandSize:v,xAxis:e,yAxis:a,xAxisTicks:n,yAxisTicks:o,stackedData:u,displayedData:I,offset:t,cells:f})}}),fr=["axis","item"],Ee=c.forwardRef((t,e)=>c.createElement(ta,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:fr,tooltipPayloadSearcher:aa,categoricalChartProps:t,ref:e}));const _={borrowers:"/borrowers",loans:"/loans",repayments:"/repayments",expectedRepayments:"/repayments",deposits:"/deposits",withdrawals:"/withdrawals",savings:"/savings",defaultedLoans:"/loans",defaultedInterest:"/loans",outstandingLoan:"/loans",outstandingInterest:"/loans",writtenOff:"/loans",par:"/loans"},Ye="ms_dash_filters_v1",Je="ms_dash_auto_refresh_v1";function L(t){const a=(t.startsWith("/")?t:`/${t}`).replace(/^\/api\//,"/"),n=a.startsWith("/api/")?a:`/api${a}`;return Array.from(new Set([a,n]))}function Z(t){return(t==null?void 0:t.name)==="CanceledError"||(t==null?void 0:t.code)==="ERR_CANCELED"||/abort|cancell?ed/i.test((t==null?void 0:t.message)||"")}async function oe(t=[],e={}){let a;for(const n of t)try{const o=await et.get(n,e);return o==null?void 0:o.data}catch(o){a=o}throw a||new Error("No endpoint succeeded")}function pr(t){return(Array.isArray(t)?t:(t==null?void 0:t.items)||(t==null?void 0:t.rows)||(t==null?void 0:t.data)||[]).map(a=>({id:a.id??a._id??a.branchId??a.code??String(a.name||"branch"),name:a.name??a.title??a.label??String(a.code||"—")}))}function xr(t){return(Array.isArray(t)?t:(t==null?void 0:t.items)||(t==null?void 0:t.rows)||(t==null?void 0:t.data)||[]).map(a=>({id:a.id??a._id??a.userId??String(a.email||a.phone||"user"),name:a.name||[a.firstName,a.lastName].filter(Boolean).join(" ").trim()||a.username||a.email||a.phone||"—",roles:(a.roles||a.Roles||[]).map(n=>(n.name||n.code||"").toString().toLowerCase()),title:(a.title||a.jobTitle||"").toString().toLowerCase()}))}function vr(t){const e=[...t.roles||[],t.title||""].join(" ");return/loan.*officer|credit.*officer|field.*officer/i.test(e)}function Qe(t){const e=(t==null?void 0:t.summary)||t||{},a=o=>Number(o||0),n=o=>{if(o==null)return 0;const l=String(o).trim().replace("%",""),s=Number(l);return Number.isFinite(s)?s:0};return{totalBorrowers:a(e.totalBorrowers??e.borrowers??e.clients),totalLoans:a(e.totalLoans??e.loans),totalDisbursed:a(e.totalDisbursed??e.disbursed),totalPaid:a(e.totalPaid??e.paid),totalRepaid:a(e.totalRepaid??e.repaid??e.collections),totalExpectedRepayments:a(e.totalExpectedRepayments??e.expectedRepayments),totalDeposits:a(e.totalDeposits??e.deposits),totalWithdrawals:a(e.totalWithdrawals??e.withdrawals),netSavings:a(e.netSavings??(e.totalDeposits||0)-(e.totalWithdrawals||0)),defaultedLoan:a(e.defaultedLoan??e.defaulted??e.nplPrincipal),defaultedInterest:a(e.defaultedInterest??e.nplInterest),outstandingLoan:a(e.outstandingLoan??e.outstandingPrincipal??e.outstanding),outstandingInterest:a(e.outstandingInterest??e.accruedInterest),writtenOff:a(e.writtenOff??e.writeOffs),parPercent:n(e.parPercent??e.par??e.par30??e.portfolioAtRisk),topBorrowers:Array.isArray(e.topBorrowers)?e.topBorrowers:[],upcomingRepayments:Array.isArray(e.upcomingRepayments)?e.upcomingRepayments:[],branchPerformance:Array.isArray(e.branchPerformance)?e.branchPerformance:[],officerPerformance:Array.isArray(e.officerPerformance)?e.officerPerformance:[],generalCommunications:Array.isArray(e.generalCommunications)?e.generalCommunications:[]}}function gr(){var t,e;try{const a=JSON.parse(localStorage.getItem("user")||"{}");return((a==null?void 0:a.role)||((e=(t=a==null?void 0:a.Roles)==null?void 0:t[0])==null?void 0:e.name)||"").toString().toLowerCase()}catch{return""}}function Le(t,{branchId:e,role:a}){const n=Array.isArray(t)?t:(t==null?void 0:t.items)||(t==null?void 0:t.rows)||(t==null?void 0:t.data)||[],o=Date.now(),l=(a||"").toString().toLowerCase();return n.map(s=>{const v=(Array.isArray(s.attachments)?s.attachments:Array.isArray(s.files)?s.files:[]).map(u=>({...u,fileUrl:(u==null?void 0:u.fileUrl)||(u==null?void 0:u.url)||(u==null?void 0:u.href)||(u==null?void 0:u.path)||""})).filter(u=>u.fileUrl);return{id:s.id??s._id??Math.random().toString(36).slice(2),title:s.title??"",text:s.text??s.body??s.title??"",type:(s.type||"notice").toString().toLowerCase(),priority:(s.priority||"normal").toString().toLowerCase(),channel:(s.channel||"inapp").toString().toLowerCase(),isActive:!!(s.isActive??s.active??s.enabled??!0),showInTicker:!!(s.showInTicker??s.ticker??s.showTicker??!1),startAt:s.startAt?new Date(s.startAt).getTime():null,endAt:s.endAt?new Date(s.endAt).getTime():null,audienceRole:s.audienceRole?String(s.audienceRole).toLowerCase():null,audienceBranchId:s.audienceBranchId!=null?String(s.audienceBranchId):s.branchId!=null?String(s.branchId):s.targetBranchId!=null?String(s.targetBranchId):null,attachments:v}}).filter(s=>s.text).filter(s=>s.isActive&&s.channel==="inapp").filter(s=>s.startAt?o>=s.startAt:!0).filter(s=>s.endAt?o<=s.endAt:!0).filter(s=>s.audienceRole?s.audienceRole===l:!0).filter(s=>e&&s.audienceBranchId?String(s.audienceBranchId)===String(e):!0)}const yr=()=>{const[t,e]=c.useState(()=>typeof document<"u"&&document.documentElement.classList.contains("dark"));return c.useEffect(()=>{if(typeof document>"u")return;const a=document.documentElement,n=new MutationObserver(()=>e(a.classList.contains("dark")));return n.observe(a,{attributes:!0,attributeFilter:["class"]}),()=>n.disconnect()},[]),t},br=new Intl.NumberFormat(void 0,{maximumFractionDigits:0}),P={container:"w-full px-4 md:px-6 lg:px-8 py-6",h1:"text-3xl font-extrabold tracking-tight",card:"card",btn:"inline-flex items-center justify-center rounded-lg px-3 py-2 font-semibold transition border-2 border-[var(--border-strong)] bg-[var(--card)] text-[var(--fg)] hover:bg-[var(--chip-soft)]",tableWrap:"overflow-x-auto rounded-2xl border-2 shadow bg-[var(--card)] border-[var(--border-strong)]",th:"bg-[var(--table-head-bg)] text-left text-[13px] uppercase tracking-wide font-semibold px-3 py-2 border border-[var(--border)] text-[var(--fg)] opacity-90",td:"px-3 py-2 border border-[var(--border)] text-sm text-[var(--fg)]"},jr="h-10 w-full rounded-lg text-sm outline-none transition border-2 bg-[var(--input-bg)] text-[var(--input-fg)] border-[var(--input-border)] focus:ring-2 focus:ring-[var(--ring)]",he=({className:t="",children:e,...a})=>r.jsxs("div",{className:`relative ${t}`,children:[r.jsx("select",{...a,className:`${jr} pr-9 appearance-none bg-none ms-select`,children:e}),r.jsx(ra,{className:"pointer-events-none absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--muted)]","aria-hidden":"true"})]}),Ir=()=>{const t=yr(),[e,a]=c.useState(null),[n,o]=c.useState([]),[l,s]=c.useState([]),[m,v]=c.useState(""),[u,p]=c.useState(""),[f,g]=c.useState(""),[x,N]=c.useState(0),[j,I]=c.useState(null),[b,w]=c.useState(null),[h,S]=c.useState(Date.now()),[k,C]=c.useState([]),[B,V]=c.useState(!1),[O,G]=c.useState(null),[ae,q]=c.useState([]),[re,ce]=c.useState([]),[ne,ye]=c.useState([]),[de,be]=c.useState([]),[xt,vt]=c.useState(!0),[gt,Te]=c.useState([]),z=(i,d="info")=>{const A=Math.random().toString(36).slice(2);Te(E=>[...E,{id:A,msg:i,type:d}]),setTimeout(()=>Te(E=>E.filter(F=>F.id!==A)),3500)},R=i=>{const d=Number(i);return Number.isFinite(d)?d:0},$=i=>{const d=R(i);return Number.isNaN(d)?"TZS —":`TZS ${br.format(d)}`},T=(i,d={})=>{try{const A=new URLSearchParams;m&&A.set("branchId",m),u&&A.set("officerId",u),f&&A.set("timeRange",f),Object.entries(d).forEach(([F,K])=>{K!=null&&String(K)!==""&&A.set(F,K)});const E=A.toString();return E?`${i}?${E}`:i}catch{return i}};c.useEffect(()=>{try{const i=localStorage.getItem(Ye);if(i){const d=JSON.parse(i);v(d.branchId||""),p(d.officerId||""),g(d.timeRange||"")}}catch{}try{const i=localStorage.getItem(Je);i&&N(Number(i)||0)}catch{}},[]),c.useEffect(()=>{const i={branchId:m,officerId:u,timeRange:f};localStorage.setItem(Ye,JSON.stringify(i))},[m,u,f]),c.useEffect(()=>{localStorage.setItem(Je,String(x||0))},[x]);const _e=c.useCallback(async i=>{try{const[d,A]=await Promise.all([oe([...L("branches"),...L("org/branches")],{signal:i}),oe([...L("users?role=loan_officer"),...L("admin/staff?role=loan_officer")],{signal:i}).catch(()=>oe([...L("users"),...L("admin/staff")],{signal:i}))]),E=pr(d),F=xr(A),K=F.filter(vr);o(E),s(K.length?K:F)}catch(d){Z(d)||(console.error("Filter fetch error:",(d==null?void 0:d.message)||d),z("Failed to load filters","error"))}},[]),je=c.useCallback(async i=>{try{const d=await oe([...L("dashboard/summary"),...L("dashboard/stats"),...L("dashboard"),...L("reports/at-a-glance"),...L("reports/summary")],{signal:i,params:{branchId:m,officerId:u,timeRange:f}});a(Qe(d))}catch(d){Z(d)||(console.error("Dashboard summary error:",(d==null?void 0:d.message)||d),z("Failed to load summary","error")),a(Qe({}))}},[m,u,f]),se=c.useCallback(async i=>{V(!0);const d=gr();try{const A=[...L("dashboard/communications"),...L("admin/communications?activeOnly=1&channel=inapp"),...L("admin/communications?activeOnly=1")],E=await et.getFirst(A,{signal:i}),F=Le(E,{branchId:m,role:d});if(F.length)C(F);else{const K=Array.isArray(e==null?void 0:e.generalCommunications)?Le(e.generalCommunications,{branchId:m,role:d}):[];C(K)}}catch(A){Z(A)||(console.error("Comms fetch error:",(A==null?void 0:A.message)||A),z("Failed to load communications","error"));const E=Array.isArray(e==null?void 0:e.generalCommunications)?Le(e.generalCommunications,{branchId:m,role:d}):[];C(E)}finally{V(!1)}},[e,m]),we=c.useCallback(async i=>{try{const d=await oe([...L("dashboard/monthly-trends"),...L("reports/monthly-trends"),...L("reports/trends")],{signal:i,params:{branchId:m,officerId:u,timeRange:f}});G(d||{})}catch(d){Z(d)||(console.error("Monthly trends error:",(d==null?void 0:d.message)||d),z("Failed to load trends","error")),G({})}},[m,u,f]);c.useEffect(()=>{const i=new AbortController;return(async()=>{try{await _e(i.signal)}catch{}})(),()=>i.abort()},[_e]);const ue=c.useCallback(async i=>{await Promise.all([je(i),we(i)]),I(new Date),x>0&&w(Date.now()+x*6e4)},[je,we,x]);c.useEffect(()=>{const i=new AbortController;return(async()=>{try{await ue(i.signal)}catch(d){Z(d)||(console.error("Dashboard fetch error:",(d==null?void 0:d.message)||d),z("Failed to load dashboard data","error"))}finally{vt(!1)}})(),()=>i.abort()},[ue]),c.useEffect(()=>{const i=new AbortController;return se(i.signal).catch(d=>{Z(d)||(console.error("Comms fetch error:",(d==null?void 0:d.message)||d),z("Failed to load communications","error"))}),()=>i.abort()},[e,m,se]),c.useEffect(()=>{e&&(Array.isArray(e.topBorrowers)&&q(e.topBorrowers),Array.isArray(e.upcomingRepayments)&&ce(e.upcomingRepayments),Array.isArray(e.branchPerformance)&&ye(e.branchPerformance),Array.isArray(e.officerPerformance)&&be(e.officerPerformance))},[e]),c.useEffect(()=>{if(!x||x<=0){w(null);return}const d=setInterval(()=>{const A=new AbortController;Promise.all([ue(A.signal),se(A.signal)]).catch(()=>{}).finally(()=>A.abort())},x*6e4);return w(Date.now()+x*6e4),()=>clearInterval(d)},[x,ue,se]),c.useEffect(()=>{const i=setInterval(()=>S(Date.now()),1e3);return()=>clearInterval(i)},[]);const ke=({label:i,value:d,max:A})=>{const E=R(d),F=R(A),K=F>0?Math.round(E/F*100):0;return r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex justify-between text-xs text-[var(--muted)]",children:[r.jsx("span",{children:i}),r.jsx("span",{className:"tabular-nums text-[var(--fg)]/80",children:E.toLocaleString()})]}),r.jsx("div",{className:"h-2 w-full rounded bg-[var(--table-head-bg)]",children:r.jsx("div",{className:"h-2 rounded transition-[width] duration-500",style:{width:`${K}%`,backgroundColor:"currentColor"}})})]})},yt=({className:i=""})=>r.jsx("div",{className:`animate-pulse rounded bg-[var(--table-head-bg)] ${i}`}),bt=()=>{const i=k.flatMap(d=>(d.attachments||[]).map(A=>A.fileUrl)).filter(Boolean);i.length!==0&&(i.forEach((d,A)=>{setTimeout(()=>window.open(d,"_blank","noopener,noreferrer"),A*150)}),z(`Opening ${i.length} attachment${i.length>1?"s":""}…`,"info"))},y=t?{grid:"#334155",axis:"#cbd5e1",legend:"#e2e8f0",tooltipBg:"#0b1220",tooltipText:"#e2e8f0",bar1:"#60a5fa",bar2:"#34d399"}:{grid:"#e2e8f0",axis:"#334155",legend:"#334155",tooltipBg:"#ffffff",tooltipText:"#0f172a",bar1:"#2563eb",bar2:"#10b981"},Me=b?Math.max(0,Math.floor((b-h)/1e3)):0,jt=String(Math.floor(Me/60)).padStart(2,"0"),wt=String(Me%60).padStart(2,"0");return r.jsx("div",{className:P.container,children:r.jsxs("div",{className:"space-y-6",style:{color:"var(--fg)"},children:[r.jsx("style",{children:`
          select.ms-select{ -webkit-appearance:none; -moz-appearance:none; appearance:none; background-image:none!important; }
          select.ms-select::-ms-expand{ display:none; }
        `}),r.jsxs("div",{className:`${P.card} p-4 md:p-6`,children:[r.jsxs("div",{className:"flex flex-col md:flex-row md:items-end md:justify-between gap-4",children:[r.jsxs("div",{children:[r.jsx("h1",{className:P.h1,children:"Dashboard"}),r.jsx("p",{className:"text-sm mt-1",style:{color:"var(--muted)"},children:"Quick snapshot of borrowers, loans, repayments and savings."}),r.jsx("p",{className:"text-xs mt-1",style:{color:"var(--muted)"},children:j?`Last updated ${j.toLocaleString()}`:"Loading…"})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[r.jsxs(he,{"aria-label":"Filter by branch",value:m,onChange:i=>v(i.target.value),className:"min-w-[11rem]",children:[r.jsx("option",{value:"",children:"All Branches"}),n.map(i=>r.jsx("option",{value:i.id,children:i.name},i.id))]}),r.jsxs(he,{"aria-label":"Filter by loan officer",value:u,onChange:i=>p(i.target.value),className:"min-w-[12rem]",children:[r.jsx("option",{value:"",children:"All Loan Officers"}),l.map(i=>r.jsx("option",{value:i.id,children:i.name||i.email},i.id))]}),r.jsxs(he,{"aria-label":"Filter by time range",value:f,onChange:i=>g(i.target.value),className:"min-w-[10rem]",children:[r.jsx("option",{value:"",children:"All Time"}),r.jsx("option",{value:"today",children:"Today"}),r.jsx("option",{value:"week",children:"This Week"}),r.jsx("option",{value:"month",children:"This Month"}),r.jsx("option",{value:"quarter",children:"This Quarter"}),r.jsx("option",{value:"semiAnnual",children:"Semi-Annual"}),r.jsx("option",{value:"annual",children:"Annual"})]}),r.jsxs(he,{"aria-label":"Auto refresh interval",value:x,onChange:i=>N(Number(i.target.value)),className:"min-w-[12rem]",children:[r.jsx("option",{value:0,children:"No Auto-Refresh"}),r.jsx("option",{value:1,children:"Every 1 min"}),r.jsx("option",{value:5,children:"Every 5 mins"}),r.jsx("option",{value:15,children:"Every 15 mins"})]}),r.jsx("button",{className:P.btn,onClick:()=>{const i=new AbortController;Promise.all([je(i.signal),we(i.signal),se(i.signal)]).then(()=>{I(new Date),x>0&&w(Date.now()+x*6e4),z("Dashboard refreshed","success")}).catch(()=>z("Refresh failed","error")).finally(()=>i.abort())},"aria-label":"Refresh dashboard",children:"Refresh"})]})]}),x>0&&b&&r.jsxs("div",{className:"mt-3 inline-flex items-center gap-2 rounded-full px-2.5 py-1 text-xs",style:{border:"2px solid var(--border-strong)",color:"var(--fg)"},children:["Auto-refresh in ",jt,":",wt]})]}),r.jsx("div",{className:"fixed right-4 top-4 z-50 space-y-2",children:gt.map(i=>r.jsx("div",{className:`px-3 py-2 rounded shadow text-sm text-white ${i.type==="error"?"bg-red-600":i.type==="success"?"bg-emerald-600":"bg-slate-800"}`,children:i.msg},i.id))}),r.jsxs("div",{className:`${P.card} overflow-hidden`,children:[r.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b",style:{borderColor:"var(--border)",background:"var(--table-head-bg)"},children:[r.jsx("div",{className:"text-xs font-semibold",style:{color:"var(--muted)"},children:"General Communications"}),k.some(i=>Array.isArray(i.attachments)&&i.attachments.length>0)&&r.jsxs("button",{onClick:bt,className:`${P.btn} h-7 px-2 text-xs`,title:"Open all attachments",disabled:B,children:[r.jsx(kt,{className:"w-3 h-3"})," Download all"]})]}),B?r.jsx("div",{className:"p-3 text-sm",style:{color:"var(--muted)"},children:"Loading communications…"}):((k==null?void 0:k.length)??0)===0?r.jsx("div",{className:"p-3 text-sm",style:{color:"var(--muted)"},children:"No communications to display."}):r.jsxs("div",{className:"relative h-10",children:[r.jsx("style",{children:"@keyframes ms-marquee{0%{transform:translateX(100%)}100%{transform:translateX(-100%)}}"}),r.jsx("div",{className:"absolute whitespace-nowrap will-change-transform text-sm flex items-center gap-8 px-3",style:{animation:"ms-marquee 18s linear infinite",color:"var(--fg)"},children:k.map((i,d)=>{var A;return r.jsxs("span",{className:"inline-flex items-center gap-2",children:[i.type&&r.jsx("span",{className:"text-[11px] px-1.5 py-0.5 rounded border",style:{background:"var(--card)",borderColor:"var(--border)"},children:i.type}),i.priority&&r.jsx("span",{className:"text-[11px] px-1.5 py-0.5 rounded border",style:{background:"var(--card)",borderColor:"var(--border)"},children:i.priority}),typeof i.audienceBranchId<"u"&&i.audienceBranchId!==null&&r.jsx("span",{className:"text-[11px] px-1.5 py-0.5 rounded border",style:{background:"var(--card)",borderColor:"var(--border)"},children:((A=n.find(E=>String(E.id)===String(i.audienceBranchId)))==null?void 0:A.name)||`Branch #${i.audienceBranchId}`}),r.jsx("span",{className:"inline-block w-1.5 h-1.5 rounded-full bg-blue-600"}),r.jsx("span",{className:"truncate",children:i.text})]},i.id||i.text||d)})})]})]}),r.jsxs("div",{className:"flex flex-wrap gap-3",children:[r.jsxs(fe,{to:"/loans/add",className:P.btn,children:[r.jsx(Ae,{className:"w-4 h-4"})," Add Loan"]}),r.jsxs(fe,{to:"/borrowers/add",className:P.btn,children:[r.jsx(Ae,{className:"w-4 h-4"})," Add Borrower"]}),r.jsxs(fe,{to:"/repayments/new",className:P.btn,children:[r.jsx(Ae,{className:"w-4 h-4"})," Record Repayment"]})]}),r.jsx("main",{className:"space-y-6",children:xt?r.jsx("div",{className:"grid gap-6 [grid-template-columns:repeat(auto-fit,minmax(230px,1fr))]",children:Array.from({length:8}).map((i,d)=>r.jsx(yt,{className:"h-32"},d))}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"grid gap-6 [grid-template-columns:repeat(auto-fit,minmax(230px,1fr))]",children:[r.jsx(M,{tone:"indigo",title:"Total Borrowers",value:R(e==null?void 0:e.totalBorrowers).toLocaleString(),icon:r.jsx(ha,{className:"w-6 h-6"}),to:T(_.borrowers)}),r.jsx(M,{tone:"sky",title:"Total Loans",value:R(e==null?void 0:e.totalLoans).toLocaleString(),icon:r.jsx(Be,{className:"w-6 h-6"}),to:T(_.loans)}),r.jsx(M,{tone:"blue",title:"Total Disbursed",value:$(e==null?void 0:e.totalDisbursed),icon:r.jsx(Be,{className:"w-6 h-6"}),to:T(_.loans,{tab:"disbursed"})}),r.jsx(M,{tone:"emerald",title:"Total Paid",value:$(e==null?void 0:e.totalPaid),icon:r.jsx(H,{className:"w-6 h-6"}),to:T(_.repayments,{tab:"paid"})}),r.jsx(M,{tone:"emerald",title:"Total Repaid",value:$(e==null?void 0:e.totalRepaid),icon:r.jsx(H,{className:"w-6 h-6"}),to:T(_.repayments,{tab:"paid"})}),r.jsx(M,{tone:"indigo",title:"Expected Repayments",value:$(e==null?void 0:e.totalExpectedRepayments),icon:r.jsx(ia,{className:"w-6 h-6"}),to:T(_.expectedRepayments,{tab:"expected"})}),r.jsx(M,{tone:"cyan",title:"Total Deposits",value:$(e==null?void 0:e.totalDeposits),icon:r.jsx(H,{className:"w-6 h-6"}),to:T(_.deposits)}),r.jsx(M,{tone:"amber",title:"Total Withdrawals",value:$(e==null?void 0:e.totalWithdrawals),icon:r.jsx(H,{className:"w-6 h-6"}),to:T(_.withdrawals)}),r.jsx(M,{tone:"blue",title:"Net Savings",value:$(e==null?void 0:e.netSavings),icon:r.jsx(H,{className:"w-6 h-6"}),to:T(_.savings)}),r.jsx(M,{tone:"rose",title:"Defaulted Loan",value:$(e==null?void 0:e.defaultedLoan),icon:r.jsx(Ge,{className:"w-6 h-6"}),to:T(_.defaultedLoans,{tab:"defaulted"})}),r.jsx(M,{tone:"rose",title:"Defaulted Interest",value:$(e==null?void 0:e.defaultedInterest),icon:r.jsx(Ge,{className:"w-6 h-6"}),to:T(_.defaultedInterest,{tab:"defaulted-interest"})}),r.jsx(M,{tone:"violet",title:"Outstanding Loan",value:$(e==null?void 0:e.outstandingLoan),icon:r.jsx(Be,{className:"w-6 h-6"}),to:T(_.outstandingLoan,{tab:"outstanding"})}),r.jsx(M,{tone:"violet",title:"Outstanding Interest",value:$(e==null?void 0:e.outstandingInterest),icon:r.jsx(H,{className:"w-6 h-6"}),to:T(_.outstandingInterest,{tab:"outstanding-interest"})}),r.jsx(M,{tone:"slate",title:"Written Off",value:$(e==null?void 0:e.writtenOff),icon:r.jsx(da,{className:"w-6 h-6"}),to:T(_.writtenOff,{tab:"written-off"})}),r.jsx(M,{tone:"indigo",title:"PAR (Portfolio at Risk)",value:`${R(e==null?void 0:e.parPercent)}%`,icon:r.jsx(Ve,{className:"w-6 h-6"}),to:T(_.par,{tab:"par"})})]}),O&&r.jsxs("div",{className:`${P.card} p-4`,children:[r.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[r.jsx(Ve,{className:"w-5 h-5 text-indigo-600"}),r.jsx("h3",{className:"text-lg font-semibold",children:`Monthly Trends${O.month||O.year?` — ${O.month||""} ${O.year||""}`:""}`})]}),r.jsx("div",{className:"mb-4",children:r.jsx(Ne,{width:"100%",height:260,children:r.jsxs(Ee,{data:[{name:"Loans",value:R(O.monthlyLoans)},{name:"Deposits",value:R(O.monthlyDeposits)},{name:"Repayments",value:R(O.monthlyRepayments)}],children:[r.jsx(Se,{stroke:y.grid,strokeDasharray:"3 3"}),r.jsx(Pe,{dataKey:"name",tick:{fill:y.axis},axisLine:{stroke:y.axis},tickLine:{stroke:y.axis}}),r.jsx(Ie,{tick:{fill:y.axis},axisLine:{stroke:y.axis},tickLine:{stroke:y.axis}}),r.jsx(Ce,{contentStyle:{backgroundColor:y.tooltipBg,borderColor:y.grid,color:y.tooltipText},wrapperStyle:{outline:"none"}}),r.jsx(Oe,{wrapperStyle:{color:y.legend}}),r.jsx(Y,{dataKey:"value",fill:y.bar1})]})})}),(()=>{const i=[R(O.monthlyLoans),R(O.monthlyDeposits),R(O.monthlyRepayments)],d=Math.max(...i);return r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsx("div",{className:"text-indigo-600",children:r.jsx(ke,{label:"Loans (count)",value:R(O.monthlyLoans),max:d})}),r.jsx("div",{className:"text-emerald-600",children:r.jsx(ke,{label:"Deposits (TZS)",value:R(O.monthlyDeposits),max:d})}),r.jsx("div",{className:"text-blue-600",children:r.jsx(ke,{label:"Repayments (TZS)",value:R(O.monthlyRepayments),max:d})})]})})()]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{className:P.tableWrap,children:[r.jsx("div",{className:"p-4 border-b",style:{borderColor:"var(--border)"},children:r.jsx("h3",{className:"text-lg font-semibold",children:"Top Borrowers"})}),ae.length===0?r.jsx("div",{className:"p-4 text-sm",style:{color:"var(--muted)"},children:"No data available."}):r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{className:P.th,children:"Name"}),r.jsx("th",{className:P.th,children:"Outstanding"})]})}),r.jsx("tbody",{children:ae.map(i=>r.jsxs("tr",{children:[r.jsx("td",{className:P.td,children:i.name}),r.jsx("td",{className:P.td,children:$(i.outstanding)})]},i.id))})]})]}),r.jsxs("div",{className:P.tableWrap,children:[r.jsx("div",{className:"p-4 border-b",style:{borderColor:"var(--border)"},children:r.jsx("h3",{className:"text-lg font-semibold",children:"Upcoming Repayments"})}),re.length===0?r.jsx("div",{className:"p-4 text-sm",style:{color:"var(--muted)"},children:"No data available."}):r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{className:P.th,children:"Borrower"}),r.jsx("th",{className:P.th,children:"Due Date"}),r.jsx("th",{className:P.th,children:"Amount"})]})}),r.jsx("tbody",{children:re.map(i=>r.jsxs("tr",{children:[r.jsx("td",{className:P.td,children:i.borrower}),r.jsx("td",{className:P.td,children:i.dueDate}),r.jsx("td",{className:P.td,children:$(i.amount)})]},i.id))})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{className:`${P.card} p-4`,children:[r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Branch Performance"}),ne.length===0?r.jsx("p",{className:"text-sm",style:{color:"var(--muted)"},children:"No data available."}):r.jsx(Ne,{width:"100%",height:260,children:r.jsxs(Ee,{data:ne,children:[r.jsx(Se,{stroke:y.grid,strokeDasharray:"3 3"}),r.jsx(Pe,{dataKey:"branch",tick:{fill:y.axis},axisLine:{stroke:y.axis},tickLine:{stroke:y.axis}}),r.jsx(Ie,{tick:{fill:y.axis},axisLine:{stroke:y.axis},tickLine:{stroke:y.axis}}),r.jsx(Ce,{contentStyle:{backgroundColor:y.tooltipBg,borderColor:y.grid,color:y.tooltipText},wrapperStyle:{outline:"none"}}),r.jsx(Oe,{wrapperStyle:{color:y.legend}}),r.jsx(Y,{dataKey:"disbursed",fill:y.bar1}),r.jsx(Y,{dataKey:"repayments",fill:y.bar2})]})})]}),r.jsxs("div",{className:`${P.card} p-4`,children:[r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Officer Performance"}),de.length===0?r.jsx("p",{className:"text-sm",style:{color:"var(--muted)"},children:"No data available."}):r.jsx(Ne,{width:"100%",height:260,children:r.jsxs(Ee,{data:de,children:[r.jsx(Se,{stroke:y.grid,strokeDasharray:"3 3"}),r.jsx(Pe,{dataKey:"officer",tick:{fill:y.axis},axisLine:{stroke:y.axis},tickLine:{stroke:y.axis}}),r.jsx(Ie,{tick:{fill:y.axis},axisLine:{stroke:y.axis},tickLine:{stroke:y.axis}}),r.jsx(Ce,{contentStyle:{backgroundColor:y.tooltipBg,borderColor:y.grid,color:y.tooltipText},wrapperStyle:{outline:"none"}}),r.jsx(Oe,{wrapperStyle:{color:y.legend}}),r.jsx(Y,{dataKey:"loans",fill:y.bar1}),r.jsx(Y,{dataKey:"collections",fill:y.bar2})]})})]})]})]})})]})})},M=({title:t,value:e,icon:a,tone:n="indigo",to:o=null,delta:l=null,deltaLabel:s="",spark:m=null})=>{const v={indigo:"text-indigo-600",sky:"text-sky-600",blue:"text-blue-600",emerald:"text-emerald-600",cyan:"text-cyan-600",amber:"text-amber-600",violet:"text-violet-600",rose:"text-rose-600",slate:"text-slate-500"}[n]||"text-slate-500",u=()=>{if(!Array.isArray(m)||m.length<2)return null;const f=96,g=28,x=2,N=Math.min(...m),j=Math.max(...m),I=Math.max(j-N,1e-6),b=(f-x*2)/(m.length-1),w="M "+m.map((h,S)=>{const k=(x+S*b).toFixed(1),C=(g-x-(h-N)/I*(g-x*2)).toFixed(1);return`${k} ${C}`}).join(" L ");return r.jsx("svg",{width:f,height:g,className:"mt-2 opacity-70",children:r.jsx("path",{d:w,fill:"none",stroke:"currentColor",strokeWidth:"2"})})},p=l==null?"":l>=0?"text-emerald-700 bg-emerald-50 ring-1 ring-emerald-200":"text-rose-700 bg-rose-50 ring-1 ring-rose-200";return r.jsxs("div",{className:"group relative",children:[o&&r.jsx(fe,{to:o,className:"absolute inset-0 z-10 rounded-2xl focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[var(--ring)]","aria-label":`View ${t} details`,title:`View ${t} details`}),r.jsxs("div",{className:"relative rounded-2xl p-5 min-h-[10.5rem] shadow transition-all group-hover:shadow-md group-hover:-translate-y-0.5 border-2",style:{background:"var(--card)",borderColor:"var(--border-strong)",color:"var(--fg)"},children:[r.jsxs("div",{className:"relative flex items-start justify-between gap-3",children:[r.jsx("div",{className:`p-3 rounded-full ring-2 ${v}`,style:{background:"var(--card)",boxShadow:"0 1px 0 rgba(0,0,0,.04)"},children:a}),l!=null&&r.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[11px] font-medium ${p}`,children:[l>=0?"↑":"↓"," ",Math.abs(l).toLocaleString(),"%",s&&r.jsxs("span",{className:"opacity-70",children:[" ",s]})]})]}),r.jsxs("div",{className:"relative mt-3 min-w-0",children:[r.jsx("h3",{className:`text-sm font-semibold truncate ${v}`,children:t}),r.jsx("p",{className:"text-[28px] md:text-[32px] leading-tight font-semibold font-mono tabular-nums break-words",children:e??"—"})]}),r.jsx("div",{className:`relative ${v}`,children:r.jsx(u,{})})]})]})};export{Ir as default};
