import{d as $,u as B,r as d,j as e,A as I,C as L,B as S,D as W,b as c}from"./index-ChU33jNq.js";const A=({name:l="",src:x=""})=>{const a=(l||"INV").trim().slice(0,2).toUpperCase();return e.jsx("div",{className:"w-20 h-20 rounded-full bg-slate-200 dark:bg-slate-800 flex items-center justify-center overflow-hidden",children:x?e.jsx("img",{src:x,alt:`${l} photo`,className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-lg font-bold text-slate-600 dark:text-slate-300",children:a})})},j=l=>new Intl.NumberFormat().format(Number(l||0));function _(){const{id:l}=$(),x=B(),[a,v]=d.useState(null),[r,h]=d.useState(!1),[m,N]=d.useState(!1),[f,p]=d.useState(null),[o,b]=d.useState({amount:"",note:""}),[y,E]=d.useState([]),[w,k]=d.useState(!1),u=async()=>{const{data:s}=await c.get(`/investors/${l}`);v(s)},g=async()=>{try{k(!0);const{data:s}=await c.get(`/investors/${l}/transactions`);E(Array.isArray(s)?s:(s==null?void 0:s.rows)||[])}finally{k(!1)}};d.useEffect(()=>{u(),g()},[l]);const[i,n]=d.useState({});d.useEffect(()=>{a&&n({name:a.name||"",email:a.email||"",phone:a.phone||"",address:a.address||"",shares:a.shares||0,contributions:a.contributions||0,positions:Array.isArray(a.positions)?a.positions.join(", "):a.positions||"",bio:a.bio||""})},[a]);const F=d.useMemo(()=>[{label:"Shares",value:j(a==null?void 0:a.shares)},{label:"Contributions",value:j(a==null?void 0:a.contributions)},{label:"Positions",value:Array.isArray(a==null?void 0:a.positions)?a.positions.length:a!=null&&a.positions?String(a.positions).split(",").length:0}],[a]),C=async()=>{N(!0);try{const s=new FormData;Object.entries(i).forEach(([P,U])=>s.append(P,U)),f&&s.append("photo",f);const{data:t}=await c.put(`/investors/${l}`,s,{headers:{"Content-Type":"multipart/form-data"}});v(t),h(!1),p(null)}finally{N(!1)}},D=async()=>{o.amount&&(await c.post(`/investors/${l}/deposits`,{amount:Number(o.amount),note:o.note||""}),b({amount:"",note:""}),u(),g())},T=async()=>{o.amount&&(await c.post(`/investors/${l}/withdrawals`,{amount:Number(o.amount),note:o.note||""}),b({amount:"",note:""}),u(),g())};return a?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>x(-1),className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-800",children:[e.jsx(I,{})," Back"]}),r?e.jsxs("button",{disabled:m,onClick:C,className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg bg-emerald-600 text-white hover:bg-emerald-700 disabled:opacity-60",children:[e.jsx(S,{})," ",m?"Saving…":"Save"]}):e.jsxs("button",{onClick:()=>h(!0),className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700",children:[e.jsx(L,{})," Edit"]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-5",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(A,{name:a.name,src:a.photoUrl}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-xl md:text-2xl font-bold",children:a.name}),e.jsxs("div",{className:"mt-1 text-sm text-slate-500 space-x-3",children:[a.email&&e.jsx("span",{children:a.email}),a.phone&&e.jsxs("span",{children:["• ",a.phone]}),a.address&&e.jsxs("span",{children:["• ",a.address]})]})]})]}),e.jsx("div",{className:"mt-4 grid grid-cols-1 sm:grid-cols-3 gap-3",children:F.map(s=>e.jsxs("div",{className:"rounded-xl border border-slate-200 dark:border-slate-800 p-4",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-slate-500",children:s.label}),e.jsx("div",{className:"text-lg font-semibold mt-1",children:s.value})]},s.label))})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-4",children:[e.jsx("h2",{className:"text-base font-semibold",children:"Profile"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Update identity, contact info, shares and roles."}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-500",children:"Name"}),e.jsx("input",{disabled:!r,value:i.name,onChange:s=>n(t=>({...t,name:s.target.value})),className:"w-full mt-1 px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-500",children:"Email"}),e.jsx("input",{disabled:!r,value:i.email,onChange:s=>n(t=>({...t,email:s.target.value})),className:"w-full mt-1 px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-500",children:"Phone"}),e.jsx("input",{disabled:!r,value:i.phone,onChange:s=>n(t=>({...t,phone:s.target.value})),className:"w-full mt-1 px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-500",children:"Address"}),e.jsx("input",{disabled:!r,value:i.address,onChange:s=>n(t=>({...t,address:s.target.value})),className:"w-full mt-1 px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-500",children:"Shares"}),e.jsx("input",{disabled:!r,type:"number",value:i.shares,onChange:s=>n(t=>({...t,shares:s.target.value})),className:"w-full mt-1 px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-500",children:"Contributions"}),e.jsx("input",{disabled:!r,type:"number",value:i.contributions,onChange:s=>n(t=>({...t,contributions:s.target.value})),className:"w-full mt-1 px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-500",children:"Positions (comma-separated)"}),e.jsx("input",{disabled:!r,value:i.positions,onChange:s=>n(t=>({...t,positions:s.target.value})),className:"w-full mt-1 px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-500",children:"Bio / Notes"}),e.jsx("textarea",{disabled:!r,rows:4,value:i.bio,onChange:s=>n(t=>({...t,bio:s.target.value})),className:"w-full mt-1 px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-500",children:"Photo"}),e.jsxs("div",{className:"mt-1 flex items-center gap-3",children:[e.jsx(A,{name:i.name,src:a.photoUrl}),e.jsx("input",{disabled:!r,type:"file",accept:"image/*",onChange:s=>{var t;return p(((t=s.target.files)==null?void 0:t[0])||null)}})]})]})]}),r&&e.jsxs("div",{className:"mt-4 flex items-center gap-3",children:[e.jsxs("button",{onClick:C,disabled:m,className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg bg-emerald-600 text-white hover:bg-emerald-700 disabled:opacity-60",children:[e.jsx(S,{})," ",m?"Saving…":"Save Changes"]}),e.jsx("button",{onClick:()=>{h(!1),p(null),n(s=>s)},className:"px-3 py-2 rounded-lg border",children:"Cancel"})]})]})}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-base font-semibold",children:"Transactions"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Deposits & Withdrawals"})]})}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-[1fr_auto_auto] gap-3",children:[e.jsx("input",{type:"number",placeholder:"Amount",value:o.amount,onChange:s=>b(t=>({...t,amount:s.target.value})),className:"px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900"}),e.jsx("input",{placeholder:"Note (optional)",value:o.note,onChange:s=>b(t=>({...t,note:s.target.value})),className:"px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:D,className:"px-3 py-2 rounded-lg bg-emerald-600 text-white hover:bg-emerald-700",children:"Deposit"}),e.jsx("button",{onClick:T,className:"px-3 py-2 rounded-lg bg-rose-600 text-white hover:bg-rose-700",children:"Withdraw"})]})]}),e.jsx("div",{className:"mt-4 overflow-x-auto",children:e.jsxs("table",{className:"min-w-[560px] w-full text-sm",children:[e.jsx("thead",{className:"text-left text-slate-500",children:e.jsxs("tr",{className:"border-b border-slate-200 dark:border-slate-800",children:[e.jsx("th",{className:"px-3 py-2",children:"Date"}),e.jsx("th",{className:"px-3 py-2",children:"Type"}),e.jsx("th",{className:"px-3 py-2",children:"Amount"}),e.jsx("th",{className:"px-3 py-2",children:"Note"})]})}),e.jsxs("tbody",{children:[w&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-3 py-4 text-slate-500",children:"Loading…"})}),!w&&y.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-3 py-4 text-slate-500",children:"No transactions yet."})}),y.map((s,t)=>e.jsxs("tr",{className:"border-t border-slate-100 dark:border-slate-800",children:[e.jsx("td",{className:"px-3 py-2",children:s.date||s.createdAt||"—"}),e.jsx("td",{className:"px-3 py-2 capitalize",children:s.type||"—"}),e.jsx("td",{className:"px-3 py-2",children:j(s.amount)}),e.jsx("td",{className:"px-3 py-2",children:s.note||"—"})]},t))]})]})})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-4",children:[e.jsx("h2",{className:"text-base font-semibold",children:"Related Files"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Upload agreements or KYC documents."}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("label",{className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg border cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-800",children:[e.jsx(W,{})," ",e.jsx("span",{children:"Select files…"}),e.jsx("input",{type:"file",className:"hidden",multiple:!0})]}),e.jsxs("p",{className:"text-xs text-slate-400 mt-2",children:["(Hook this to ",e.jsxs("code",{children:["/api/investors/",l,"/files"]})," when you’re ready.)"]})]})]})]})]})]}):e.jsx("div",{className:"p-6 text-sm text-slate-500",children:"Loading investor…"})}export{_ as default};
