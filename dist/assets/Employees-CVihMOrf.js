import{r,j as e,g as y}from"./index-DjWo3pGF.js";function N(){const[c,g]=r.useState([]),[i,n]=r.useState({firstName:"",lastName:"",email:"",role:"staff",baseSalary:0}),[o,d]=r.useState(""),[m,x]=r.useState(!1),p=async()=>{var s,a,t,h,u;d("");try{const{data:l}=await y.get("/hr/employees",{params:{limit:1e3}});g((l==null?void 0:l.items)||[])}catch(l){d((t=(a=(s=l==null?void 0:l.response)==null?void 0:s.data)==null?void 0:a.message)!=null&&t.includes("Required table is missing")?"Required table is missing. Run DB migrations on the backend (npx sequelize-cli db:migrate).":((u=(h=l==null?void 0:l.response)==null?void 0:h.data)==null?void 0:u.message)||l.message)}};r.useEffect(()=>{p()},[]);const b=async()=>{var s,a;x(!0),d("");try{await y.post("/hr/employees",i),n({firstName:"",lastName:"",email:"",role:"staff",baseSalary:0}),await p()}catch(t){d(((a=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:a.message)||t.message)}finally{x(!1)}};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Employees"}),o&&e.jsx("div",{className:"text-sm text-red-600",children:o}),e.jsxs("div",{className:"bg-white border rounded-xl p-3 grid grid-cols-2 md:grid-cols-5 gap-2 items-end",children:[["firstName","lastName","email"].map(s=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 capitalize",children:s}),e.jsx("input",{className:"border rounded px-2 py-1 text-sm w-full",value:i[s],onChange:a=>n(t=>({...t,[s]:a.target.value}))})]},s)),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500",children:"Role"}),e.jsxs("select",{className:"border rounded px-2 py-1 text-sm w-full",value:i.role,onChange:s=>n(a=>({...a,role:s.target.value})),children:[e.jsx("option",{value:"staff",children:"Staff"}),e.jsx("option",{value:"payroll_admin",children:"Payroll Admin"}),e.jsx("option",{value:"branch_manager",children:"Branch Manager"}),e.jsx("option",{value:"admin",children:"Admin"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500",children:"Base Salary (TZS)"}),e.jsx("input",{type:"number",className:"border rounded px-2 py-1 text-sm w-full",value:i.baseSalary,onChange:s=>n(a=>({...a,baseSalary:Number(s.target.value||0)}))})]}),e.jsx("button",{onClick:b,disabled:m,className:"px-3 py-2 border rounded-lg bg-white hover:bg-gray-50 text-sm md:col-span-1",children:m?"Savingâ€¦":"Add"})]}),e.jsx("div",{className:"bg-white border rounded-xl overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-600 border-b",children:[e.jsx("th",{className:"py-2 px-3",children:"Name"}),e.jsx("th",{className:"py-2 px-3",children:"Email"}),e.jsx("th",{className:"py-2 px-3",children:"Role"}),e.jsx("th",{className:"py-2 px-3",children:"Base Salary"})]})}),e.jsx("tbody",{children:c.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"p-3 text-gray-500",children:"No employees."})}):c.map(s=>e.jsxs("tr",{className:"border-b",children:[e.jsxs("td",{className:"py-2 px-3",children:[s.firstName," ",s.lastName]}),e.jsx("td",{className:"py-2 px-3",children:s.email}),e.jsx("td",{className:"py-2 px-3",children:s.role}),e.jsxs("td",{className:"py-2 px-3",children:["TZS ",Number(s.baseSalary||0).toLocaleString()]})]},s.id))})]})})]})}export{N as default};
