import{r as n,b as S,j as e}from"./index-BMxYIXeW.js";function q({url:s,params:l={},initialPage:p=1,initialLimit:c=20}){const[i,o]=n.useState(p),[a,b]=n.useState(c),[y,g]=n.useState(l.q||""),[f,j]=n.useState(!0),[m,t]=n.useState(""),[x,k]=n.useState([]),[w,L]=n.useState(0),N=n.useMemo(()=>({...l,page:i,limit:a,q:y||void 0}),[l,i,a,y]),v=n.useMemo(()=>{var d,h;const u=((h=(d=S)==null?void 0:d.defaults)==null?void 0:h.baseURL)||"";return/\/api\/?$/.test(u)&&s.startsWith("/api/")?s.slice(4):s},[s]);return n.useEffect(()=>{let u=!1;return j(!0),t(""),S.get(v,{params:N}).then(r=>{if(u)return;const{data:d=[],pagination:h={}}=r.data||{};k(Array.isArray(d)?d:r.data||[]),L(h.total??(Array.isArray(r.data)?r.data.length:0))}).catch(r=>{var d,h;return!u&&t(((h=(d=r==null?void 0:r.response)==null?void 0:d.data)==null?void 0:h.error)||r.message)}).finally(()=>!u&&j(!1)),()=>{u=!0}},[v,JSON.stringify(N)]),{rows:x,total:w,page:i,setPage:o,limit:a,setLimit:b,q:y,setQ:g,loading:f,error:m,refresh:()=>S.get(v,{params:N})}}function M({page:s,setPage:l,limit:p,setLimit:c,total:i}){const o=Math.max(1,Math.ceil((i||0)/(p||20)));return e.jsxs("div",{className:"flex items-center justify-between gap-3 mt-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"Rows:"}),e.jsx("select",{className:"border rounded px-2 py-1",value:p,onChange:a=>{l(1),c(parseInt(a.target.value,10))},children:[10,20,50,100].map(a=>e.jsx("option",{value:a,children:a},a))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"px-3 py-1 border rounded disabled:opacity-50",onClick:()=>l(Math.max(1,s-1)),disabled:s<=1,children:"Prev"}),e.jsxs("span",{children:["Page ",s," / ",o]}),e.jsx("button",{className:"px-3 py-1 border rounded disabled:opacity-50",onClick:()=>l(Math.min(o,s+1)),disabled:s>=o,children:"Next"})]})]})}function A({title:s,q:l,setQ:p,columns:c=[],rows:i=[],loading:o,error:a,page:b,setPage:y,limit:g,setLimit:f,total:j,renderActions:m}){return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow p-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold",children:s}),e.jsx("input",{value:l,onChange:t=>p(t.target.value),placeholder:"Search…",className:"px-3 py-2 border rounded w-60 dark:bg-gray-700"})]}),a&&e.jsxs("div",{className:"text-red-500 text-sm mb-3",children:["Error: ",a]}),o?e.jsx("div",{className:"py-10 text-center text-sm opacity-70",children:"Loading…"}):e.jsx("div",{className:"overflow-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left border-b dark:border-gray-700",children:[c.map(t=>e.jsx("th",{className:"px-3 py-2",children:t.title},t.key)),m&&e.jsx("th",{className:"px-3 py-2",children:"Actions"})]})}),e.jsx("tbody",{children:i.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:c.length+(m?1:0),className:"px-3 py-10 text-center opacity-70",children:"No data"})}):i.map(t=>e.jsxs("tr",{className:"border-b last:border-0 dark:border-gray-700",children:[c.map(x=>e.jsx("td",{className:"px-3 py-2",children:typeof x.render=="function"?x.render(t[x.key],t):String(t[x.key]??"—")},x.key)),m&&e.jsx("td",{className:"px-3 py-2",children:m(t)})]},t.id??JSON.stringify(t)))})]})}),e.jsx(M,{page:b,setPage:y,limit:g,setLimit:f,total:j})]})}export{A as L,q as u};
