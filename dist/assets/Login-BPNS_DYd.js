import{u as R,a as B,r as s,j as e,B as M,F as $,b as q,c as z,d as D,L as k,e as O,f as T,s as U,g as _}from"./index-L976ZryY.js";const G="https://mkoposuite-backend-42w2.onrender.com/api",p=G.replace(/\/+$/,""),H=/\/api$/i.test(p)?`${p}/login`:`${p}/api/login`,J="Please login to continue";function W(){const L=R(),u=B(),x=s.useRef(null),[g,d]=s.useState(""),[v,F]=s.useState(""),[l,I]=s.useState(!1),[h,C]=s.useState(!0),[c,b]=s.useState(""),[f,j]=s.useState(!1);s.useEffect(()=>{const n=new URLSearchParams(u.search).get("email"),i=localStorage.getItem("lastLoginEmail");n?d(n):i&&d(i),setTimeout(()=>{var o;return(o=x.current)==null?void 0:o.focus()},0)},[u.search]);async function A(a){var n,i,o,N,y;a.preventDefault(),b(""),j(!0);try{const t={email:g.trim(),password:v},{data:m}=await T.post(H,t),{token:w,user:r,tenantId:P,permissions:S}=m||{};if(!w)throw new Error("No token received from server");Array.isArray(S)?U(S):_(),h?localStorage.setItem("lastLoginEmail",t.email):localStorage.removeItem("lastLoginEmail"),localStorage.setItem("token",w),localStorage.setItem("user",JSON.stringify(r||{}));const E=P||(r==null?void 0:r.tenantId)||((n=r==null?void 0:r.tenant)==null?void 0:n.id)||void 0||null;E&&localStorage.setItem("activeTenantId",String(E)),L("/")}catch(t){_();const m=((o=(i=t==null?void 0:t.response)==null?void 0:i.data)==null?void 0:o.error)||((y=(N=t==null?void 0:t.response)==null?void 0:N.data)==null?void 0:y.message)||(t==null?void 0:t.message)||"Invalid email or password";b(m)}finally{j(!1)}}return e.jsxs("div",{className:"min-h-screen relative overflow-hidden app-theme-bold",style:{background:"var(--bg, #F7FAFF)"},children:[e.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[e.jsx("div",{className:"absolute inset-0 opacity-[.08] bg-[radial-gradient(900px_520px_at_10%_0%,rgba(59,130,246,.40),transparent_60%)]"}),e.jsx("div",{className:"absolute inset-0 opacity-[.08] bg-[radial-gradient(780px_420px_at_95%_100%,rgba(45,212,191,.40),transparent_60%)]"})]}),e.jsx("div",{className:"relative z-10 min-h-screen grid place-items-center px-4 py-10",children:e.jsx("section",{className:"w-full max-w-[520px]",children:e.jsx("div",{className:"rounded-2xl bg-[var(--card)] border border-[var(--border)] shadow-[0_18px_40px_-12px_rgba(15,23,42,0.18)]",children:e.jsxs("div",{className:"px-8 pt-7 pb-8",children:[e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(M,{size:32})}),e.jsx("p",{className:"mt-2 text-center text-[13px] text-[var(--muted)]",children:J}),c?e.jsx("div",{role:"alert",className:"mt-4 rounded-lg border border-rose-200 bg-rose-50 px-3 py-2 text-sm text-rose-700",children:c}):null,e.jsxs("form",{onSubmit:A,className:"mt-6 space-y-4",noValidate:!0,children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-semibold text-[var(--fg)]",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx($,{"aria-hidden":!0,className:"pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 text-[var(--muted)]"}),e.jsx("input",{ref:x,type:"email",inputMode:"email",autoCapitalize:"none",autoCorrect:"off",value:g,onChange:a=>d(a.target.value),className:`w-full h-11 rounded-xl border border-[var(--border)] bg-[var(--input-bg)]\r
                                 text-[var(--input-fg)] placeholder:text-[var(--input-placeholder)]\r
                                 !pl-10 pr-3 text-sm shadow-sm outline-none transition\r
                                 focus:ring-2 focus:ring-[var(--ring)]`,required:!0,placeholder:"admin@example.com",autoComplete:"email","aria-invalid":!!c})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-semibold text-[var(--fg)]",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{"aria-hidden":!0,className:"pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 text-[var(--muted)]"}),e.jsx("input",{type:l?"text":"password",value:v,onChange:a=>F(a.target.value),className:`w-full h-11 rounded-xl border border-[var(--border)] bg-[var(--input-bg)]\r
                                 text-[var(--input-fg)] placeholder:text-[var(--input-placeholder)]\r
                                 !pl-10 !pr-11 text-sm shadow-sm outline-none transition\r
                                 focus:ring-2 focus:ring-[var(--ring)]`,required:!0,placeholder:"Enter your password",autoComplete:"current-password","aria-invalid":!!c}),e.jsx("button",{type:"button",onClick:()=>I(a=>!a),className:"absolute right-3 top-1/2 -translate-y-1/2 text-[var(--muted)] hover:opacity-80","aria-label":l?"Hide password":"Show password","aria-pressed":l,children:l?e.jsx(z,{}):e.jsx(D,{})})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("label",{className:"inline-flex items-center gap-2 select-none",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-[var(--border)]",checked:h,onChange:a=>C(a.target.checked)}),e.jsx("span",{className:"text-[var(--muted)]",children:"Remember me"})]}),e.jsx(k,{to:"/forgot-password",className:"font-medium",style:{color:"var(--primary)"},children:"Forgot password?"})]}),e.jsx("button",{type:"submit",disabled:f,className:`inline-flex w-full items-center justify-center rounded-xl bg-[var(--primary)]\r
                             px-4 h-11 text-sm font-semibold text-[var(--primary-contrast)] shadow\r
                             hover:brightness-95 focus-visible:outline-none focus-visible:ring-2\r
                             focus-visible:ring-[var(--ring)] disabled:opacity-60`,children:f?e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"mr-2 animate-spin"}),"Logging in…"]}):"Login"})]}),e.jsxs("div",{className:"mt-6 text-center text-sm text-[var(--muted)]",children:["Don’t have an account?"," ",e.jsx(k,{to:"/signup",className:"font-semibold",style:{color:"var(--primary)"},children:"Create one"})]}),e.jsxs("div",{className:"mt-4 text-center text-[11px] text-[var(--muted)]",children:["© ",new Date().getFullYear()," MkopoSuite. All rights reserved."]})]})})})})]})}export{W as default};
