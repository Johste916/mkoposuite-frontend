import{r as l,j as e,g}from"./index-BWN1fagU.js";const o=r=>Number(r||0).toLocaleString();function y(){const[r,p]=l.useState(""),[n,h]=l.useState(""),[a,j]=l.useState(null),[b,d]=l.useState(!0),[i,x]=l.useState(""),m=async()=>{var s,c;d(!0),x("");try{const t={};r&&(t.from=r),n&&(t.to=n);const{data:N}=await g.get("/accounting/profit-loss",{params:t});j(N||null)}catch(t){x(((c=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:c.error)||t.message)}finally{d(!1)}},u=()=>{const s="https://mkoposuite-backend-42w2.onrender.com/api",c=new URLSearchParams({});r&&c.set("from",r),n&&c.set("to",n);const t=c.toString();window.open(`${s}/accounting/profit-loss/export/csv${t?`?${t}`:""}`,"_blank")};return l.useEffect(()=>{m()},[]),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow p-4",children:[e.jsxs("div",{className:"flex items-end justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Profit & Loss"}),e.jsx("div",{className:"text-xs text-slate-500",children:r||n?`${r||"…"} → ${n||"…"}`:"All time"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("label",{className:"block text-xs opacity-70",children:"From"}),e.jsx("input",{type:"date",value:r,onChange:s=>p(s.target.value),className:"border rounded px-2 py-1 dark:bg-gray-700"})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("label",{className:"block text-xs opacity-70",children:"To"}),e.jsx("input",{type:"date",value:n,onChange:s=>h(s.target.value),className:"border rounded px-2 py-1 dark:bg-gray-700"})]}),e.jsx("button",{onClick:m,className:"px-3 py-2 rounded bg-blue-600 text-white text-sm",children:"Run"}),e.jsx("button",{onClick:u,className:"px-3 py-2 rounded border text-sm",children:"Export CSV"})]})]}),i&&e.jsxs("div",{className:"text-red-500 text-sm mb-3",children:["Error: ",i]}),b||!a?e.jsx("div",{className:"py-10 text-center opacity-70",children:"Loading…"}):e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 text-sm",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Income"}),e.jsx("div",{className:"border rounded",children:e.jsx("table",{className:"w-full",children:e.jsxs("tbody",{children:[(a.income||[]).map(s=>e.jsxs("tr",{className:"border-b last:border-0",children:[e.jsxs("td",{className:"px-3 py-2",children:[s.code||"—"," — ",s.name||"—"]}),e.jsx("td",{className:"px-3 py-2 text-right",children:o(s.amount)})]},s.accountId)),(!a.income||a.income.length===0)&&e.jsx("tr",{children:e.jsx("td",{className:"px-3 py-4 text-center opacity-60",children:"No income lines"})}),e.jsxs("tr",{className:"font-semibold border-t",children:[e.jsx("td",{className:"px-3 py-2 text-right",children:"Total Income"}),e.jsx("td",{className:"px-3 py-2 text-right",children:o(a.totalIncome)})]})]})})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Expenses"}),e.jsx("div",{className:"border rounded",children:e.jsx("table",{className:"w-full",children:e.jsxs("tbody",{children:[(a.expense||[]).map(s=>e.jsxs("tr",{className:"border-b last:border-0",children:[e.jsxs("td",{className:"px-3 py-2",children:[s.code||"—"," — ",s.name||"—"]}),e.jsx("td",{className:"px-3 py-2 text-right",children:o(s.amount)})]},s.accountId)),(!a.expense||a.expense.length===0)&&e.jsx("tr",{children:e.jsx("td",{className:"px-3 py-4 text-center opacity-60",children:"No expense lines"})}),e.jsxs("tr",{className:"font-semibold border-t",children:[e.jsx("td",{className:"px-3 py-2 text-right",children:"Total Expense"}),e.jsx("td",{className:"px-3 py-2 text-right",children:o(a.totalExpense)})]})]})})})]}),e.jsxs("div",{className:"md:col-span-2 border-t pt-2 font-semibold flex justify-between",children:[e.jsx("span",{children:"Net Profit"}),e.jsx("span",{children:o(a.netProfit)})]})]})]})}export{y as default};
