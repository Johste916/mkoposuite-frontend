import{r as l,j as e,g as N}from"./index-C40kITj2.js";function y(){const[c,f]=l.useState([]),[n,i]=l.useState(!1),[x,p]=l.useState(""),[m,h]=l.useState({}),[b,j]=l.useState(null),o=async()=>{var t,d,r;p(""),i(!0);try{const s=await N._get("/savings/transactions?status=pending&limit=100");f(((t=s.data)==null?void 0:t.data)||[])}catch(s){p(((r=(d=s==null?void 0:s.response)==null?void 0:d.data)==null?void 0:r.error)||(s==null?void 0:s.normalizedMessage)||"Failed to load")}finally{i(!1)}};l.useEffect(()=>{o()},[]);const g=async(t,d)=>{var s,u;const r=(m[t]||"").trim();if(!r)return alert("Approval comment is required.");try{j(t),await N._patch(`/savings/transactions/${t}/${d}`,{comment:r}),await o(),h(a=>({...a,[t]:""}))}catch(a){alert(((u=(s=a==null?void 0:a.response)==null?void 0:s.data)==null?void 0:u.error)||(a==null?void 0:a.normalizedMessage)||"Failed")}finally{j(null)}};return e.jsxs("div",{className:"bg-white dark:bg-slate-900 border rounded-2xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h1",{className:"text-lg font-semibold",children:"Approve Savings Transactions"}),e.jsx("button",{onClick:o,className:"px-3 py-1.5 rounded border text-sm hover:bg-slate-50 dark:hover:bg-slate-800",disabled:n,children:n?"Refreshingâ€¦":"Refresh"})]}),x&&e.jsx("div",{className:"text-sm text-rose-600 mb-2",children:x}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-100 dark:bg-slate-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 border text-left",children:"Date"}),e.jsx("th",{className:"p-2 border text-left",children:"Borrower ID"}),e.jsx("th",{className:"p-2 border text-left",children:"Type"}),e.jsx("th",{className:"p-2 border text-right",children:"Amount"}),e.jsx("th",{className:"p-2 border text-left",children:"Notes"}),e.jsx("th",{className:"p-2 border text-left w-[260px]",children:"Approval Comment"}),e.jsx("th",{className:"p-2 border text-center",children:"Action"})]})}),e.jsxs("tbody",{children:[c.map(t=>e.jsxs("tr",{className:"odd:bg-white even:bg-slate-50/50 dark:odd:bg-slate-900 dark:even:bg-slate-800/60",children:[e.jsx("td",{className:"border p-2",children:t.date}),e.jsx("td",{className:"border p-2",children:t.borrowerId}),e.jsx("td",{className:"border p-2 capitalize",children:t.type}),e.jsx("td",{className:"border p-2 text-right",children:t.amount}),e.jsx("td",{className:"border p-2",children:t.notes||"-"}),e.jsx("td",{className:"border p-2",children:e.jsx("input",{type:"text",placeholder:"Required for approval",className:"w-full px-2 py-1 rounded border dark:bg-slate-800 dark:border-slate-700",value:m[t.id]||"",onChange:d=>h(r=>({...r,[t.id]:d.target.value}))})}),e.jsxs("td",{className:"border p-2 text-center",children:[e.jsx("button",{className:"px-2 py-1 rounded bg-emerald-600 text-white mr-2 disabled:opacity-50",onClick:()=>g(t.id,"approve"),disabled:b===t.id,children:"Approve"}),e.jsx("button",{className:"px-2 py-1 rounded bg-rose-600 text-white disabled:opacity-50",onClick:()=>g(t.id,"reject"),disabled:b===t.id,children:"Reject"})]})]},t.id)),!n&&c.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"p-3 text-slate-500",colSpan:7,children:"No pending transactions."})})]})]})})]})}export{y as default};
