import{u as M,r as n,c as u,j as e,L as b}from"./index-DKzQi57G.js";import{c as d}from"./createLucideIcon-D_CKCQ4i.js";import{U as A,X as $,P as R,I as U,B as H}from"./x-FIlXLLB6.js";import{U as z}from"./user-plus-D65k-nIg.js";/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],f=d("calendar",G);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],W=d("camera",V);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Y=d("map-pin",X);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Q=d("save",J);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],w=d("user",Z),C=()=>new Date().toISOString().slice(0,10),t="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500/40 focus:border-indigo-500 transition-all",c="bg-white rounded-2xl shadow-sm ring-1 ring-black/5 p-4 md:p-6";function te(){const I=M(),D=[{value:"male",label:"Male"},{value:"female",label:"Female"},{value:"other",label:"Other"}],P=[{value:"employed_private",label:"Employed (Private)"},{value:"employed_public",label:"Employed (Public)"},{value:"self_employed",label:"Self-Employed"},{value:"business_owner",label:"Business Owner"},{value:"student",label:"Student"},{value:"pensioner",label:"Pensioner"},{value:"unemployed",label:"Unemployed"}],S=[{value:"national_id",label:"National ID"},{value:"passport",label:"Passport"},{value:"driver_license",label:"Driver License"},{value:"voter_id",label:"Voter ID"},{value:"other",label:"Other"}],k=[{value:"individual",label:"Individual"},{value:"group",label:"Group"}],[O,h]=n.useState([]),[T,p]=n.useState([]),[g,v]=n.useState(!1),[x,j]=n.useState(null),[N,y]=n.useState(null),m=n.useRef(null),[a,l]=n.useState({firstName:"",lastName:"",phone:"",secondaryPhone:"",email:"",occupation:"",gender:"",birthDate:"",addressLine:"",city:"",district:"",ward:"",street:"",houseNumber:"",employmentStatus:"",idType:"",idNumber:"",idIssuedDate:"",idExpiryDate:"",loanOfficerId:"",branchId:"",loanType:"individual",groupId:"",nextKinName:"",nextKinPhone:"",regDate:C()});n.useEffect(()=>{(async()=>{try{const[s,r]=await Promise.all([u.get("/branches"),u.get("/users",{params:{role:"loan_officer"}}).catch(()=>({data:[]}))]);h(Array.isArray(s.data)?s.data:[]),p(Array.isArray(r.data)?r.data:[])}catch(s){console.warn("Failed to fetch branches/officers",s),h([]),p([])}})()},[]);const _=s=>{var o;const r=(o=s.target.files)==null?void 0:o[0];if(!r)return;j(r);const i=new FileReader;i.onload=()=>y(i.result),i.readAsDataURL(r)},E=()=>{j(null),y(null),m.current&&(m.current.value="")},L=()=>!a.firstName.trim()||!a.lastName.trim()?(alert("First & last name are required"),!1):a.phone.trim()?a.gender?a.branchId?!0:(alert("Branch is required"),!1):(alert("Gender is required"),!1):(alert("Primary phone is required"),!1),B=async s=>{var r;if(s.preventDefault(),!!L()){v(!0);try{const i=new FormData,o={name:`${a.firstName} ${a.lastName}`.trim(),firstName:a.firstName,lastName:a.lastName,phone:a.phone,secondaryPhone:a.secondaryPhone,email:a.email,occupation:a.occupation,gender:a.gender,birthDate:a.birthDate||null,addressLine:a.addressLine,city:a.city,district:a.district,ward:a.ward,street:a.street,houseNumber:a.houseNumber,employmentStatus:a.employmentStatus,idType:a.idType,idNumber:a.idNumber,idIssuedDate:a.idIssuedDate||null,idExpiryDate:a.idExpiryDate||null,loanOfficerId:a.loanOfficerId||null,branchId:a.branchId,loanType:a.loanType,groupId:a.loanType==="group"&&a.groupId||null,nextKinName:a.nextKinName,nextKinPhone:a.nextKinPhone,regDate:a.regDate||C()};Object.entries(o).forEach(([K,q])=>i.append(K,q??"")),x&&i.append("photo",x);const F=await u.post("/borrowers",i,{headers:{"Content-Type":"multipart/form-data"}});alert("Borrower saved successfully"),I(`/borrowers/${((r=F.data)==null?void 0:r.id)||""}`)}catch(i){console.error(i),alert("Failed to save borrower")}finally{v(!1)}}};return e.jsxs("div",{className:"p-4 md:p-6 lg:p-8",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:"Add Borrower"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Capture full KYC & assign the borrower to a branch/officer."})]}),e.jsx(b,{to:"/borrowers",className:"text-indigo-600 hover:underline text-sm",children:"Back to Borrowers"})]}),e.jsxs("form",{onSubmit:B,className:"grid grid-cols-1 xl:grid-cols-3 gap-6 relative",children:[e.jsxs("div",{className:"xl:col-span-2 space-y-6",children:[e.jsxs("section",{className:c,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(W,{className:"h-5 w-5 text-indigo-600"}),e.jsx("h2",{className:"font-semibold text-lg",children:"Profile Photo"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-28 h-28 rounded-2xl bg-gray-100 overflow-hidden ring-1 ring-black/5 flex items-center justify-center",children:N?e.jsx("img",{src:N,alt:"Profile photo preview",className:"w-full h-full object-cover"}):e.jsx(w,{className:"h-10 w-10 text-gray-400"})}),e.jsxs("div",{className:"space-x-2",children:[e.jsxs("label",{className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg border bg-white hover:bg-gray-50 cursor-pointer",children:[e.jsx(A,{className:"h-4 w-4"}),e.jsx("span",{children:"Upload"}),e.jsx("input",{ref:m,type:"file",accept:"image/*",className:"hidden",onChange:_})]}),x&&e.jsxs("button",{type:"button",onClick:E,className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg border hover:bg-gray-50",children:[e.jsx($,{className:"h-4 w-4"}),"Remove"]})]})]})]}),e.jsxs("section",{className:c,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(w,{className:"h-5 w-5 text-indigo-600"}),e.jsx("h2",{className:"font-semibold text-lg",children:"Identity"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"First Name"}),e.jsx("input",{className:t,value:a.firstName,onChange:s=>l({...a,firstName:s.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Last Name"}),e.jsx("input",{className:t,value:a.lastName,onChange:s=>l({...a,lastName:s.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs text-gray-600 flex items-center gap-1",children:[e.jsx(R,{className:"h-3.5 w-3.5"})," Phone"]}),e.jsx("input",{className:t,value:a.phone,onChange:s=>l({...a,phone:s.target.value}),placeholder:"e.g. +2557…",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Secondary #"}),e.jsx("input",{className:t,value:a.secondaryPhone,onChange:s=>l({...a,secondaryPhone:s.target.value}),placeholder:"Optional"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Email"}),e.jsx("input",{type:"email",className:t,value:a.email,onChange:s=>l({...a,email:s.target.value}),placeholder:"name@email.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Business / Occupation"}),e.jsx("input",{className:t,value:a.occupation,onChange:s=>l({...a,occupation:s.target.value}),placeholder:"e.g. Retail shop"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Gender"}),e.jsxs("select",{className:t,value:a.gender,onChange:s=>l({...a,gender:s.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select…"}),D.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs text-gray-600 flex items-center gap-1",children:[e.jsx(f,{className:"h-3.5 w-3.5"})," Birth date"]}),e.jsx("input",{type:"date",className:t,value:a.birthDate,onChange:s=>l({...a,birthDate:s.target.value})})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Employment / Working Status"}),e.jsxs("select",{className:t,value:a.employmentStatus,onChange:s=>l({...a,employmentStatus:s.target.value}),children:[e.jsx("option",{value:"",children:"Select…"}),P.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]})]})]})]}),e.jsxs("section",{className:c,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Y,{className:"h-5 w-5 text-indigo-600"}),e.jsx("h2",{className:"font-semibold text-lg",children:"Address"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Address Line"}),e.jsx("input",{className:t,value:a.addressLine,onChange:s=>l({...a,addressLine:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"City"}),e.jsx("input",{className:t,value:a.city,onChange:s=>l({...a,city:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"District"}),e.jsx("input",{className:t,value:a.district,onChange:s=>l({...a,district:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Ward"}),e.jsx("input",{className:t,value:a.ward,onChange:s=>l({...a,ward:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Street"}),e.jsx("input",{className:t,value:a.street,onChange:s=>l({...a,street:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"House #"}),e.jsx("input",{className:t,value:a.houseNumber,onChange:s=>l({...a,houseNumber:s.target.value})})]})]})]}),e.jsxs("section",{className:c,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(U,{className:"h-5 w-5 text-indigo-600"}),e.jsx("h2",{className:"font-semibold text-lg",children:"ID Document"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"ID Type"}),e.jsxs("select",{className:t,value:a.idType,onChange:s=>l({...a,idType:s.target.value}),children:[e.jsx("option",{value:"",children:"Select…"}),S.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"ID Number"}),e.jsx("input",{className:t,value:a.idNumber,onChange:s=>l({...a,idNumber:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Issued on"}),e.jsx("input",{type:"date",className:t,value:a.idIssuedDate,onChange:s=>l({...a,idIssuedDate:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Expiry date"}),e.jsx("input",{type:"date",className:t,value:a.idExpiryDate,onChange:s=>l({...a,idExpiryDate:s.target.value})})]})]})]}),e.jsxs("section",{className:c,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(z,{className:"h-5 w-5 text-indigo-600"}),e.jsx("h2",{className:"font-semibold text-lg",children:"Next of Kin"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Full Name"}),e.jsx("input",{className:t,value:a.nextKinName,onChange:s=>l({...a,nextKinName:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Phone"}),e.jsx("input",{className:t,value:a.nextKinPhone,onChange:s=>l({...a,nextKinPhone:s.target.value})})]})]})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs("section",{className:c,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(H,{className:"h-5 w-5 text-indigo-600"}),e.jsx("h2",{className:"font-semibold text-lg",children:"Assignment & Loan Type"})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Branch"}),e.jsxs("select",{className:t,value:a.branchId,onChange:s=>l({...a,branchId:s.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select branch…"}),O.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Loan Officer"}),e.jsxs("select",{className:t,value:a.loanOfficerId,onChange:s=>l({...a,loanOfficerId:s.target.value}),children:[e.jsx("option",{value:"",children:"Select officer… (optional)"}),T.map(s=>e.jsx("option",{value:s.id,children:s.name||`${s.firstName||""} ${s.lastName||""}`},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Loan Type"}),e.jsx("select",{className:t,value:a.loanType,onChange:s=>l({...a,loanType:s.target.value}),children:k.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),a.loanType==="group"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Group ID"}),e.jsx("input",{className:t,value:a.groupId,onChange:s=>l({...a,groupId:s.target.value}),placeholder:"Enter group identifier"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs text-gray-600 flex items-center gap-1",children:[e.jsx(f,{className:"h-3.5 w-3.5"})," Registration Date"]}),e.jsx("input",{type:"date",className:t,value:a.regDate,onChange:s=>l({...a,regDate:s.target.value})})]})]})]})}),e.jsx("div",{className:"col-span-full",children:e.jsx("div",{className:"sticky bottom-0 inset-x-0 z-20 bg-white/90 backdrop-blur supports-[backdrop-filter]:bg-white/70 border-t",children:e.jsxs("div",{className:"max-w-screen-2xl mx-auto px-4 py-3 flex justify-end gap-3",children:[e.jsx(b,{to:"/borrowers",className:"px-4 py-2 rounded-xl border hover:bg-gray-50",children:"Cancel"}),e.jsxs("button",{disabled:g,type:"submit",className:"inline-flex items-center gap-2 px-4 py-2 rounded-xl bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-60 disabled:cursor-not-allowed shadow-sm",children:[e.jsx(Q,{className:"h-4 w-4"}),g?"Saving…":"Save"]})]})})})]})]})}export{te as default};
