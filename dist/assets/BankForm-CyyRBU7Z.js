import{i as p,u as v,r as i,j as e,L as x}from"./index-BVWWaTks.js";import{a as b,u as N,c as j}from"./banking-B3wjaife.js";import{S as y}from"./save-By_dQFro.js";import"./createLucideIcon-Cwi7q87I.js";const f="bg-white rounded-2xl shadow-sm ring-1 ring-black/5 p-5 md:p-7",l="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500/40 focus:border-indigo-500 transition-all";function A(){const{id:r}=p(),c=!!r,m=v(),[a,t]=i.useState({name:"",code:"",branch:"",accountName:"",accountNumber:"",swift:"",phone:"",address:"",currency:"TZS",openingBalance:"",currentBalance:"",isActive:!0}),[o,d]=i.useState(!1),[g,u]=i.useState(c);i.useEffect(()=>{if(!c)return;const n=new AbortController;return(async()=>{u(!0);try{const s=await b(r,{signal:n.signal});t({name:s.name||"",code:s.code||"",branch:s.branch||"",accountName:s.accountName||"",accountNumber:s.accountNumber||"",swift:s.swift||"",phone:s.phone||"",address:s.address||"",currency:s.currency||"TZS",openingBalance:s.openingBalance??"",currentBalance:s.currentBalance??"",isActive:s.isActive!==!1})}catch(s){(s==null?void 0:s.code)!=="ERR_CANCELED"&&(console.error(s),alert((s==null?void 0:s.normalizedMessage)||"Failed to load bank"))}finally{u(!1)}})(),()=>n.abort()},[r,c]);const h=async n=>{if(n.preventDefault(),!a.name.trim())return alert("Bank name is required.");d(!0);try{const s={...a,openingBalance:a.openingBalance===""?c?null:0:Number(a.openingBalance),currentBalance:a.currentBalance===""?c?null:a.openingBalance===""?0:Number(a.openingBalance):Number(a.currentBalance)};c?await N(r,s):await j(s),m("/banks")}catch(s){console.error(s),alert((s==null?void 0:s.normalizedMessage)||"Failed to save bank")}finally{d(!1)}};return e.jsxs("div",{className:"p-4 md:p-6 lg:p-8",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:c?"Edit Bank":"Add Bank"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Banks are used for disbursing loans and receiving repayments."})]}),e.jsx(x,{to:"/banks",className:"text-indigo-600 hover:underline text-sm",children:"Back to Banks"})]}),e.jsx("form",{onSubmit:h,className:f,children:g?e.jsx("p",{className:"text-sm text-gray-500",children:"Loading…"}):e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Name"}),e.jsx("input",{className:l,value:a.name,onChange:n=>t({...a,name:n.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Code (optional)"}),e.jsx("input",{className:l,value:a.code,onChange:n=>t({...a,code:n.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Branch (optional)"}),e.jsx("input",{className:l,value:a.branch,onChange:n=>t({...a,branch:n.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Account Name (optional)"}),e.jsx("input",{className:l,value:a.accountName,onChange:n=>t({...a,accountName:n.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Account Number (optional)"}),e.jsx("input",{className:l,value:a.accountNumber,onChange:n=>t({...a,accountNumber:n.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"SWIFT (optional)"}),e.jsx("input",{className:l,value:a.swift,onChange:n=>t({...a,swift:n.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Phone (optional)"}),e.jsx("input",{className:l,value:a.phone,onChange:n=>t({...a,phone:n.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Currency"}),e.jsx("input",{className:l,value:a.currency,onChange:n=>t({...a,currency:n.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Opening Balance"}),e.jsx("input",{type:"number",step:"0.01",className:l,value:a.openingBalance,onChange:n=>t({...a,openingBalance:n.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Current Balance (optional)"}),e.jsx("input",{type:"number",step:"0.01",className:l,value:a.currentBalance,onChange:n=>t({...a,currentBalance:n.target.value})})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Address (optional)"}),e.jsx("textarea",{className:`${l} min-h-[84px]`,value:a.address,onChange:n=>t({...a,address:n.target.value})})]}),e.jsxs("div",{className:"md:col-span-2 flex items-center gap-2",children:[e.jsx("input",{id:"active",type:"checkbox",checked:a.isActive,onChange:n=>t({...a,isActive:n.target.checked})}),e.jsx("label",{htmlFor:"active",className:"text-sm text-gray-700",children:"Active"})]}),e.jsxs("div",{className:"md:col-span-2 flex justify-end gap-3 pt-2",children:[e.jsx(x,{to:"/banks",className:"px-4 py-2 rounded-xl border hover:bg-gray-50",children:"Cancel"}),e.jsxs("button",{disabled:o,type:"submit",className:"inline-flex items-center gap-2 px-4 py-2 rounded-xl bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-60 disabled:cursor-not-allowed shadow-sm",children:[e.jsx(y,{className:"h-4 w-4"}),o?"Saving…":"Save"]})]})]})})]})}export{A as default};
