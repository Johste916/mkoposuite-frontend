import{r as s}from"./index-uOcrLdeq.js";function k(l,S,n={}){const[d,c]=s.useState(()=>({...n})),[g,i]=s.useState(!0),[m,v]=s.useState(!1),[b,u]=s.useState(""),[j,p]=s.useState(""),a=s.useRef(!0),y=t=>t==null?{}:typeof t=="object"&&"value"in t?t.value??{}:typeof t=="object"&&"data"in t?t.data??{}:t;return s.useEffect(()=>(a.current=!0,(async()=>{var t,o;i(!0),u("");try{const r=await l();if(!a.current)return;const e=y(r);c({...n,...e&&typeof e=="object"?e:{}})}catch(r){if(!a.current)return;u(((o=(t=r==null?void 0:r.response)==null?void 0:t.data)==null?void 0:o.error)||r.message||"Failed to load"),c({...n})}finally{a.current&&i(!1)}})(),()=>{a.current=!1}),[l]),{data:d,setData:c,loading:g,saving:m,error:b,success:j,save:async t=>{var o,r;v(!0),u(""),p("");try{const e=t??d,w=await S(e),f=y(w);return c({...n,...f&&typeof f=="object"?f:e}),p("Saved."),{ok:!0}}catch(e){return u(((r=(o=e==null?void 0:e.response)==null?void 0:o.data)==null?void 0:r.error)||e.message||"Failed to save"),{ok:!1,error:e}}finally{v(!1)}}}}export{k as u};
