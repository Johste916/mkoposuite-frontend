import{r,j as e}from"./index-BjuKJokO.js";import{S as y}from"./settings-B6wCwPWK.js";import"./index-UcOextMV.js";function R(){const[m,n]=r.useState([]),[f,u]=r.useState(!0),[b,j]=r.useState(!1),[N,c]=r.useState(""),[g,x]=r.useState(""),[l,o]=r.useState({date:"",name:"",branchId:""}),v=async()=>{var s,t;c(""),x(""),u(!0);try{const a=await y.getHolidaySettings(),p=(Array.isArray(a)?a:Array.isArray(a==null?void 0:a.holidays)?a.holidays:[]).map(i=>({date:i.date||"",name:i.name||"",...i.branchId?{branchId:i.branchId}:{}}));n(p)}catch(a){c(((t=(s=a==null?void 0:a.response)==null?void 0:s.data)==null?void 0:t.error)||a.message)}finally{u(!1)}};r.useEffect(()=>{v()},[]);const w=()=>{!l.date||!l.name||(n(s=>[...s,{date:l.date,name:l.name,...l.branchId?{branchId:l.branchId}:{}}]),o({date:"",name:"",branchId:""}))},h=(s,t)=>{n(a=>a.map((d,p)=>p===s?{...d,...t}:d))},S=s=>{n(t=>t.filter((a,d)=>d!==s))},I=async()=>{var s,t;j(!0),c(""),x("");try{await y.saveHolidaySettings(m),x("Saved.")}catch(a){c(((t=(s=a==null?void 0:a.response)==null?void 0:s.data)==null?void 0:t.error)||a.message)}finally{j(!1)}};return f?e.jsx("div",{className:"p-4 text-sm text-slate-500",children:"Loading…"}):e.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-6 shadow-sm space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Holiday Settings"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:v,className:"px-3 py-2 border rounded bg-white",children:"Reload"}),e.jsx("button",{onClick:I,disabled:b,className:"px-3 py-2 border rounded bg-blue-600 text-white",children:b?"Saving…":"Save"})]})]}),N&&e.jsx("div",{className:"text-sm text-rose-600",children:N}),g&&e.jsx("div",{className:"text-sm text-emerald-600",children:g}),e.jsxs("div",{className:"grid md:grid-cols-4 gap-2 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs",children:"Date"}),e.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1 text-sm",value:l.date,onChange:s=>o(t=>({...t,date:s.target.value}))})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs",children:"Name"}),e.jsx("input",{className:"w-full border rounded px-2 py-1 text-sm",placeholder:"Christmas",value:l.name,onChange:s=>o(t=>({...t,name:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs",children:"Branch (optional)"}),e.jsx("input",{className:"w-full border rounded px-2 py-1 text-sm",placeholder:"branch UUID or code",value:l.branchId,onChange:s=>o(t=>({...t,branchId:s.target.value}))})]}),e.jsx("div",{children:e.jsx("button",{onClick:w,className:"px-3 py-2 border rounded bg-white",children:"Add"})})]}),e.jsx("div",{className:"overflow-x-auto border rounded-xl",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"p-2 text-left",children:"Date"}),e.jsx("th",{className:"p-2 text-left",children:"Name"}),e.jsx("th",{className:"p-2 text-left",children:"Branch"}),e.jsx("th",{className:"p-2"})]})}),e.jsx("tbody",{children:m.length===0?e.jsx("tr",{children:e.jsx("td",{className:"p-3",colSpan:4,children:"No holidays"})}):m.map((s,t)=>e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:s.date,onChange:a=>h(t,{date:a.target.value})})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{className:"w-full border rounded px-2 py-1",value:s.name,onChange:a=>h(t,{name:a.target.value})})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{className:"w-full border rounded px-2 py-1",placeholder:"optional",value:s.branchId||"",onChange:a=>h(t,{branchId:a.target.value})})}),e.jsx("td",{className:"p-2 text-right",children:e.jsx("button",{className:"px-2 py-1 text-xs border rounded",onClick:()=>S(t),children:"Remove"})})]},`${s.date}-${t}`))})]})})]})}export{R as default};
