import{r as c,j as e,b as r}from"./index-R5OskUTB.js";function v(){var u;const[p,h]=c.useState([]),[a,l]=c.useState(null),[d,x]=c.useState(""),[m,o]=c.useState("");async function i(){var s,t;o("");try{const n=await r.get("/admin/tenants",{params:{q:d}});h(n.data||[])}catch(n){o(((t=(s=n==null?void 0:n.response)==null?void 0:s.data)==null?void 0:t.error)||n.message)}}c.useEffect(()=>{i()},[]);async function j(s){const t=await r.get(`/admin/tenants/${s}`);l(t.data)}async function b(){await r.patch(`/admin/tenants/${a.id}`,{name:a.name,status:a.status,plan_code:a.plan_code,trial_ends_at:a.trial_ends_at,grace_days:a.grace_days,billing_email:a.billing_email,auto_disable_overdue:a.auto_disable_overdue}),await i(),l(null)}return e.jsxs("div",{className:"ms-card p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Admin · Tenants"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{value:d,onChange:s=>x(s.target.value),placeholder:"Search…",className:"ms-input"}),e.jsx("button",{onClick:i,className:"ms-btn",children:"Search"})]})]}),m&&e.jsxs("div",{className:"text-rose-600 text-sm",children:["Error: ",m]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"text-left text-slate-500",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 pr-4",children:"Name"}),e.jsx("th",{className:"py-2 pr-4",children:"Plan"}),e.jsx("th",{className:"py-2 pr-4",children:"Status"}),e.jsx("th",{className:"py-2 pr-4",children:"Trial ends"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:p.map(s=>{var t;return e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"py-2 pr-4",children:s.name}),e.jsx("td",{className:"py-2 pr-4",children:s.plan_code}),e.jsx("td",{className:"py-2 pr-4",children:s.status}),e.jsx("td",{className:"py-2 pr-4",children:((t=s.trial_ends_at)==null?void 0:t.slice(0,10))||"-"}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx("button",{className:"ms-btn",onClick:()=>j(s.id),children:"Edit"})})]},s.id)})})]})}),a&&e.jsxs("div",{className:"border-t pt-3 space-y-2",children:[e.jsxs("h3",{className:"font-semibold",children:["Edit ",a.name]}),e.jsxs("div",{className:"grid sm:grid-cols-2 gap-3 text-sm",children:[e.jsxs("label",{className:"block",children:["Name",e.jsx("input",{className:"ms-input",value:a.name||"",onChange:s=>l({...a,name:s.target.value})})]}),e.jsxs("label",{className:"block",children:["Plan",e.jsxs("select",{className:"ms-input",value:a.plan_code||"basic",onChange:s=>l({...a,plan_code:s.target.value}),children:[e.jsx("option",{value:"basic",children:"basic"}),e.jsx("option",{value:"pro",children:"pro"}),e.jsx("option",{value:"premium",children:"premium"})]})]}),e.jsxs("label",{className:"block",children:["Status",e.jsxs("select",{className:"ms-input",value:a.status||"active",onChange:s=>l({...a,status:s.target.value}),children:[e.jsx("option",{value:"active",children:"active"}),e.jsx("option",{value:"trial",children:"trial"}),e.jsx("option",{value:"suspended",children:"suspended"}),e.jsx("option",{value:"cancelled",children:"cancelled"})]})]}),e.jsxs("label",{className:"block",children:["Trial ends",e.jsx("input",{type:"date",className:"ms-input",value:((u=a.trial_ends_at)==null?void 0:u.slice(0,10))||"",onChange:s=>l({...a,trial_ends_at:s.target.value})})]}),e.jsxs("label",{className:"block",children:["Grace days",e.jsx("input",{type:"number",className:"ms-input",value:a.grace_days??7,onChange:s=>l({...a,grace_days:Number(s.target.value||0)})})]}),e.jsxs("label",{className:"block",children:["Billing email",e.jsx("input",{className:"ms-input",value:a.billing_email||"",onChange:s=>l({...a,billing_email:s.target.value})})]}),e.jsxs("label",{className:"flex items-center gap-2 col-span-full",children:[e.jsx("input",{type:"checkbox",checked:!!a.auto_disable_overdue,onChange:s=>l({...a,auto_disable_overdue:s.target.checked})}),e.jsx("span",{children:"Auto suspend overdue"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"ms-btn",onClick:()=>l(null),children:"Cancel"}),e.jsx("button",{className:"ms-btn-primary",onClick:b,children:"Save"})]})]})]})}export{v as default};
