import{r as l,c as v,j as e}from"./index-BRummDuu.js";function M({url:a,params:r={},initialPage:x=1,initialLimit:i=20}){const[d,c]=l.useState(x),[s,g]=l.useState(i),[m,b]=l.useState(r.q||""),[f,u]=l.useState(!0),[h,t]=l.useState(""),[o,S]=l.useState([]),[k,w]=l.useState(0),N=l.useMemo(()=>({...r,page:d,limit:s,q:m||void 0}),[r,d,s,m]);return l.useEffect(()=>{let y=!1;return u(!0),t(""),v.get(a,{params:N}).then(n=>{if(y)return;const{data:p=[],pagination:j={}}=n.data||{};S(Array.isArray(p)?p:n.data||[]),w(j.total??(Array.isArray(n.data)?n.data.length:0))}).catch(n=>{var p,j;return!y&&t(((j=(p=n==null?void 0:n.response)==null?void 0:p.data)==null?void 0:j.error)||n.message)}).finally(()=>!y&&u(!1)),()=>{y=!0}},[a,JSON.stringify(N)]),{rows:o,total:k,page:d,setPage:c,limit:s,setLimit:g,q:m,setQ:b,loading:f,error:h,refresh:()=>v.get(a,{params:N})}}function E({page:a,setPage:r,limit:x,setLimit:i,total:d}){const c=Math.max(1,Math.ceil((d||0)/(x||20)));return e.jsxs("div",{className:"flex items-center justify-between gap-3 mt-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"Rows:"}),e.jsx("select",{className:"border rounded px-2 py-1",value:x,onChange:s=>{r(1),i(parseInt(s.target.value,10))},children:[10,20,50,100].map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"px-3 py-1 border rounded disabled:opacity-50",onClick:()=>r(Math.max(1,a-1)),disabled:a<=1,children:"Prev"}),e.jsxs("span",{children:["Page ",a," / ",c]}),e.jsx("button",{className:"px-3 py-1 border rounded disabled:opacity-50",onClick:()=>r(Math.min(c,a+1)),disabled:a>=c,children:"Next"})]})]})}function q({title:a,q:r,setQ:x,columns:i=[],rows:d=[],loading:c,error:s,page:g,setPage:m,limit:b,setLimit:f,total:u,renderActions:h}){return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow p-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold",children:a}),e.jsx("input",{value:r,onChange:t=>x(t.target.value),placeholder:"Search…",className:"px-3 py-2 border rounded w-60 dark:bg-gray-700"})]}),s&&e.jsxs("div",{className:"text-red-500 text-sm mb-3",children:["Error: ",s]}),c?e.jsx("div",{className:"py-10 text-center text-sm opacity-70",children:"Loading…"}):e.jsx("div",{className:"overflow-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left border-b dark:border-gray-700",children:[i.map(t=>e.jsx("th",{className:"px-3 py-2",children:t.title},t.key)),h&&e.jsx("th",{className:"px-3 py-2",children:"Actions"})]})}),e.jsx("tbody",{children:d.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:i.length+(h?1:0),className:"px-3 py-10 text-center opacity-70",children:"No data"})}):d.map(t=>e.jsxs("tr",{className:"border-b last:border-0 dark:border-gray-700",children:[i.map(o=>e.jsx("td",{className:"px-3 py-2",children:typeof o.render=="function"?o.render(t[o.key],t):String(t[o.key]??"—")},o.key)),h&&e.jsx("td",{className:"px-3 py-2",children:h(t)})]},t.id??JSON.stringify(t)))})]})}),e.jsx(E,{page:g,setPage:m,limit:b,setLimit:f,total:u})]})}export{q as L,M as u};
