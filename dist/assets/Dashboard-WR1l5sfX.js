import{r as c,g as tt,j as r,L as pe}from"./index-CPMSpXx6.js";import{D as Ke}from"./download-QZXiCHJ4.js";import{C as Ne}from"./circle-plus-CH8qGJKL.js";import{c as G}from"./createLucideIcon-Bz0W3pCZ.js";import{i as Fe,S as At,a as ye,r as Nt,u as at,R as St,b as Pt,c as It,d as Ot,g as Ct,e as rt,f as Bt,h as Et,j as Dt,k as xe,l as Lt,G as _t,C as Rt,m as nt,n as Tt,L as ve,o as Mt,p as $t,t as Kt,q as ze,s as st,v as it,w as ot,x as lt,y as Ft,z as ct,A as zt,J as Wt,B as X,D as Gt,E as Vt,F as Ut,H as qt,I as We,K as W,M as Xt,N as J,O as Q,P as te,Q as Ht,T as dt,U as ut,V as mt,W as Zt,X as Yt,Y as Ge,Z as Jt,_ as Qt,$ as Ve,a0 as ea,a1 as _e,a2 as Ue,a3 as ta,a4 as aa,a5 as Se,a6 as Pe,a7 as Ie,a8 as Oe,a9 as Ce,aa as Be}from"./CartesianChart-DIJtCfbD.js";import{C as ra}from"./chevron-down-BTCf4gQ8.js";/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]],qe=G("chart-no-axes-column",na);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],ia=G("clipboard-list",sa);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Ee=G("credit-card",oa);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const la=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],H=G("dollar-sign",la);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]],da=G("thumbs-down",ca);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Xe=G("triangle-alert",ua);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ha=G("users",ma);var fa="Invariant failed";function pa(t,e){throw new Error(fa)}var xa=["x","y"];function Re(){return Re=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)({}).hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},Re.apply(null,arguments)}function He(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),a.push.apply(a,n)}return a}function oe(t){for(var e=1;e<arguments.length;e++){var a=arguments[e]!=null?arguments[e]:{};e%2?He(Object(a),!0).forEach(function(n){va(t,n,a[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):He(Object(a)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(a,n))})}return t}function va(t,e,a){return(e=ga(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function ga(t){var e=ya(t,"string");return typeof e=="symbol"?e:e+""}function ya(t,e){if(typeof t!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var n=a.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ba(t,e){if(t==null)return{};var a,n,o=ja(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)a=s[n],e.indexOf(a)===-1&&{}.propertyIsEnumerable.call(t,a)&&(o[a]=t[a])}return o}function ja(t,e){if(t==null)return{};var a={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;a[n]=t[n]}return a}function wa(t,e){var{x:a,y:n}=t,o=ba(t,xa),s="".concat(a),d=parseInt(s,10),u="".concat(n),v=parseInt(u,10),h="".concat(e.height||o.height),f=parseInt(h,10),p="".concat(e.width||o.width),g=parseInt(p,10);return oe(oe(oe(oe(oe({},e),o),d?{x:d}:{}),v?{y:v}:{}),{},{height:f,width:g,name:e.name,radius:e.radius})}function ht(t){return c.createElement(At,Re({shapeType:"rectangle",propTransformer:wa,activeClassName:"recharts-active-bar"},t))}var ka=function(e){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,o)=>{if(Fe(e))return e;var s=Fe(n)||ye(n);return s?e(n,o):(s||pa(),a)}},Aa=["onMouseEnter","onMouseLeave","onClick"],Na=["value","background","tooltipPosition"],Sa=["id"],Pa=["onMouseEnter","onClick","onMouseLeave"];function ee(){return ee=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)({}).hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},ee.apply(null,arguments)}function Ze(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),a.push.apply(a,n)}return a}function L(t){for(var e=1;e<arguments.length;e++){var a=arguments[e]!=null?arguments[e]:{};e%2?Ze(Object(a),!0).forEach(function(n){Ia(t,n,a[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):Ze(Object(a)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(a,n))})}return t}function Ia(t,e,a){return(e=Oa(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function Oa(t){var e=Ca(t,"string");return typeof e=="symbol"?e:e+""}function Ca(t,e){if(typeof t!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var n=a.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ge(t,e){if(t==null)return{};var a,n,o=Ba(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)a=s[n],e.indexOf(a)===-1&&{}.propertyIsEnumerable.call(t,a)&&(o[a]=t[a])}return o}function Ba(t,e){if(t==null)return{};var a={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;a[n]=t[n]}return a}var Ea=t=>{var{dataKey:e,name:a,fill:n,legendType:o,hide:s}=t;return[{inactive:s,dataKey:e,type:o,color:n,value:rt(a,e),payload:t}]};function Da(t){var{dataKey:e,stroke:a,strokeWidth:n,fill:o,name:s,hide:d,unit:u}=t;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:a,strokeWidth:n,fill:o,dataKey:e,nameKey:void 0,name:rt(s,e),hide:d,type:t.tooltipType,color:t.fill,unit:u}}}function La(t){var e=xe(st),{data:a,dataKey:n,background:o,allOtherBarProps:s}=t,{onMouseEnter:d,onMouseLeave:u,onClick:v}=s,h=ge(s,Aa),f=it(d,n),p=ot(u),g=lt(v,n);if(!o||a==null)return null;var x=Ft(o,!1);return c.createElement(c.Fragment,null,a.map((A,j)=>{var{value:I,background:b,tooltipPosition:w}=A,m=ge(A,Na);if(!b)return null;var P=f(A,j),k=p(A,j),C=g(A,j),B=L(L(L(L(L({option:o,isActive:String(j)===e},m),{},{fill:"#eee"},b),x),ct(h,A,j)),{},{onMouseEnter:P,onMouseLeave:k,onClick:C,dataKey:n,index:j,className:"recharts-bar-background-rectangle"});return c.createElement(ht,ee({key:"background-bar-".concat(j)},B))}))}function ft(t){var{data:e,props:a,showLabels:n}=t,o=Gt(a),{id:s}=o,d=ge(o,Sa),{shape:u,dataKey:v,activeBar:h}=a,f=xe(st),p=xe(Vt),{onMouseEnter:g,onClick:x,onMouseLeave:A}=a,j=ge(a,Pa),I=it(g,v),b=ot(A),w=lt(x,v);return e?c.createElement(c.Fragment,null,e.map((m,P)=>{var k=h&&String(P)===f&&(p==null||v===p),C=k?h:u,B=L(L(L({},d),m),{},{isActive:k,option:C,index:P,dataKey:v});return c.createElement(ve,ee({className:"recharts-bar-rectangle"},ct(j,m,P),{onMouseEnter:I(m,P),onMouseLeave:b(m,P),onClick:w(m,P),key:"rectangle-".concat(m==null?void 0:m.x,"-").concat(m==null?void 0:m.y,"-").concat(m==null?void 0:m.value,"-").concat(P)}),c.createElement(ht,B))}),n&&Ut.renderCallByParent(a,e)):null}function _a(t){var{props:e,previousRectanglesRef:a}=t,{data:n,layout:o,isAnimationActive:s,animationBegin:d,animationDuration:u,animationEasing:v,onAnimationEnd:h,onAnimationStart:f}=e,p=a.current,g=zt(e,"recharts-bar-"),[x,A]=c.useState(!1),j=c.useCallback(()=>{typeof h=="function"&&h(),A(!1)},[h]),I=c.useCallback(()=>{typeof f=="function"&&f(),A(!0)},[f]);return c.createElement(Wt,{begin:d,duration:u,isActive:s,easing:v,onAnimationEnd:j,onAnimationStart:I,key:g},b=>{var w=b===1?n:n==null?void 0:n.map((m,P)=>{var k=p&&p[P];if(k)return L(L({},m),{},{x:X(k.x,m.x,b),y:X(k.y,m.y,b),width:X(k.width,m.width,b),height:X(k.height,m.height,b)});if(o==="horizontal"){var C=X(0,m.height,b);return L(L({},m),{},{y:m.y+m.height-C,height:C})}var B=X(0,m.width,b);return L(L({},m),{},{width:B})});return b>0&&(a.current=w??null),w==null?null:c.createElement(ve,null,c.createElement(ft,{props:e,data:w,showLabels:!x}))})}function Ra(t){var{data:e,isAnimationActive:a}=t,n=c.useRef(null);return a&&e&&e.length&&(n.current==null||n.current!==e)?c.createElement(_a,{previousRectanglesRef:n,props:t}):c.createElement(ft,{props:t,data:e,showLabels:!0})}var pt=0,Ta=(t,e)=>{var a=Array.isArray(t.value)?t.value[1]:t.value;return{x:t.x,y:t.y,value:a,errorVal:nt(t,e)}};class Ma extends c.PureComponent{render(){var{hide:e,data:a,dataKey:n,className:o,xAxisId:s,yAxisId:d,needClip:u,background:v,id:h}=this.props;if(e)return null;var f=Tt("recharts-bar",o),p=h;return c.createElement(ve,{className:f,id:h},u&&c.createElement("defs",null,c.createElement(Mt,{clipPathId:p,xAxisId:s,yAxisId:d})),c.createElement(ve,{className:"recharts-bar-rectangles",clipPath:u?"url(#clipPath-".concat(p,")"):void 0},c.createElement(La,{data:a,dataKey:n,background:v,allOtherBarProps:this.props}),c.createElement(Ra,this.props)),this.props.children)}}var $a={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!_t.isSsr,legendType:"rect",minPointSize:pt,xAxisId:0,yAxisId:0};function Ka(t){var{xAxisId:e,yAxisId:a,hide:n,legendType:o,minPointSize:s,activeBar:d,animationBegin:u,animationDuration:v,animationEasing:h,isAnimationActive:f}=t,{needClip:p}=Bt(e,a),g=Et(),x=at(),A=Dt(t.children,Rt),j=xe(w=>hr(w,e,a,x,t.id,A));if(g!=="vertical"&&g!=="horizontal")return null;var I,b=j==null?void 0:j[0];return b==null||b.height==null||b.width==null?I=0:I=g==="vertical"?b.height/2:b.width/2,c.createElement(Lt,{xAxisId:e,yAxisId:a,data:j,dataPointFormatter:Ta,errorBarOffset:I},c.createElement(Ma,ee({},t,{layout:g,needClip:p,data:j,xAxisId:e,yAxisId:a,hide:n,legendType:o,minPointSize:s,activeBar:d,animationBegin:u,animationDuration:v,animationEasing:h,isAnimationActive:f})))}function Fa(t){var{layout:e,barSettings:{dataKey:a,minPointSize:n},pos:o,bandSize:s,xAxis:d,yAxis:u,xAxisTicks:v,yAxisTicks:h,stackedData:f,displayedData:p,offset:g,cells:x}=t,A=e==="horizontal"?u:d,j=f?A.scale.domain():null,I=$t({numericAxis:A});return p.map((b,w)=>{var m,P,k,C,B,V;f?m=Kt(f[w],j):(m=nt(b,a),Array.isArray(m)||(m=[I,m]));var O=ka(n,pt)(m[1],w);if(e==="horizontal"){var ae,[re,U]=[u.scale(m[0]),u.scale(m[1])];P=ze({axis:d,ticks:v,bandSize:s,offset:o.offset,entry:b,index:w}),k=(ae=U??re)!==null&&ae!==void 0?ae:void 0,C=o.size;var ne=re-U;if(B=qt(ne)?0:ne,V={x:P,y:g.top,width:C,height:g.height},Math.abs(O)>0&&Math.abs(B)<Math.abs(O)){var de=We(B||O)*(Math.abs(O)-Math.abs(B));k-=de,B+=de}}else{var[se,be]=[d.scale(m[0]),d.scale(m[1])];if(P=se,k=ze({axis:u,ticks:h,bandSize:s,offset:o.offset,entry:b,index:w}),C=be-se,B=o.size,V={x:g.left,y:k,width:g.width,height:B},Math.abs(O)>0&&Math.abs(C)<Math.abs(O)){var ue=We(C||O)*(Math.abs(O)-Math.abs(C));C+=ue}}if(P==null||k==null||C==null||B==null)return null;var je=L(L({},b),{},{x:P,y:k,width:C,height:B,value:f?m:m[1],payload:b,background:V,tooltipPosition:{x:P+C/2,y:k+B/2}},x&&x[w]&&x[w].props);return je}).filter(Boolean)}function Y(t){var e=Nt(t,$a),a=at();return c.createElement(St,{id:e.id,type:"bar"},n=>c.createElement(c.Fragment,null,c.createElement(Pt,{legendPayload:Ea(e)}),c.createElement(It,{fn:Da,args:e}),c.createElement(Ot,{type:"bar",id:n,data:void 0,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:0,dataKey:e.dataKey,stackId:Ct(e.stackId),hide:e.hide,barSize:e.barSize,minPointSize:e.minPointSize,maxBarSize:e.maxBarSize,isPanorama:a}),c.createElement(Ka,ee({},e,{id:n}))))}Y.displayName="Bar";function Ye(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),a.push.apply(a,n)}return a}function he(t){for(var e=1;e<arguments.length;e++){var a=arguments[e]!=null?arguments[e]:{};e%2?Ye(Object(a),!0).forEach(function(n){za(t,n,a[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):Ye(Object(a)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(a,n))})}return t}function za(t,e,a){return(e=Wa(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function Wa(t){var e=Ga(t,"string");return typeof e=="symbol"?e:e+""}function Ga(t,e){if(typeof t!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var n=a.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Va=(t,e)=>e,Ua=(t,e,a)=>a,qa=(t,e,a,n)=>n,Xa=(t,e,a,n,o)=>o,ce=W([ut,Xa],(t,e)=>t.filter(a=>a.type==="bar").find(a=>a.id===e)),Ha=W([ce],t=>t==null?void 0:t.maxBarSize),Za=(t,e,a,n,o,s)=>s,Je=(t,e,a)=>{var n=a??t;if(!ye(n))return _e(n,e,0)},Ya=W([te,ut,Va,Ua,qa],(t,e,a,n,o)=>e.filter(s=>t==="horizontal"?s.xAxisId===a:s.yAxisId===n).filter(s=>s.isPanorama===o).filter(s=>s.hide===!1).filter(s=>s.type==="bar")),Ja=(t,e,a,n)=>{var o=te(t);return o==="horizontal"?Ge(t,"yAxis",a,n):Ge(t,"xAxis",e,n)},Qa=(t,e,a)=>{var n=te(t);return n==="horizontal"?Ve(t,"xAxis",e):Ve(t,"yAxis",a)},er=(t,e,a)=>{var n={},o=t.filter(ea),s=t.filter(h=>h.stackId==null),d=o.reduce((h,f)=>(h[f.stackId]||(h[f.stackId]=[]),h[f.stackId].push(f),h),n),u=Object.entries(d).map(h=>{var[f,p]=h,g=p.map(A=>A.dataKey),x=Je(e,a,p[0].barSize);return{stackId:f,dataKeys:g,barSize:x}}),v=s.map(h=>{var f=[h.dataKey].filter(g=>g!=null),p=Je(e,a,h.barSize);return{stackId:void 0,dataKeys:f,barSize:p}});return[...u,...v]},tr=W([Ya,Qt,Qa],er),ar=(t,e,a,n,o)=>{var s,d,u=ce(t,e,a,n,o);if(u!=null){var v=te(t),h=mt(t),{maxBarSize:f}=u,p=ye(f)?h:f,g,x;return v==="horizontal"?(g=J(t,"xAxis",e,n),x=Q(t,"xAxis",e,n)):(g=J(t,"yAxis",a,n),x=Q(t,"yAxis",a,n)),(s=(d=dt(g,x,!0))!==null&&d!==void 0?d:p)!==null&&s!==void 0?s:0}},xt=(t,e,a,n)=>{var o=te(t),s,d;return o==="horizontal"?(s=J(t,"xAxis",e,n),d=Q(t,"xAxis",e,n)):(s=J(t,"yAxis",a,n),d=Q(t,"yAxis",a,n)),dt(s,d)};function rr(t,e,a,n,o){var s=n.length;if(!(s<1)){var d=_e(t,a,0,!0),u,v=[];if(Ue(n[0].barSize)){var h=!1,f=a/s,p=n.reduce((b,w)=>b+(w.barSize||0),0);p+=(s-1)*d,p>=a&&(p-=(s-1)*d,d=0),p>=a&&f>0&&(h=!0,f*=.9,p=s*f);var g=(a-p)/2>>0,x={offset:g-d,size:0};u=n.reduce((b,w)=>{var m,P={stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:x.offset+x.size+d,size:h?f:(m=w.barSize)!==null&&m!==void 0?m:0}},k=[...b,P];return x=k[k.length-1].position,k},v)}else{var A=_e(e,a,0,!0);a-2*A-(s-1)*d<=0&&(d=0);var j=(a-2*A-(s-1)*d)/s;j>1&&(j>>=0);var I=Ue(o)?Math.min(j,o):j;u=n.reduce((b,w,m)=>[...b,{stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:A+(j+d)*m+(j-I)/2,size:I}}],v)}return u}}var nr=(t,e,a,n,o,s,d)=>{var u=ye(d)?e:d,v=rr(a,n,o!==s?o:s,t,u);return o!==s&&v!=null&&(v=v.map(h=>he(he({},h),{},{position:he(he({},h.position),{},{offset:h.position.offset-o/2})}))),v},sr=W([tr,mt,Zt,Yt,ar,xt,Ha],nr),ir=(t,e,a,n)=>J(t,"xAxis",e,n),or=(t,e,a,n)=>J(t,"yAxis",a,n),lr=(t,e,a,n)=>Q(t,"xAxis",e,n),cr=(t,e,a,n)=>Q(t,"yAxis",a,n),dr=W([sr,ce],(t,e)=>{if(!(t==null||e==null)){var a=t.find(n=>n.stackId===e.stackId&&e.dataKey!=null&&n.dataKeys.includes(e.dataKey));if(a!=null)return a.position}}),ur=(t,e)=>{var a=Jt(e);if(!(!t||a==null||e==null)){var{stackId:n}=e;if(n!=null){var o=t[n];if(o){var{stackedData:s}=o;if(s)return s.find(d=>d.key===a)}}}},mr=W([Ja,ce],ur),hr=W([Xt,ir,or,lr,cr,dr,te,Ht,xt,mr,ce,Za],(t,e,a,n,o,s,d,u,v,h,f,p)=>{var{chartData:g,dataStartIndex:x,dataEndIndex:A}=u;if(!(f==null||s==null||d!=="horizontal"&&d!=="vertical"||e==null||a==null||n==null||o==null||v==null)){var{data:j}=f,I;if(j!=null&&j.length>0?I=j:I=g==null?void 0:g.slice(x,A+1),I!=null)return Fa({layout:d,barSettings:f,pos:s,bandSize:v,xAxis:e,yAxis:a,xAxisTicks:n,yAxisTicks:o,stackedData:h,displayedData:I,offset:t,cells:p})}}),fr=["axis","item"],De=c.forwardRef((t,e)=>c.createElement(ta,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:fr,tooltipPayloadSearcher:aa,categoricalChartProps:t,ref:e}));const T={borrowers:"/borrowers",loans:"/loans",repayments:"/repayments",expectedRepayments:"/repayments",deposits:"/deposits",withdrawals:"/withdrawals",savings:"/savings",defaultedLoans:"/loans",defaultedInterest:"/loans",outstandingLoan:"/loans",outstandingInterest:"/loans",writtenOff:"/loans",par:"/loans"},Qe="ms_dash_filters_v1",et="ms_dash_auto_refresh_v1";function F(t){const a=(t.startsWith("/")?t:`/${t}`).replace(/^\/api\//,"/"),n=a.startsWith("/api/")?a:`/api${a}`;return Array.from(new Set([a,n]))}function le(t){return(t==null?void 0:t.name)==="CanceledError"||(t==null?void 0:t.code)==="ERR_CANCELED"||/abort|cancell?ed/i.test((t==null?void 0:t.message)||"")}async function Z(t=[],e={}){let a;for(const n of t)try{const o=await tt.get(n,e);return o==null?void 0:o.data}catch(o){a=o}throw a||new Error("No endpoint succeeded")}function pr(t){return(Array.isArray(t)?t:(t==null?void 0:t.items)||(t==null?void 0:t.rows)||(t==null?void 0:t.data)||[]).map(a=>({id:a.id??a._id??a.branchId??a.code??String(a.name||"branch"),name:a.name??a.title??a.label??String(a.code||"—")}))}function xr(t){return(Array.isArray(t)?t:(t==null?void 0:t.items)||(t==null?void 0:t.rows)||(t==null?void 0:t.data)||[]).map(a=>({id:a.id??a._id??a.userId??String(a.email||a.phone||"user"),name:a.name||[a.firstName,a.lastName].filter(Boolean).join(" ").trim()||a.username||a.email||a.phone||"—",roles:(a.roles||a.Roles||[]).map(n=>(n.name||n.code||"").toString().toLowerCase()),title:(a.title||a.jobTitle||"").toString().toLowerCase()}))}function vr(t){const e=[...t.roles||[],t.title||""].join(" ");return/loan.*officer|credit.*officer|field.*officer/i.test(e)}function gr(t){const e=(t==null?void 0:t.summary)||t||{},a=o=>Number(o||0),n=o=>{if(o==null)return 0;const s=String(o).trim().replace("%",""),d=Number(s);return Number.isFinite(d)?d:0};return{totalBorrowers:a(e.totalBorrowers??e.borrowers??e.clients),totalLoans:a(e.totalLoans??e.loans),totalDisbursed:a(e.totalDisbursed??e.disbursed),totalPaid:a(e.totalPaid??e.paid),totalRepaid:a(e.totalRepaid??e.repaid??e.collections),totalExpectedRepayments:a(e.totalExpectedRepayments??e.expectedRepayments),totalDeposits:a(e.totalDeposits??e.deposits),totalWithdrawals:a(e.totalWithdrawals??e.withdrawals),netSavings:a(e.netSavings??(e.totalDeposits||0)-(e.totalWithdrawals||0)),defaultedLoan:a(e.defaultedLoan??e.defaulted??e.nplPrincipal),defaultedInterest:a(e.defaultedInterest??e.nplInterest),outstandingLoan:a(e.outstandingLoan??e.outstandingPrincipal??e.outstanding),outstandingInterest:a(e.outstandingInterest??e.accruedInterest),writtenOff:a(e.writtenOff??e.writeOffs),parPercent:n(e.parPercent??e.par??e.par30??e.portfolioAtRisk),topBorrowers:Array.isArray(e.topBorrowers)?e.topBorrowers:[],upcomingRepayments:Array.isArray(e.upcomingRepayments)?e.upcomingRepayments:[],branchPerformance:Array.isArray(e.branchPerformance)?e.branchPerformance:[],officerPerformance:Array.isArray(e.officerPerformance)?e.officerPerformance:[],generalCommunications:Array.isArray(e.generalCommunications)?e.generalCommunications:[]}}function Le(t,{branchId:e}={}){const a=Array.isArray(t)?t:(t==null?void 0:t.items)||(t==null?void 0:t.rows)||(t==null?void 0:t.data)||[],n=Date.now(),o={critical:4,high:3,normal:2,low:1};return a.map((s,d)=>({id:s.id??s._id??s.uuid??`comm_${d}`,title:s.title??"",text:s.text??s.body??"",type:(s.type||"notice").toString().toLowerCase(),priority:(s.priority||"normal").toString().toLowerCase(),channel:(s.channel||"inapp").toString().toLowerCase(),isActive:!!(s.isActive??s.active??s.enabled??!0),showInTicker:!!(s.showInTicker??s.ticker??s.showTicker??!1),showOnDashboard:!!(s.showOnDashboard??s.dashboard??!1),startAt:s.startAt?new Date(s.startAt).getTime():null,endAt:s.endAt?new Date(s.endAt).getTime():null,audienceBranchId:s.audienceBranchId!=null?String(s.audienceBranchId):null,attachments:Array.isArray(s.attachments)?s.attachments:[]})).filter(s=>s.isActive&&s.channel==="inapp").filter(s=>s.showInTicker).filter(s=>s.startAt?n>=s.startAt:!0).filter(s=>s.endAt?n<=s.endAt:!0).filter(s=>s.audienceBranchId&&e?String(s.audienceBranchId)===String(e):!0).sort((s,d)=>(o[d.priority]||0)-(o[s.priority]||0))}const yr=()=>{const[t,e]=c.useState(()=>typeof document<"u"&&document.documentElement.classList.contains("dark"));return c.useEffect(()=>{if(typeof document>"u")return;const a=document.documentElement,n=new MutationObserver(()=>e(a.classList.contains("dark")));return n.observe(a,{attributes:!0,attributeFilter:["class"]}),()=>n.disconnect()},[]),t},br=new Intl.NumberFormat(void 0,{maximumFractionDigits:0}),S={container:"w-full px-4 md:px-6 lg:px-8 py-6",h1:"text-3xl font-extrabold tracking-tight",card:"card",btn:"inline-flex items-center justify-center rounded-lg px-3 py-2 font-semibold transition border-2 border-[var(--border-strong)] bg-[var(--card)] text-[var(--fg)] hover:bg-[var(--chip-soft)]",tableWrap:"overflow-x-auto rounded-2xl border-2 shadow bg-[var(--card)] border-[var(--border-strong)]",th:"bg-[var(--table-head-bg)] text-left text-[13px] uppercase tracking-wide font-semibold px-3 py-2 border border-[var(--border)] text-[var(--fg)] opacity-90",td:"px-3 py-2 border border-[var(--border)] text-sm text-[var(--fg)]"},jr="h-10 w-full rounded-lg text-sm outline-none transition border-2 bg-[var(--input-bg)] text-[var(--input-fg)] border-[var(--input-border)] focus:ring-2 focus:ring-[var(--ring)]",fe=({className:t="",children:e,...a})=>r.jsxs("div",{className:`relative ${t}`,children:[r.jsx("select",{...a,className:`${jr} pr-9 appearance-none bg-none ms-select`,children:e}),r.jsx(ra,{className:"pointer-events-none absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--muted)]","aria-hidden":"true"})]}),Ir=()=>{const t=yr(),[e,a]=c.useState(null),[n,o]=c.useState([]),[s,d]=c.useState([]),[u,v]=c.useState(""),[h,f]=c.useState(""),[p,g]=c.useState(""),[x,A]=c.useState(0),[j,I]=c.useState(null),[b,w]=c.useState(null),[m,P]=c.useState(Date.now()),[k,C]=c.useState([]),[B,V]=c.useState(!1),[O,ae]=c.useState(null),[re,U]=c.useState([]),[ne,de]=c.useState([]),[se,be]=c.useState([]),[ue,je]=c.useState([]),[vt,gt]=c.useState(!0),[yt,Te]=c.useState([]),z=(i,l="info")=>{const N=Math.random().toString(36).slice(2);Te(E=>[...E,{id:N,msg:i,type:l}]),setTimeout(()=>Te(E=>E.filter(D=>D.id!==N)),3500)},_=i=>{const l=Number(i);return Number.isFinite(l)?l:0},$=i=>{const l=_(i);return Number.isNaN(l)?"TZS —":`TZS ${br.format(l)}`},R=(i,l={})=>{try{const N=new URLSearchParams;u&&N.set("branchId",u),h&&N.set("officerId",h),p&&N.set("timeRange",p),Object.entries(l).forEach(([D,K])=>{K!=null&&String(K)!==""&&N.set(D,K)});const E=N.toString();return E?`${i}?${E}`:i}catch{return i}};c.useEffect(()=>{try{const i=localStorage.getItem(Qe);if(i){const l=JSON.parse(i);v(l.branchId||""),f(l.officerId||""),g(l.timeRange||"")}}catch{}try{const i=localStorage.getItem(et);i&&A(Number(i)||0)}catch{}},[]),c.useEffect(()=>{const i={branchId:u,officerId:h,timeRange:p};localStorage.setItem(Qe,JSON.stringify(i))},[u,h,p]),c.useEffect(()=>{localStorage.setItem(et,String(x||0))},[x]);const Me=c.useCallback(async i=>{try{const[l,N]=await Promise.all([Z([...F("branches"),...F("org/branches")],{signal:i}),Z([...F("users?role=loan_officer"),...F("admin/staff?role=loan_officer")],{signal:i}).catch(()=>Z([...F("users"),...F("admin/staff")],{signal:i}))]),E=pr(l),D=xr(N),K=D.filter(vr);o(E),d(K.length?K:D)}catch(l){le(l)||(console.error("Filter fetch error:",(l==null?void 0:l.message)||l),z("Failed to load filters","error")),c.useCallback(async N=>{var E;try{const D=await Z([...F("settings/general"),...F("admin/settings/general")],{signal:N}),K=(D==null?void 0:D.dashboard)||((E=D==null?void 0:D.settings)==null?void 0:E.dashboard)||{},q=K==null?void 0:K.curatedMessage;q&&(q.title||q.text||Array.isArray(q.attachments)&&q.attachments.length)?setCurated(q):setCurated(null)}catch{setCurated(null)}},[])}},[]),we=c.useCallback(async i=>{try{const l=await Z([...F("dashboard/summary")],{signal:i,params:{branchId:u,officerId:h,timeRange:p}});a(gr(l))}catch(l){le(l)||(console.error("Dashboard summary error:",(l==null?void 0:l.message)||l),z("Failed to load summary","error"))}},[u,h,p]),ie=c.useCallback(async i=>{V(!0);try{const l=await Z([...F("dashboard/communications"),...F("admin/communications?activeOnly=1&channel=inapp"),...F("settings/communications?activeOnly=1&channel=inapp")],{signal:i,params:{branchId:u}});let N=Le(l,{branchId:u});!N.length&&Array.isArray(e==null?void 0:e.generalCommunications)&&(N=Le(e.generalCommunications,{branchId:u})),C(N)}catch{const l=Le((e==null?void 0:e.generalCommunications)||[],{branchId:u});C(l)}finally{V(!1)}},[u,e]),ke=c.useCallback(async i=>{try{const l=await tt.get("/dashboard/monthly-trends",{signal:i});ae(l.data||{})}catch(l){le(l)||(console.error("Monthly trends error:",(l==null?void 0:l.message)||l),z("Failed to load trends","error"))}},[]);c.useEffect(()=>{const i=new AbortController;return(async()=>{try{await Me(i.signal)}catch{}})(),()=>i.abort()},[Me]);const me=c.useCallback(async i=>{await Promise.all([we(i),ke(i)]),I(new Date),x>0&&w(Date.now()+x*6e4)},[we,ke,x]);c.useEffect(()=>{const i=new AbortController;return(async()=>{try{await me(i.signal)}catch(l){le(l)||(console.error("Dashboard fetch error:",(l==null?void 0:l.message)||l),z("Failed to load dashboard data","error"))}finally{gt(!1)}})(),()=>i.abort()},[me]),c.useEffect(()=>{if(!e)return;const i=new AbortController;return ie(i.signal).catch(l=>{le(l)||(console.error("Comms fetch error:",(l==null?void 0:l.message)||l),z("Failed to load communications","error"))}),()=>i.abort()},[e,ie]),c.useEffect(()=>{e&&(Array.isArray(e.topBorrowers)&&U(e.topBorrowers),Array.isArray(e.upcomingRepayments)&&de(e.upcomingRepayments),Array.isArray(e.branchPerformance)&&be(e.branchPerformance),Array.isArray(e.officerPerformance)&&je(e.officerPerformance))},[e]),c.useEffect(()=>{if(!x||x<=0){w(null);return}const l=setInterval(()=>{const N=new AbortController;Promise.all([me(N.signal),ie(N.signal)]).catch(()=>{}).finally(()=>N.abort())},x*6e4);return w(Date.now()+x*6e4),()=>clearInterval(l)},[x,me,ie]),c.useEffect(()=>{const i=setInterval(()=>P(Date.now()),1e3);return()=>clearInterval(i)},[]);const Ae=({label:i,value:l,max:N})=>{const E=_(l),D=_(N),K=D>0?Math.round(E/D*100):0;return r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex justify-between text-xs text-[var(--muted)]",children:[r.jsx("span",{children:i}),r.jsx("span",{className:"tabular-nums text-[var(--fg)]/80",children:E.toLocaleString()})]}),r.jsx("div",{className:"h-2 w-full rounded bg-[var(--table-head-bg)]",children:r.jsx("div",{className:"h-2 rounded transition-[width] duration-500",style:{width:`${K}%`,backgroundColor:"currentColor"}})})]})},bt=({className:i=""})=>r.jsx("div",{className:`animate-pulse rounded bg-[var(--table-head-bg)] ${i}`}),jt=()=>{const i=k.flatMap(l=>(l.attachments||[]).map(N=>N.fileUrl)).filter(Boolean);i.length!==0&&(i.forEach((l,N)=>{setTimeout(()=>window.open(l,"_blank","noopener,noreferrer"),N*150)}),z(`Opening ${i.length} attachment${i.length>1?"s":""}…`,"info"))},y=t?{grid:"#334155",axis:"#cbd5e1",legend:"#e2e8f0",tooltipBg:"#0b1220",tooltipText:"#e2e8f0",bar1:"#60a5fa",bar2:"#34d399"}:{grid:"#e2e8f0",axis:"#334155",legend:"#334155",tooltipBg:"#ffffff",tooltipText:"#0f172a",bar1:"#2563eb",bar2:"#10b981"},$e=b?Math.max(0,Math.floor((b-m)/1e3)):0,wt=String(Math.floor($e/60)).padStart(2,"0"),kt=String($e%60).padStart(2,"0");return r.jsx("div",{className:S.container,children:r.jsxs("div",{className:"space-y-6",style:{color:"var(--fg)"},children:[r.jsx("style",{children:`
          select.ms-select{ -webkit-appearance:none; -moz-appearance:none; appearance:none; background-image:none!important; }
          select.ms-select::-ms-expand{ display:none; }
        `}),r.jsxs("div",{className:`${S.card} p-4 md:p-6`,children:[r.jsxs("div",{className:"flex flex-col md:flex-row md:items-end md:justify-between gap-4",children:[r.jsxs("div",{children:[r.jsx("h1",{className:S.h1,children:"Dashboard"}),r.jsx("p",{className:"text-sm mt-1",style:{color:"var(--muted)"},children:"Quick snapshot of borrowers, loans, repayments and savings."}),r.jsx("p",{className:"text-xs mt-1",style:{color:"var(--muted)"},children:j?`Last updated ${j.toLocaleString()}`:"Loading…"})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[r.jsxs(fe,{"aria-label":"Filter by branch",value:u,onChange:i=>v(i.target.value),className:"min-w-[11rem]",children:[r.jsx("option",{value:"",children:"All Branches"}),n.map(i=>r.jsx("option",{value:i.id,children:i.name},i.id))]}),r.jsxs(fe,{"aria-label":"Filter by loan officer",value:h,onChange:i=>f(i.target.value),className:"min-w-[12rem]",children:[r.jsx("option",{value:"",children:"All Loan Officers"}),s.map(i=>r.jsx("option",{value:i.id,children:i.name||i.email},i.id))]}),r.jsxs(fe,{"aria-label":"Filter by time range",value:p,onChange:i=>g(i.target.value),className:"min-w-[10rem]",children:[r.jsx("option",{value:"",children:"All Time"}),r.jsx("option",{value:"today",children:"Today"}),r.jsx("option",{value:"week",children:"This Week"}),r.jsx("option",{value:"month",children:"This Month"}),r.jsx("option",{value:"quarter",children:"This Quarter"}),r.jsx("option",{value:"semiAnnual",children:"Semi-Annual"}),r.jsx("option",{value:"annual",children:"Annual"})]}),r.jsxs(fe,{"aria-label":"Auto refresh interval",value:x,onChange:i=>A(Number(i.target.value)),className:"min-w-[12rem]",children:[r.jsx("option",{value:0,children:"No Auto-Refresh"}),r.jsx("option",{value:1,children:"Every 1 min"}),r.jsx("option",{value:5,children:"Every 5 mins"}),r.jsx("option",{value:15,children:"Every 15 mins"})]}),r.jsx("button",{className:S.btn,onClick:()=>{const i=new AbortController;Promise.all([we(i.signal),ke(i.signal),ie(i.signal),fetchGeneral(i.signal)]).then(()=>{I(new Date),x>0&&w(Date.now()+x*6e4),z("Dashboard refreshed","success")}).catch(()=>z("Refresh failed","error")).finally(()=>i.abort())},"aria-label":"Refresh dashboard",children:"Refresh"})]})]}),x>0&&b&&r.jsxs("div",{className:"mt-3 inline-flex items-center gap-2 rounded-full px-2.5 py-1 text-xs",style:{border:"2px solid var(--border-strong)",color:"var(--fg)"},children:["Auto-refresh in ",wt,":",kt]})]}),r.jsx("div",{className:"fixed right-4 top-4 z-50 space-y-2",children:yt.map(i=>r.jsx("div",{className:`px-3 py-2 rounded shadow text-sm text-white ${i.type==="error"?"bg-red-600":i.type==="success"?"bg-emerald-600":"bg-slate-800"}`,children:i.msg},i.id))}),((k==null?void 0:k.length)??0)>0&&r.jsxs("div",{className:`${S.card} overflow-hidden`,children:[r.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b",style:{borderColor:"var(--border)",background:"var(--table-head-bg)"},children:[r.jsx("div",{className:"text-xs font-semibold",style:{color:"var(--muted)"},children:"General Communications"}),k.some(i=>Array.isArray(i.attachments)&&i.attachments.length>0)&&r.jsxs("button",{onClick:jt,className:`${S.btn} h-7 px-2 text-xs`,title:"Open all attachments",disabled:B,children:[r.jsx(Ke,{className:"w-3 h-3"})," Download all"]})]}),r.jsxs("div",{className:"relative h-10",children:[r.jsx("style",{children:"@keyframes ms-marquee{0%{transform:translateX(100%)}100%{transform:translateX(-100%)}}"}),r.jsx("div",{className:"absolute whitespace-nowrap will-change-transform text-sm flex items-center gap-8 px-3",style:{animation:"ms-marquee 18s linear infinite",color:"var(--fg)"},children:k.map((i,l)=>{var N;return r.jsxs("span",{className:"inline-flex items-center gap-2",children:[i.type&&r.jsx("span",{className:"text-[11px] px-1.5 py-0.5 rounded border",style:{background:"var(--card)",borderColor:"var(--border)"},children:i.type}),i.priority&&r.jsx("span",{className:"text-[11px] px-1.5 py-0.5 rounded border",style:{background:"var(--card)",borderColor:"var(--border)"},children:i.priority}),typeof i.audienceBranchId<"u"&&i.audienceBranchId!==null&&r.jsx("span",{className:"text-[11px] px-1.5 py-0.5 rounded border",style:{background:"var(--card)",borderColor:"var(--border)"},children:((N=n.find(E=>String(E.id)===String(i.audienceBranchId)))==null?void 0:N.name)||`Branch #${i.audienceBranchId}`}),r.jsx("span",{className:"inline-block w-1.5 h-1.5 rounded-full bg-blue-600"}),r.jsx("span",{className:"truncate",children:i.text||i.title})]},i.id||i.text||l)})})]})]}),curated&&r.jsxs("div",{className:`${S.card} p-4`,children:[r.jsx("h3",{className:"text-lg font-semibold",children:curated.title||"Notice"}),curated.text&&r.jsx("p",{className:"text-sm mt-1",style:{color:"var(--muted)"},children:curated.text}),Array.isArray(curated.attachments)&&curated.attachments.length>0&&r.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:curated.attachments.map((i,l)=>r.jsxs("a",{href:i.fileUrl,target:"_blank",rel:"noopener noreferrer",className:S.btn,children:[r.jsx(Ke,{className:"w-4 h-4"})," ",i.fileName||"Attachment"]},l))})]}),r.jsxs("div",{className:"flex flex-wrap gap-3",children:[r.jsxs(pe,{to:"/loans/add",className:S.btn,children:[r.jsx(Ne,{className:"w-4 h-4"})," Add Loan"]}),r.jsxs(pe,{to:"/borrowers/add",className:S.btn,children:[r.jsx(Ne,{className:"w-4 h-4"})," Add Borrower"]}),r.jsxs(pe,{to:"/repayments/new",className:S.btn,children:[r.jsx(Ne,{className:"w-4 h-4"})," Record Repayment"]})]}),r.jsx("main",{className:"space-y-6",children:vt?r.jsx("div",{className:"grid gap-6 [grid-template-columns:repeat(auto-fit,minmax(230px,1fr))]",children:Array.from({length:8}).map((i,l)=>r.jsx(bt,{className:"h-32"},l))}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"grid gap-6 [grid-template-columns:repeat(auto-fit,minmax(230px,1fr))]",children:[r.jsx(M,{tone:"indigo",title:"Total Borrowers",value:_(e==null?void 0:e.totalBorrowers).toLocaleString(),icon:r.jsx(ha,{className:"w-6 h-6"}),to:R(T.borrowers)}),r.jsx(M,{tone:"sky",title:"Total Loans",value:_(e==null?void 0:e.totalLoans).toLocaleString(),icon:r.jsx(Ee,{className:"w-6 h-6"}),to:R(T.loans)}),r.jsx(M,{tone:"blue",title:"Total Disbursed",value:$(e==null?void 0:e.totalDisbursed),icon:r.jsx(Ee,{className:"w-6 h-6"}),to:R(T.loans,{tab:"disbursed"})}),r.jsx(M,{tone:"emerald",title:"Total Paid",value:$(e==null?void 0:e.totalPaid),icon:r.jsx(H,{className:"w-6 h-6"}),to:R(T.repayments,{tab:"paid"})}),r.jsx(M,{tone:"emerald",title:"Total Repaid",value:$(e==null?void 0:e.totalRepaid),icon:r.jsx(H,{className:"w-6 h-6"}),to:R(T.repayments,{tab:"paid"})}),r.jsx(M,{tone:"indigo",title:"Expected Repayments",value:$(e==null?void 0:e.totalExpectedRepayments),icon:r.jsx(ia,{className:"w-6 h-6"}),to:R(T.expectedRepayments,{tab:"expected"})}),r.jsx(M,{tone:"cyan",title:"Total Deposits",value:$(e==null?void 0:e.totalDeposits),icon:r.jsx(H,{className:"w-6 h-6"}),to:R(T.deposits)}),r.jsx(M,{tone:"amber",title:"Total Withdrawals",value:$(e==null?void 0:e.totalWithdrawals),icon:r.jsx(H,{className:"w-6 h-6"}),to:R(T.withdrawals)}),r.jsx(M,{tone:"blue",title:"Net Savings",value:$(e==null?void 0:e.netSavings),icon:r.jsx(H,{className:"w-6 h-6"}),to:R(T.savings)}),r.jsx(M,{tone:"rose",title:"Defaulted Loan",value:$(e==null?void 0:e.defaultedLoan),icon:r.jsx(Xe,{className:"w-6 h-6"}),to:R(T.defaultedLoans,{tab:"defaulted"})}),r.jsx(M,{tone:"rose",title:"Defaulted Interest",value:$(e==null?void 0:e.defaultedInterest),icon:r.jsx(Xe,{className:"w-6 h-6"}),to:R(T.defaultedInterest,{tab:"defaulted-interest"})}),r.jsx(M,{tone:"violet",title:"Outstanding Loan",value:$(e==null?void 0:e.outstandingLoan),icon:r.jsx(Ee,{className:"w-6 h-6"}),to:R(T.outstandingLoan,{tab:"outstanding"})}),r.jsx(M,{tone:"violet",title:"Outstanding Interest",value:$(e==null?void 0:e.outstandingInterest),icon:r.jsx(H,{className:"w-6 h-6"}),to:R(T.outstandingInterest,{tab:"outstanding-interest"})}),r.jsx(M,{tone:"slate",title:"Written Off",value:$(e==null?void 0:e.writtenOff),icon:r.jsx(da,{className:"w-6 h-6"}),to:R(T.writtenOff,{tab:"written-off"})}),r.jsx(M,{tone:"indigo",title:"PAR (Portfolio at Risk)",value:`${_(e==null?void 0:e.parPercent)}%`,icon:r.jsx(qe,{className:"w-6 h-6"}),to:R(T.par,{tab:"par"})})]}),O&&r.jsxs("div",{className:`${S.card} p-4`,children:[r.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[r.jsx(qe,{className:"w-5 h-5 text-indigo-600"}),r.jsx("h3",{className:"text-lg font-semibold",children:`Monthly Trends${O.month||O.year?` — ${O.month||""} ${O.year||""}`:""}`})]}),r.jsx("div",{className:"mb-4",children:r.jsx(Se,{width:"100%",height:260,children:r.jsxs(De,{data:[{name:"Loans",value:_(O.monthlyLoans)},{name:"Deposits",value:_(O.monthlyDeposits)},{name:"Repayments",value:_(O.monthlyRepayments)}],children:[r.jsx(Pe,{stroke:y.grid,strokeDasharray:"3 3"}),r.jsx(Ie,{dataKey:"name",tick:{fill:y.axis},axisLine:{stroke:y.axis},tickLine:{stroke:y.axis}}),r.jsx(Oe,{tick:{fill:y.axis},axisLine:{stroke:y.axis},tickLine:{stroke:y.axis}}),r.jsx(Ce,{contentStyle:{backgroundColor:y.tooltipBg,borderColor:y.grid,color:y.tooltipText},wrapperStyle:{outline:"none"}}),r.jsx(Be,{wrapperStyle:{color:y.legend}}),r.jsx(Y,{dataKey:"value",fill:y.bar1})]})})}),(()=>{const i=[_(O.monthlyLoans),_(O.monthlyDeposits),_(O.monthlyRepayments)],l=Math.max(...i);return r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsx("div",{className:"text-indigo-600",children:r.jsx(Ae,{label:"Loans (count)",value:_(O.monthlyLoans),max:l})}),r.jsx("div",{className:"text-emerald-600",children:r.jsx(Ae,{label:"Deposits (TZS)",value:_(O.monthlyDeposits),max:l})}),r.jsx("div",{className:"text-blue-600",children:r.jsx(Ae,{label:"Repayments (TZS)",value:_(O.monthlyRepayments),max:l})})]})})()]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{className:S.tableWrap,children:[r.jsx("div",{className:"p-4 border-b",style:{borderColor:"var(--border)"},children:r.jsx("h3",{className:"text-lg font-semibold",children:"Top Borrowers"})}),re.length===0?r.jsx("div",{className:"p-4 text-sm",style:{color:"var(--muted)"},children:"No data available."}):r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{className:S.th,children:"Name"}),r.jsx("th",{className:S.th,children:"Outstanding"})]})}),r.jsx("tbody",{children:re.map(i=>r.jsxs("tr",{children:[r.jsx("td",{className:S.td,children:i.name}),r.jsx("td",{className:S.td,children:$(i.outstanding)})]},i.id))})]})]}),r.jsxs("div",{className:S.tableWrap,children:[r.jsx("div",{className:"p-4 border-b",style:{borderColor:"var(--border)"},children:r.jsx("h3",{className:"text-lg font-semibold",children:"Upcoming Repayments"})}),ne.length===0?r.jsx("div",{className:"p-4 text-sm",style:{color:"var(--muted)"},children:"No data available."}):r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{className:S.th,children:"Borrower"}),r.jsx("th",{className:S.th,children:"Due Date"}),r.jsx("th",{className:S.th,children:"Amount"})]})}),r.jsx("tbody",{children:ne.map(i=>r.jsxs("tr",{children:[r.jsx("td",{className:S.td,children:i.borrower}),r.jsx("td",{className:S.td,children:i.dueDate}),r.jsx("td",{className:S.td,children:$(i.amount)})]},i.id))})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{className:`${S.card} p-4`,children:[r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Branch Performance"}),se.length===0?r.jsx("p",{className:"text-sm",style:{color:"var(--muted)"},children:"No data available."}):r.jsx(Se,{width:"100%",height:260,children:r.jsxs(De,{data:se,children:[r.jsx(Pe,{stroke:y.grid,strokeDasharray:"3 3"}),r.jsx(Ie,{dataKey:"branch",tick:{fill:y.axis},axisLine:{stroke:y.axis},tickLine:{stroke:y.axis}}),r.jsx(Oe,{tick:{fill:y.axis},axisLine:{stroke:y.axis},tickLine:{stroke:y.axis}}),r.jsx(Ce,{contentStyle:{backgroundColor:y.tooltipBg,borderColor:y.grid,color:y.tooltipText},wrapperStyle:{outline:"none"}}),r.jsx(Be,{wrapperStyle:{color:y.legend}}),r.jsx(Y,{dataKey:"disbursed",fill:y.bar1}),r.jsx(Y,{dataKey:"repayments",fill:y.bar2})]})})]}),r.jsxs("div",{className:`${S.card} p-4`,children:[r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Officer Performance"}),ue.length===0?r.jsx("p",{className:"text-sm",style:{color:"var(--muted)"},children:"No data available."}):r.jsx(Se,{width:"100%",height:260,children:r.jsxs(De,{data:ue,children:[r.jsx(Pe,{stroke:y.grid,strokeDasharray:"3 3"}),r.jsx(Ie,{dataKey:"officer",tick:{fill:y.axis},axisLine:{stroke:y.axis},tickLine:{stroke:y.axis}}),r.jsx(Oe,{tick:{fill:y.axis},axisLine:{stroke:y.axis},tickLine:{stroke:y.axis}}),r.jsx(Ce,{contentStyle:{backgroundColor:y.tooltipBg,borderColor:y.grid,color:y.tooltipText},wrapperStyle:{outline:"none"}}),r.jsx(Be,{wrapperStyle:{color:y.legend}}),r.jsx(Y,{dataKey:"loans",fill:y.bar1}),r.jsx(Y,{dataKey:"collections",fill:y.bar2})]})})]})]})]})})]})})},M=({title:t,value:e,icon:a,tone:n="indigo",to:o=null,delta:s=null,deltaLabel:d="",spark:u=null})=>{const v={indigo:"text-indigo-600",sky:"text-sky-600",blue:"text-blue-600",emerald:"text-emerald-600",cyan:"text-cyan-600",amber:"text-amber-600",violet:"text-violet-600",rose:"text-rose-600",slate:"text-slate-500"}[n]||"text-slate-500",h=()=>{if(!Array.isArray(u)||u.length<2)return null;const p=96,g=28,x=2,A=Math.min(...u),j=Math.max(...u),I=Math.max(j-A,1e-6),b=(p-x*2)/(u.length-1),w="M "+u.map((m,P)=>{const k=(x+P*b).toFixed(1),C=(g-x-(m-A)/I*(g-x*2)).toFixed(1);return`${k} ${C}`}).join(" L ");return r.jsx("svg",{width:p,height:g,className:"mt-2 opacity-70",children:r.jsx("path",{d:w,fill:"none",stroke:"currentColor",strokeWidth:"2"})})},f=s==null?"":s>=0?"text-emerald-700 bg-emerald-50 ring-1 ring-emerald-200":"text-rose-700 bg-rose-50 ring-1 ring-rose-200";return r.jsxs("div",{className:"group relative",children:[o&&r.jsx(pe,{to:o,className:"absolute inset-0 z-10 rounded-2xl focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[var(--ring)]","aria-label":`View ${t} details`,title:`View ${t} details`}),r.jsxs("div",{className:"relative rounded-2xl p-5 min-h-[10.5rem] shadow transition-all group-hover:shadow-md group-hover:-translate-y-0.5 border-2",style:{background:"var(--card)",borderColor:"var(--border-strong)",color:"var(--fg)"},children:[r.jsxs("div",{className:"relative flex items-start justify-between gap-3",children:[r.jsx("div",{className:`p-3 rounded-full ring-2 ${v}`,style:{background:"var(--card)",boxShadow:"0 1px 0 rgba(0,0,0,.04)"},children:a}),s!=null&&r.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[11px] font-medium ${f}`,children:[s>=0?"↑":"↓"," ",Math.abs(s).toLocaleString(),"%",d&&r.jsxs("span",{className:"opacity-70",children:[" ",d]})]})]}),r.jsxs("div",{className:"relative mt-3 min-w-0",children:[r.jsx("h3",{className:`text-sm font-semibold truncate ${v}`,children:t}),r.jsx("p",{className:"text-[28px] md:text-[32px] leading-tight font-semibold font-mono tabular-nums break-words",children:e??"—"})]}),r.jsx("div",{className:`relative ${v}`,children:r.jsx(h,{})})]})]})};export{Ir as default};
