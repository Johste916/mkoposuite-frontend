import{r as l,g as re,j as a,L as je}from"./index-8DtxmKky.js";import{D as Ht}from"./download-DWQO77XC.js";import{C as De}from"./circle-plus-Zh-jBjo8.js";import{c as U}from"./createLucideIcon-Dj9MDrjL.js";import{i as tt,S as Xt,a as Se,r as Zt,u as ft,R as Yt,b as Jt,c as Qt,d as ea,g as ta,e as bt,f as aa,h as ra,j as sa,k as we,l as na,G as ia,C as oa,m as vt,n as la,L as Ne,o as da,p as ca,t as ua,q as at,s as yt,v as kt,w as jt,x as wt,y as ma,z as Nt,A as xa,J as ha,B as ee,D as pa,E as ga,F as fa,H as ba,I as rt,K as X,M as va,N as ne,O as ie,P as le,Q as ya,T as At,U as St,V as Pt,W as ka,X as ja,Y as st,Z as wa,_ as Na,$ as nt,a0 as Aa,a1 as Ke,a2 as it,a3 as Sa,a4 as Pa,a5 as Be,a6 as Ee,a7 as Le,a8 as Re,a9 as _e,aa as Te}from"./CartesianChart-CBC6fysz.js";import{U as Ia}from"./user-plus-E_PdWmvs.js";import{C as Oa}from"./calendar-q-a_lhl3.js";/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ca=[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]],ot=U("chart-no-axes-column",Ca);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Da=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Ba=U("chevron-down",Da);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ea=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],lt=U("clipboard-list",Ea);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const La=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Me=U("credit-card",La);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ra=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],te=U("dollar-sign",Ra);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _a=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],Ta=U("message-square",_a);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ma=[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]],$a=U("thumbs-down",Ma);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fa=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],dt=U("triangle-alert",Fa);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ka=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],za=U("users",Ka);var Wa="Invariant failed";function Va(t,e){throw new Error(Wa)}var Ua=["x","y"];function ze(){return ze=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},ze.apply(null,arguments)}function ct(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,s)}return r}function xe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ct(Object(r),!0).forEach(function(s){qa(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ct(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function qa(t,e,r){return(e=Ga(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ga(t){var e=Ha(t,"string");return typeof e=="symbol"?e:e+""}function Ha(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xa(t,e){if(t==null)return{};var r,s,o=Za(t,e);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(t);for(s=0;s<d.length;s++)r=d[s],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}function Za(t,e){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;r[s]=t[s]}return r}function Ya(t,e){var{x:r,y:s}=t,o=Xa(t,Ua),d="".concat(r),c=parseInt(d,10),h="".concat(s),b=parseInt(h,10),x="".concat(e.height||o.height),p=parseInt(x,10),g="".concat(e.width||o.width),v=parseInt(g,10);return xe(xe(xe(xe(xe({},e),o),c?{x:c}:{}),b?{y:b}:{}),{},{height:p,width:v,name:e.name,radius:e.radius})}function It(t){return l.createElement(Xt,ze({shapeType:"rectangle",propTransformer:Ya,activeClassName:"recharts-active-bar"},t))}var Ja=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(s,o)=>{if(tt(e))return e;var d=tt(s)||Se(s);return d?e(s,o):(d||Va(),r)}},Qa=["onMouseEnter","onMouseLeave","onClick"],er=["value","background","tooltipPosition"],tr=["id"],ar=["onMouseEnter","onClick","onMouseLeave"];function oe(){return oe=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},oe.apply(null,arguments)}function ut(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,s)}return r}function E(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ut(Object(r),!0).forEach(function(s){rr(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ut(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function rr(t,e,r){return(e=sr(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sr(t){var e=nr(t,"string");return typeof e=="symbol"?e:e+""}function nr(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ae(t,e){if(t==null)return{};var r,s,o=ir(t,e);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(t);for(s=0;s<d.length;s++)r=d[s],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}function ir(t,e){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;r[s]=t[s]}return r}var or=t=>{var{dataKey:e,name:r,fill:s,legendType:o,hide:d}=t;return[{inactive:d,dataKey:e,type:o,color:s,value:bt(r,e),payload:t}]};function lr(t){var{dataKey:e,stroke:r,strokeWidth:s,fill:o,name:d,hide:c,unit:h}=t;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:s,fill:o,dataKey:e,nameKey:void 0,name:bt(d,e),hide:c,type:t.tooltipType,color:t.fill,unit:h}}}function dr(t){var e=we(yt),{data:r,dataKey:s,background:o,allOtherBarProps:d}=t,{onMouseEnter:c,onMouseLeave:h,onClick:b}=d,x=Ae(d,Qa),p=kt(c,s),g=jt(h),v=wt(b,s);if(!o||r==null)return null;var f=ma(o,!1);return l.createElement(l.Fragment,null,r.map((A,j)=>{var{value:P,background:k,tooltipPosition:w}=A,m=Ae(A,er);if(!k)return null;var S=p(A,j),N=g(A,j),I=v(A,j),D=E(E(E(E(E({option:o,isActive:String(j)===e},m),{},{fill:"#eee"},k),f),Nt(x,A,j)),{},{onMouseEnter:S,onMouseLeave:N,onClick:I,dataKey:s,index:j,className:"recharts-bar-background-rectangle"});return l.createElement(It,oe({key:"background-bar-".concat(j)},D))}))}function Ot(t){var{data:e,props:r,showLabels:s}=t,o=pa(r),{id:d}=o,c=Ae(o,tr),{shape:h,dataKey:b,activeBar:x}=r,p=we(yt),g=we(ga),{onMouseEnter:v,onClick:f,onMouseLeave:A}=r,j=Ae(r,ar),P=kt(v,b),k=jt(A),w=wt(f,b);return e?l.createElement(l.Fragment,null,e.map((m,S)=>{var N=x&&String(S)===p&&(g==null||b===g),I=N?x:h,D=E(E(E({},c),m),{},{isActive:N,option:I,index:S,dataKey:b});return l.createElement(Ne,oe({className:"recharts-bar-rectangle"},Nt(j,m,S),{onMouseEnter:P(m,S),onMouseLeave:k(m,S),onClick:w(m,S),key:"rectangle-".concat(m==null?void 0:m.x,"-").concat(m==null?void 0:m.y,"-").concat(m==null?void 0:m.value,"-").concat(S)}),l.createElement(It,D))}),s&&fa.renderCallByParent(r,e)):null}function cr(t){var{props:e,previousRectanglesRef:r}=t,{data:s,layout:o,isAnimationActive:d,animationBegin:c,animationDuration:h,animationEasing:b,onAnimationEnd:x,onAnimationStart:p}=e,g=r.current,v=xa(e,"recharts-bar-"),[f,A]=l.useState(!1),j=l.useCallback(()=>{typeof x=="function"&&x(),A(!1)},[x]),P=l.useCallback(()=>{typeof p=="function"&&p(),A(!0)},[p]);return l.createElement(ha,{begin:c,duration:h,isActive:d,easing:b,onAnimationEnd:j,onAnimationStart:P,key:v},k=>{var w=k===1?s:s==null?void 0:s.map((m,S)=>{var N=g&&g[S];if(N)return E(E({},m),{},{x:ee(N.x,m.x,k),y:ee(N.y,m.y,k),width:ee(N.width,m.width,k),height:ee(N.height,m.height,k)});if(o==="horizontal"){var I=ee(0,m.height,k);return E(E({},m),{},{y:m.y+m.height-I,height:I})}var D=ee(0,m.width,k);return E(E({},m),{},{width:D})});return k>0&&(r.current=w??null),w==null?null:l.createElement(Ne,null,l.createElement(Ot,{props:e,data:w,showLabels:!f}))})}function ur(t){var{data:e,isAnimationActive:r}=t,s=l.useRef(null);return r&&e&&e.length&&(s.current==null||s.current!==e)?l.createElement(cr,{previousRectanglesRef:s,props:t}):l.createElement(Ot,{props:t,data:e,showLabels:!0})}var Ct=0,mr=(t,e)=>{var r=Array.isArray(t.value)?t.value[1]:t.value;return{x:t.x,y:t.y,value:r,errorVal:vt(t,e)}};class xr extends l.PureComponent{render(){var{hide:e,data:r,dataKey:s,className:o,xAxisId:d,yAxisId:c,needClip:h,background:b,id:x}=this.props;if(e)return null;var p=la("recharts-bar",o),g=x;return l.createElement(Ne,{className:p,id:x},h&&l.createElement("defs",null,l.createElement(da,{clipPathId:g,xAxisId:d,yAxisId:c})),l.createElement(Ne,{className:"recharts-bar-rectangles",clipPath:h?"url(#clipPath-".concat(g,")"):void 0},l.createElement(dr,{data:r,dataKey:s,background:b,allOtherBarProps:this.props}),l.createElement(ur,this.props)),this.props.children)}}var hr={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!ia.isSsr,legendType:"rect",minPointSize:Ct,xAxisId:0,yAxisId:0};function pr(t){var{xAxisId:e,yAxisId:r,hide:s,legendType:o,minPointSize:d,activeBar:c,animationBegin:h,animationDuration:b,animationEasing:x,isAnimationActive:p}=t,{needClip:g}=aa(e,r),v=ra(),f=ft(),A=sa(t.children,oa),j=we(w=>zr(w,e,r,f,t.id,A));if(v!=="vertical"&&v!=="horizontal")return null;var P,k=j==null?void 0:j[0];return k==null||k.height==null||k.width==null?P=0:P=v==="vertical"?k.height/2:k.width/2,l.createElement(na,{xAxisId:e,yAxisId:r,data:j,dataPointFormatter:mr,errorBarOffset:P},l.createElement(xr,oe({},t,{layout:v,needClip:g,data:j,xAxisId:e,yAxisId:r,hide:s,legendType:o,minPointSize:d,activeBar:c,animationBegin:h,animationDuration:b,animationEasing:x,isAnimationActive:p})))}function gr(t){var{layout:e,barSettings:{dataKey:r,minPointSize:s},pos:o,bandSize:d,xAxis:c,yAxis:h,xAxisTicks:b,yAxisTicks:x,stackedData:p,displayedData:g,offset:v,cells:f}=t,A=e==="horizontal"?h:c,j=p?A.scale.domain():null,P=ca({numericAxis:A});return g.map((k,w)=>{var m,S,N,I,D,J;p?m=ua(p[w],j):(m=vt(k,r),Array.isArray(m)||(m=[P,m]));var V=Ja(s,Ct)(m[1],w);if(e==="horizontal"){var de,[q,Q]=[h.scale(m[0]),h.scale(m[1])];S=at({axis:c,ticks:b,bandSize:d,offset:o.offset,entry:k,index:w}),N=(de=Q??q)!==null&&de!==void 0?de:void 0,I=o.size;var F=q-Q;if(D=ba(F)?0:F,J={x:S,y:v.top,width:I,height:v.height},Math.abs(V)>0&&Math.abs(D)<Math.abs(V)){var Z=rt(D||V)*(Math.abs(V)-Math.abs(D));N-=Z,D+=Z}}else{var[G,ce]=[c.scale(m[0]),c.scale(m[1])];if(S=G,N=at({axis:h,ticks:x,bandSize:d,offset:o.offset,entry:k,index:w}),I=ce-G,D=o.size,J={x:v.left,y:N,width:v.width,height:D},Math.abs(V)>0&&Math.abs(I)<Math.abs(V)){var Pe=rt(I||V)*(Math.abs(V)-Math.abs(I));I+=Pe}}if(S==null||N==null||I==null||D==null)return null;var ue=E(E({},k),{},{x:S,y:N,width:I,height:D,value:p?m:m[1],payload:k,background:J,tooltipPosition:{x:S+I/2,y:N+D/2}},f&&f[w]&&f[w].props);return ue}).filter(Boolean)}function se(t){var e=Zt(t,hr),r=ft();return l.createElement(Yt,{id:e.id,type:"bar"},s=>l.createElement(l.Fragment,null,l.createElement(Jt,{legendPayload:or(e)}),l.createElement(Qt,{fn:lr,args:e}),l.createElement(ea,{type:"bar",id:s,data:void 0,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:0,dataKey:e.dataKey,stackId:ta(e.stackId),hide:e.hide,barSize:e.barSize,minPointSize:e.minPointSize,maxBarSize:e.maxBarSize,isPanorama:r}),l.createElement(pr,oe({},e,{id:s}))))}se.displayName="Bar";function mt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,s)}return r}function ye(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?mt(Object(r),!0).forEach(function(s){fr(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):mt(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function fr(t,e,r){return(e=br(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function br(t){var e=vr(t,"string");return typeof e=="symbol"?e:e+""}function vr(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var yr=(t,e)=>e,kr=(t,e,r)=>r,jr=(t,e,r,s)=>s,wr=(t,e,r,s,o)=>o,pe=X([St,wr],(t,e)=>t.filter(r=>r.type==="bar").find(r=>r.id===e)),Nr=X([pe],t=>t==null?void 0:t.maxBarSize),Ar=(t,e,r,s,o,d)=>d,xt=(t,e,r)=>{var s=r??t;if(!Se(s))return Ke(s,e,0)},Sr=X([le,St,yr,kr,jr],(t,e,r,s,o)=>e.filter(d=>t==="horizontal"?d.xAxisId===r:d.yAxisId===s).filter(d=>d.isPanorama===o).filter(d=>d.hide===!1).filter(d=>d.type==="bar")),Pr=(t,e,r,s)=>{var o=le(t);return o==="horizontal"?st(t,"yAxis",r,s):st(t,"xAxis",e,s)},Ir=(t,e,r)=>{var s=le(t);return s==="horizontal"?nt(t,"xAxis",e):nt(t,"yAxis",r)},Or=(t,e,r)=>{var s={},o=t.filter(Aa),d=t.filter(x=>x.stackId==null),c=o.reduce((x,p)=>(x[p.stackId]||(x[p.stackId]=[]),x[p.stackId].push(p),x),s),h=Object.entries(c).map(x=>{var[p,g]=x,v=g.map(A=>A.dataKey),f=xt(e,r,g[0].barSize);return{stackId:p,dataKeys:v,barSize:f}}),b=d.map(x=>{var p=[x.dataKey].filter(v=>v!=null),g=xt(e,r,x.barSize);return{stackId:void 0,dataKeys:p,barSize:g}});return[...h,...b]},Cr=X([Sr,Na,Ir],Or),Dr=(t,e,r,s,o)=>{var d,c,h=pe(t,e,r,s,o);if(h!=null){var b=le(t),x=Pt(t),{maxBarSize:p}=h,g=Se(p)?x:p,v,f;return b==="horizontal"?(v=ne(t,"xAxis",e,s),f=ie(t,"xAxis",e,s)):(v=ne(t,"yAxis",r,s),f=ie(t,"yAxis",r,s)),(d=(c=At(v,f,!0))!==null&&c!==void 0?c:g)!==null&&d!==void 0?d:0}},Dt=(t,e,r,s)=>{var o=le(t),d,c;return o==="horizontal"?(d=ne(t,"xAxis",e,s),c=ie(t,"xAxis",e,s)):(d=ne(t,"yAxis",r,s),c=ie(t,"yAxis",r,s)),At(d,c)};function Br(t,e,r,s,o){var d=s.length;if(!(d<1)){var c=Ke(t,r,0,!0),h,b=[];if(it(s[0].barSize)){var x=!1,p=r/d,g=s.reduce((k,w)=>k+(w.barSize||0),0);g+=(d-1)*c,g>=r&&(g-=(d-1)*c,c=0),g>=r&&p>0&&(x=!0,p*=.9,g=d*p);var v=(r-g)/2>>0,f={offset:v-c,size:0};h=s.reduce((k,w)=>{var m,S={stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:f.offset+f.size+c,size:x?p:(m=w.barSize)!==null&&m!==void 0?m:0}},N=[...k,S];return f=N[N.length-1].position,N},b)}else{var A=Ke(e,r,0,!0);r-2*A-(d-1)*c<=0&&(c=0);var j=(r-2*A-(d-1)*c)/d;j>1&&(j>>=0);var P=it(o)?Math.min(j,o):j;h=s.reduce((k,w,m)=>[...k,{stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:A+(j+c)*m+(j-P)/2,size:P}}],b)}return h}}var Er=(t,e,r,s,o,d,c)=>{var h=Se(c)?e:c,b=Br(r,s,o!==d?o:d,t,h);return o!==d&&b!=null&&(b=b.map(x=>ye(ye({},x),{},{position:ye(ye({},x.position),{},{offset:x.position.offset-o/2})}))),b},Lr=X([Cr,Pt,ka,ja,Dr,Dt,Nr],Er),Rr=(t,e,r,s)=>ne(t,"xAxis",e,s),_r=(t,e,r,s)=>ne(t,"yAxis",r,s),Tr=(t,e,r,s)=>ie(t,"xAxis",e,s),Mr=(t,e,r,s)=>ie(t,"yAxis",r,s),$r=X([Lr,pe],(t,e)=>{if(!(t==null||e==null)){var r=t.find(s=>s.stackId===e.stackId&&e.dataKey!=null&&s.dataKeys.includes(e.dataKey));if(r!=null)return r.position}}),Fr=(t,e)=>{var r=wa(e);if(!(!t||r==null||e==null)){var{stackId:s}=e;if(s!=null){var o=t[s];if(o){var{stackedData:d}=o;if(d)return d.find(c=>c.key===r)}}}},Kr=X([Pr,pe],Fr),zr=X([va,Rr,_r,Tr,Mr,$r,le,ya,Dt,Kr,pe,Ar],(t,e,r,s,o,d,c,h,b,x,p,g)=>{var{chartData:v,dataStartIndex:f,dataEndIndex:A}=h;if(!(p==null||d==null||c!=="horizontal"&&c!=="vertical"||e==null||r==null||s==null||o==null||b==null)){var{data:j}=p,P;if(j!=null&&j.length>0?P=j:P=v==null?void 0:v.slice(f,A+1),P!=null)return gr({layout:c,barSettings:p,pos:d,bandSize:b,xAxis:e,yAxis:r,xAxisTicks:s,yAxisTicks:o,stackedData:x,displayedData:P,offset:t,cells:g})}}),Wr=["axis","item"],$e=l.forwardRef((t,e)=>l.createElement(Sa,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Wr,tooltipPayloadSearcher:Pa,categoricalChartProps:t,ref:e}));const _={borrowers:"/borrowers",loans:"/loans",repayments:"/repayments",expectedRepayments:"/repayments",deposits:"/deposits",withdrawals:"/withdrawals",savings:"/savings",defaultedLoans:"/loans",defaultedInterest:"/loans",outstandingLoan:"/loans",outstandingInterest:"/loans",writtenOff:"/loans",par:"/loans"},ht="ms_dash_filters_v1",pt="ms_dash_auto_refresh_v1";function Y(t){const r=(t.startsWith("/")?t:`/${t}`).replace(/^\/api\//,"/"),s=r.startsWith("/api/")?r:`/api${r}`;return Array.from(new Set([r,s]))}function ae(t){return(t==null?void 0:t.name)==="CanceledError"||(t==null?void 0:t.code)==="ERR_CANCELED"||/abort|cancell?ed/i.test((t==null?void 0:t.message)||"")}async function ke(t=[],e={}){let r;for(const s of t)try{const o=await re.get(s,e);return o==null?void 0:o.data}catch(o){r=o}throw r||new Error("No endpoint succeeded")}function Vr(t){return(Array.isArray(t)?t:(t==null?void 0:t.items)||(t==null?void 0:t.rows)||(t==null?void 0:t.data)||[]).map(r=>({id:r.id??r._id??r.branchId??r.code??String(r.name||"branch"),name:r.name??r.title??r.label??String(r.code||"—")}))}function Ur(t){return(Array.isArray(t)?t:(t==null?void 0:t.items)||(t==null?void 0:t.rows)||(t==null?void 0:t.data)||[]).map(r=>({id:r.id??r._id??r.userId??String(r.email||r.phone||"user"),name:r.name||[r.firstName,r.lastName].filter(Boolean).join(" ").trim()||r.username||r.email||r.phone||"—",roles:(r.roles||r.Roles||[]).map(s=>(s.name||s.code||"").toString().toLowerCase()),title:(r.title||r.jobTitle||"").toString().toLowerCase()}))}function qr(t){const e=[...t.roles||[],t.title||""].join(" ");return/loan.*officer|credit.*officer|field.*officer/i.test(e)}function Gr(t){const e=(t==null?void 0:t.summary)||t||{},r=o=>Number(o||0),s=o=>{if(o==null)return 0;const d=String(o).trim().replace("%",""),c=Number(d);return Number.isFinite(c)?c:0};return{totalBorrowers:r(e.totalBorrowers??e.borrowers??e.clients),totalLoans:r(e.totalLoans??e.loans),totalDisbursed:r(e.totalDisbursed??e.disbursed),totalPaid:r(e.totalPaid??e.paid),totalRepaid:r(e.totalRepaid??e.repaid??e.collections),totalExpectedRepayments:r(e.totalExpectedRepayments??e.expectedRepayments),totalDeposits:r(e.totalDeposits??e.deposits),totalWithdrawals:r(e.totalWithdrawals??e.withdrawals),netSavings:r(e.netSavings??(e.totalDeposits||0)-(e.totalWithdrawals||0)),defaultedLoan:r(e.defaultedLoan??e.defaulted??e.nplPrincipal),defaultedInterest:r(e.defaultedInterest??e.nplInterest),outstandingLoan:r(e.outstandingLoan??e.outstandingPrincipal??e.outstanding),outstandingInterest:r(e.outstandingInterest??e.accruedInterest),writtenOff:r(e.writtenOff??e.writeOffs),parPercent:s(e.parPercent??e.par??e.par30??e.portfolioAtRisk),topBorrowers:Array.isArray(e.topBorrowers)?e.topBorrowers:[],upcomingRepayments:Array.isArray(e.upcomingRepayments)?e.upcomingRepayments:[],branchPerformance:Array.isArray(e.branchPerformance)?e.branchPerformance:[],officerPerformance:Array.isArray(e.officerPerformance)?e.officerPerformance:[]}}const Hr=()=>{const[t,e]=l.useState(()=>typeof document<"u"&&document.documentElement.classList.contains("dark"));return l.useEffect(()=>{if(typeof document>"u")return;const r=document.documentElement,s=new MutationObserver(()=>{e(r.classList.contains("dark"))});return s.observe(r,{attributes:!0,attributeFilter:["class"]}),()=>s.disconnect()},[]),t},Xr=new Intl.NumberFormat(void 0,{maximumFractionDigits:0}),We="h-10 w-full rounded-lg border text-sm outline-none transition bg-white text-slate-900 border-slate-300 focus:ring-2 focus:ring-indigo-500/50 dark:bg-slate-800 dark:text-slate-100 dark:border-slate-700",he=({className:t="",children:e,...r})=>a.jsxs("div",{className:`relative ${t}`,children:[a.jsx("select",{...r,className:`${We} pr-9 appearance-none bg-none ms-select`,style:{backgroundImage:"none"},children:e}),a.jsx(Ba,{className:"pointer-events-none absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-600 dark:text-slate-300","aria-hidden":"true"})]}),Fe=({className:t="",...e})=>a.jsxs("div",{className:`relative ${t}`,children:[a.jsx("input",{type:"date",...e,className:`${We} pr-9 appearance-none bg-none ms-date`,style:{backgroundImage:"none"}}),a.jsx(Oa,{className:"pointer-events-none absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-600 dark:text-slate-300","aria-hidden":"true"})]}),gt=({className:t="",...e})=>a.jsx("input",{...e,className:`${We} ${t}`}),rs=()=>{const t=Hr(),[e,r]=l.useState(null),[s,o]=l.useState([]),[d,c]=l.useState([]),[h,b]=l.useState(""),[x,p]=l.useState(""),[g,v]=l.useState(""),[f,A]=l.useState(0),[j,P]=l.useState(null),[k,w]=l.useState(null),[m,S]=l.useState(Date.now()),[N,I]=l.useState([]),[D,J]=l.useState(!1),[V,de]=l.useState([]),[q,Q]=l.useState(0),[F,Z]=l.useState(1),G=10,[ce,Pe]=l.useState(""),[ue,Bt]=l.useState(""),[Ve,Ue]=l.useState({}),[ge,fe]=l.useState({}),[qe,be]=l.useState({}),[M,Et]=l.useState(null),[Ge,Lt]=l.useState([]),[He,Rt]=l.useState([]),[Xe,_t]=l.useState([]),[Ze,Tt]=l.useState([]),[Mt,$t]=l.useState(!0),[Ft,Ye]=l.useState([]),K=(n,i="info")=>{const u=Math.random().toString(36).slice(2);Ye(O=>[...O,{id:u,msg:n,type:i}]),setTimeout(()=>Ye(O=>O.filter(C=>C.id!==u)),3500)},L=n=>{const i=Number(n);return Number.isFinite(i)?i:0},$=n=>{const i=L(n);return Number.isNaN(i)?"TZS —":`TZS ${Xr.format(i)}`},R=(n,i={})=>{try{const u=new URLSearchParams;h&&u.set("branchId",h),x&&u.set("officerId",x),g&&u.set("timeRange",g),Object.entries(i).forEach(([C,W])=>{W!=null&&String(W)!==""&&u.set(C,W)});const O=u.toString();return O?`${n}?${O}`:n}catch{return n}},Kt=n=>{var i;return((i=s.find(u=>String(u.id)===String(n)))==null?void 0:i.name)||(n?`Branch #${n}`:"All branches")};l.useEffect(()=>{try{const n=localStorage.getItem(ht);if(n){const i=JSON.parse(n);b(i.branchId||""),p(i.officerId||""),v(i.timeRange||"")}}catch{}try{const n=localStorage.getItem(pt);n&&A(Number(n)||0)}catch{}},[]),l.useEffect(()=>{const n={branchId:h,officerId:x,timeRange:g};localStorage.setItem(ht,JSON.stringify(n))},[h,x,g]),l.useEffect(()=>{localStorage.setItem(pt,String(f||0))},[f]);const Je=l.useCallback(async n=>{try{const[i,u]=await Promise.all([ke([...Y("branches"),...Y("org/branches")],{signal:n}),ke([...Y("users?role=loan_officer"),...Y("admin/staff?role=loan_officer")],{signal:n}).catch(()=>ke([...Y("users"),...Y("admin/staff")],{signal:n}))]),O=Vr(i),C=Ur(u),W=C.filter(qr);o(O),c(W.length?W:C)}catch(i){ae(i)||(console.error("Filter fetch error:",(i==null?void 0:i.message)||i),K("Failed to load filters","error"))}},[]),Ie=l.useCallback(async n=>{try{const i=await ke([...Y("dashboard/summary")],{signal:n,params:{branchId:h,officerId:x,timeRange:g}});r(Gr(i))}catch(i){ae(i)||(console.error("Dashboard summary error:",(i==null?void 0:i.message)||i),K("Failed to load summary","error"))}},[h,x,g]),me=l.useCallback(async n=>{J(!0);try{const i=await re.get("/dashboard/communications",{signal:n}).catch(()=>null);i!=null&&i.data&&Array.isArray(i.data)?I(i.data):I(Array.isArray(e==null?void 0:e.generalCommunications)?e.generalCommunications:[])}finally{J(!1)}},[e]),H=l.useCallback(async(n={},i)=>{var u,O;try{const C=await re.get("/dashboard/activity",{params:{page:n.page??F,pageSize:G,dateFrom:ce||void 0,dateTo:ue||void 0},signal:i});de(((u=C.data)==null?void 0:u.items)||[]),Q(((O=C.data)==null?void 0:O.total)||0)}catch(C){ae(C)||(console.error("Activity fetch error:",(C==null?void 0:C.message)||C),K("Failed to load activity","error"))}},[F,ce,ue]),Oe=l.useCallback(async n=>{try{const i=await re.get("/dashboard/monthly-trends",{signal:n});Et(i.data||{})}catch(i){ae(i)||(console.error("Monthly trends error:",(i==null?void 0:i.message)||i),K("Failed to load trends","error"))}},[]);l.useEffect(()=>{const n=new AbortController;return(async()=>{try{await Je(n.signal)}catch{}})(),()=>n.abort()},[Je]);const ve=l.useCallback(async n=>{await Promise.all([Ie(n),H({},n),Oe(n)]),P(new Date),f>0&&w(Date.now()+f*6e4)},[Ie,H,Oe,f]);l.useEffect(()=>{const n=new AbortController;return(async()=>{try{await ve(n.signal)}catch(i){ae(i)||(console.error("Dashboard fetch error:",(i==null?void 0:i.message)||i),K("Failed to load dashboard data","error"))}finally{$t(!1)}})(),()=>n.abort()},[ve]),l.useEffect(()=>{if(!e)return;const n=new AbortController;return me(n.signal).catch(i=>{ae(i)||(console.error("Comms fetch error:",(i==null?void 0:i.message)||i),K("Failed to load communications","error"))}),()=>n.abort()},[e,me]),l.useEffect(()=>{e&&(Array.isArray(e.topBorrowers)&&Lt(e.topBorrowers),Array.isArray(e.upcomingRepayments)&&Rt(e.upcomingRepayments),Array.isArray(e.branchPerformance)&&_t(e.branchPerformance),Array.isArray(e.officerPerformance)&&Tt(e.officerPerformance))},[e]),l.useEffect(()=>{if(!f||f<=0){w(null);return}const i=setInterval(()=>{const u=new AbortController;Promise.all([ve(u.signal),me(u.signal)]).catch(()=>{}).finally(()=>u.abort())},f*6e4);return w(Date.now()+f*6e4),()=>clearInterval(i)},[f,ve,me]),l.useEffect(()=>{const n=setInterval(()=>S(Date.now()),1e3);return()=>clearInterval(n)},[]);const zt=async n=>{const i=`c-${n}`;be(u=>({...u,[i]:!0}));try{const u=(Ve[n]||"").trim();if(!u)return;await re.post(`/dashboard/activity/${n}/comment`,{comment:u}),Ue(O=>({...O,[n]:""})),await H(),K("Reply posted","success")}catch(u){console.error("Add comment error:",(u==null?void 0:u.message)||u),K("Failed to post reply","error")}finally{be(u=>({...u,[i]:!1}))}},Wt=async n=>{const i=`a-${n}`;be(u=>({...u,[i]:!0}));try{const u=ge[n]||{};if(!u.assigneeId)return;await re.post(`/dashboard/activity/${n}/assign`,{assigneeId:u.assigneeId,dueDate:u.dueDate||null,note:u.note||""}),fe(O=>({...O,[n]:{assigneeId:"",dueDate:"",note:""}})),await H(),K("Task assigned","success")}catch(u){console.error("Assign task error:",(u==null?void 0:u.message)||u),K("Failed to assign task","error")}finally{be(u=>({...u,[i]:!1}))}},Ce=({label:n,value:i,max:u})=>{const O=L(i),C=L(u),W=C>0?Math.round(O/C*100):0;return a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between text-xs text-gray-600 dark:text-slate-300",children:[a.jsx("span",{children:n}),a.jsx("span",{className:"tabular-nums",children:O.toLocaleString()})]}),a.jsx("div",{className:"h-2 w-full bg-gray-100 dark:bg-slate-800 rounded",children:a.jsx("div",{className:"h-2 rounded transition-[width] duration-500",style:{width:`${W}%`,backgroundColor:"currentColor"}})})]})},Vt=({className:n=""})=>a.jsx("div",{className:`animate-pulse bg-gray-100 dark:bg-slate-800/50 rounded ${n}`}),Ut=()=>{const n=N.flatMap(i=>(i.attachments||[]).map(u=>u.fileUrl)).filter(Boolean);n.length!==0&&(n.forEach((i,u)=>{setTimeout(()=>window.open(i,"_blank","noopener,noreferrer"),u*150)}),K(`Opening ${n.length} attachment${n.length>1?"s":""}…`,"info"))},y=t?{grid:"#334155",axis:"#cbd5e1",legend:"#e2e8f0",tooltipBg:"#0b1220",tooltipText:"#e2e8f0",bar1:"#60a5fa",bar2:"#34d399"}:{grid:"#e2e8f0",axis:"#334155",legend:"#334155",tooltipBg:"#ffffff",tooltipText:"#0f172a",bar1:"#2563eb",bar2:"#10b981"},Qe=k?Math.max(0,Math.floor((k-m)/1e3)):0,qt=String(Math.floor(Qe/60)).padStart(2,"0"),Gt=String(Qe%60).padStart(2,"0");return a.jsxs("div",{className:"space-y-6",children:[a.jsx("style",{children:`
        /* Select: remove native arrow across browsers */
        select.ms-select {
          -webkit-appearance: none;
          -moz-appearance: none;
          appearance: none;
          background-image: none !important;
        }
        /* Legacy Edge/IE */
        select.ms-select::-ms-expand { display: none; }

        /* Date input: hide native calendar button so our icon is the only one */
        input.ms-date[type="date"] {
          -webkit-appearance: none;
          appearance: none;
          background-image: none !important;
        }
        input.ms-date[type="date"]::-webkit-calendar-picker-indicator {
          opacity: 0;
          display: none;
        }
      `}),a.jsxs("div",{className:"rounded-2xl bg-white/90 dark:bg-slate-900/85 backdrop-blur supports-[backdrop-filter]:backdrop-blur-sm border border-slate-200 dark:border-slate-800 p-4 md:p-6",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-end md:justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl md:text-3xl font-extrabold text-slate-900 dark:text-white tracking-tight",children:"Dashboard"}),a.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300 mt-1",children:"Quick snapshot of borrowers, loans, repayments and savings."}),a.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-300/90 mt-1",children:j?`Last updated ${j.toLocaleString()}`:"Loading…"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsxs(he,{"aria-label":"Filter by branch",value:h,onChange:n=>b(n.target.value),className:"min-w-[11rem]",children:[a.jsx("option",{value:"",children:"All Branches"}),s.map(n=>a.jsx("option",{value:n.id,children:n.name},n.id))]}),a.jsxs(he,{"aria-label":"Filter by loan officer",value:x,onChange:n=>p(n.target.value),className:"min-w-[12rem]",children:[a.jsx("option",{value:"",children:"All Loan Officers"}),d.map(n=>a.jsx("option",{value:n.id,children:n.name||n.email},n.id))]}),a.jsxs(he,{"aria-label":"Filter by time range",value:g,onChange:n=>v(n.target.value),className:"min-w-[10rem]",children:[a.jsx("option",{value:"",children:"All Time"}),a.jsx("option",{value:"today",children:"Today"}),a.jsx("option",{value:"week",children:"This Week"}),a.jsx("option",{value:"month",children:"This Month"}),a.jsx("option",{value:"quarter",children:"This Quarter"}),a.jsx("option",{value:"semiAnnual",children:"Semi-Annual"}),a.jsx("option",{value:"annual",children:"Annual"})]}),a.jsxs(he,{"aria-label":"Auto refresh interval",value:f,onChange:n=>A(Number(n.target.value)),className:"min-w-[12rem]",children:[a.jsx("option",{value:0,children:"No Auto-Refresh"}),a.jsx("option",{value:1,children:"Every 1 min"}),a.jsx("option",{value:5,children:"Every 5 mins"}),a.jsx("option",{value:15,children:"Every 15 mins"})]}),a.jsx("button",{className:`ms-btn h-10 px-3.5 sm:px-4 inline-flex items-center justify-center whitespace-nowrap shrink-0
                         bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 border border-slate-300 dark:border-slate-700
                         hover:bg-slate-50 dark:hover:bg-slate-800/80 rounded-lg`,onClick:()=>{const n=new AbortController;Promise.all([Ie(n.signal),H({page:1},n.signal),Oe(n.signal),me(n.signal)]).then(()=>{Z(1),P(new Date),f>0&&w(Date.now()+f*6e4),K("Dashboard refreshed","success")}).catch(()=>K("Refresh failed","error")).finally(()=>n.abort())},"aria-label":"Refresh dashboard",children:"Refresh"})]})]}),f>0&&k&&a.jsxs("div",{className:"mt-3 inline-flex items-center gap-2 rounded-full border border-slate-200 dark:border-slate-700 px-2.5 py-1 text-xs text-slate-700 dark:text-slate-200",children:["Auto-refresh in ",qt,":",Gt]})]}),a.jsx("div",{className:"fixed right-4 top-4 z-50 space-y-2",children:Ft.map(n=>a.jsx("div",{className:`px-3 py-2 rounded shadow text-sm text-white ${n.type==="error"?"bg-red-600":n.type==="success"?"bg-emerald-600":"bg-slate-800"}`,children:n.msg},n.id))}),((N==null?void 0:N.length)??0)>0&&a.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b bg-gray-50 dark:bg-slate-800/60 dark:border-slate-700",children:[a.jsx("div",{className:"text-xs font-semibold text-gray-700 dark:text-slate-200",children:"General Communications"}),N.some(n=>Array.isArray(n.attachments)&&n.attachments.length>0)&&a.jsxs("button",{onClick:Ut,className:"text-xs flex items-center gap-1 border rounded px-2 py-1 dark:border-slate-700 dark:hover:bg-slate-800",title:"Open all attachments",disabled:D,children:[a.jsx(Ht,{className:"w-3 h-3"})," Download all"]})]}),a.jsxs("div",{className:"relative h-10",children:[a.jsx("style",{children:"@keyframes ms-marquee{0%{transform:translateX(100%)}100%{transform:translateX(-100%)}}"}),a.jsx("div",{className:"absolute whitespace-nowrap will-change-transform text-sm text-gray-800 dark:text-slate-100 flex items-center gap-8 px-3",style:{animation:"ms-marquee 18s linear infinite"},children:N.map((n,i)=>a.jsxs("span",{className:"inline-flex items-center gap-2",children:[n.type&&a.jsx("span",{className:"text-[11px] px-1.5 py-0.5 border rounded bg-gray-50 dark:bg-slate-800 dark:border-slate-700 dark:text-slate-200",children:n.type}),n.priority&&a.jsx("span",{className:"text-[11px] px-1.5 py-0.5 border rounded bg-gray-50 dark:bg-slate-800 dark:border-slate-700 dark:text-slate-200",children:n.priority}),n.audienceRole&&a.jsxs("span",{className:"text-[11px] px-1.5 py-0.5 border rounded bg-gray-50 dark:bg-slate-800 dark:border-slate-700 dark:text-slate-200",children:["role: ",n.audienceRole]}),typeof n.audienceBranchId<"u"&&n.audienceBranchId!==null&&a.jsx("span",{className:"text-[11px] px-1.5 py-0.5 border rounded bg-gray-50 dark:bg-slate-800 dark:border-slate-700 dark:text-slate-200",children:Kt(n.audienceBranchId)}),a.jsx("span",{className:"inline-block w-1.5 h-1.5 rounded-full bg-blue-500"}),a.jsx("span",{className:"truncate",children:n.text})]},n.id||n.text||i))})]})]}),a.jsxs("div",{className:"flex flex-wrap gap-3",children:[a.jsxs(je,{to:"/loans/add",className:`ms-btn px-3 py-2 flex items-center gap-2 shadow-sm rounded-lg
                     bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100
                     border border-slate-300 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-800/80`,children:[a.jsx(De,{className:"w-4 h-4"})," Add Loan"]}),a.jsxs(je,{to:"/borrowers/add",className:`ms-btn px-3 py-2 flex items-center gap-2 shadow-sm rounded-lg
                     bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100
                     border border-slate-300 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-800/80`,children:[a.jsx(De,{className:"w-4 h-4"})," Add Borrower"]}),a.jsxs(je,{to:"/repayments/new",className:`ms-btn px-3 py-2 flex items-center gap-2 shadow-sm rounded-lg
                     bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100
                     border border-slate-300 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-800/80`,children:[a.jsx(De,{className:"w-4 h-4"})," Record Repayment"]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr_360px] gap-6",children:[a.jsx("main",{className:"space-y-6",children:Mt?a.jsx("div",{className:"grid gap-6 [grid-template-columns:repeat(auto-fit,minmax(230px,1fr))]",children:Array.from({length:8}).map((n,i)=>a.jsx(Vt,{className:"h-32"},i))}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid gap-6 [grid-template-columns:repeat(auto-fit,minmax(230px,1fr))]",children:[a.jsx(T,{tone:"indigo",title:"Total Borrowers",value:L(e==null?void 0:e.totalBorrowers).toLocaleString(),icon:a.jsx(za,{className:"w-6 h-6"}),to:R(_.borrowers)}),a.jsx(T,{tone:"sky",title:"Total Loans",value:L(e==null?void 0:e.totalLoans).toLocaleString(),icon:a.jsx(Me,{className:"w-6 h-6"}),to:R(_.loans)}),a.jsx(T,{tone:"blue",title:"Total Disbursed",value:$(e==null?void 0:e.totalDisbursed),icon:a.jsx(Me,{className:"w-6 h-6"}),to:R(_.loans,{tab:"disbursed"})}),a.jsx(T,{tone:"emerald",title:"Total Paid",value:$(e==null?void 0:e.totalPaid),icon:a.jsx(te,{className:"w-6 h-6"}),to:R(_.repayments,{tab:"paid"})}),a.jsx(T,{tone:"emerald",title:"Total Repaid",value:$(e==null?void 0:e.totalRepaid),icon:a.jsx(te,{className:"w-6 h-6"}),to:R(_.repayments,{tab:"paid"})}),a.jsx(T,{tone:"indigo",title:"Expected Repayments",value:$(e==null?void 0:e.totalExpectedRepayments),icon:a.jsx(lt,{className:"w-6 h-6"}),to:R(_.expectedRepayments,{tab:"expected"})}),a.jsx(T,{tone:"cyan",title:"Total Deposits",value:$(e==null?void 0:e.totalDeposits),icon:a.jsx(te,{className:"w-6 h-6"}),to:R(_.deposits)}),a.jsx(T,{tone:"amber",title:"Total Withdrawals",value:$(e==null?void 0:e.totalWithdrawals),icon:a.jsx(te,{className:"w-6 h-6"}),to:R(_.withdrawals)}),a.jsx(T,{tone:"blue",title:"Net Savings",value:$(e==null?void 0:e.netSavings),icon:a.jsx(te,{className:"w-6 h-6"}),to:R(_.savings)}),a.jsx(T,{tone:"rose",title:"Defaulted Loan",value:$(e==null?void 0:e.defaultedLoan),icon:a.jsx(dt,{className:"w-6 h-6"}),to:R(_.defaultedLoans,{tab:"defaulted"})}),a.jsx(T,{tone:"rose",title:"Defaulted Interest",value:$(e==null?void 0:e.defaultedInterest),icon:a.jsx(dt,{className:"w-6 h-6"}),to:R(_.defaultedInterest,{tab:"defaulted-interest"})}),a.jsx(T,{tone:"violet",title:"Outstanding Loan",value:$(e==null?void 0:e.outstandingLoan),icon:a.jsx(Me,{className:"w-6 h-6"}),to:R(_.outstandingLoan,{tab:"outstanding"})}),a.jsx(T,{tone:"violet",title:"Outstanding Interest",value:$(e==null?void 0:e.outstandingInterest),icon:a.jsx(te,{className:"w-6 h-6"}),to:R(_.outstandingInterest,{tab:"outstanding-interest"})}),a.jsx(T,{tone:"slate",title:"Written Off",value:$(e==null?void 0:e.writtenOff),icon:a.jsx($a,{className:"w-6 h-6"}),to:R(_.writtenOff,{tab:"written-off"})}),a.jsx(T,{tone:"indigo",title:"PAR (Portfolio at Risk)",value:`${L(e==null?void 0:e.parPercent)}%`,icon:a.jsx(ot,{className:"w-6 h-6"}),to:R(_.par,{tab:"par"})})]}),M&&a.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-800 p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(ot,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-300"}),a.jsx("h3",{className:"font-semibold text-gray-900 dark:text-slate-100",children:`Monthly Trends${M.month||M.year?` — ${M.month||""} ${M.year||""}`:""}`})]}),a.jsx("div",{className:"mb-4",children:a.jsx(Be,{width:"100%",height:260,children:a.jsxs($e,{data:[{name:"Loans",value:L(M.monthlyLoans)},{name:"Deposits",value:L(M.monthlyDeposits)},{name:"Repayments",value:L(M.monthlyRepayments)}],children:[a.jsx(Ee,{stroke:y.grid,strokeDasharray:"3 3"}),a.jsx(Le,{dataKey:"name",tick:{fill:y.axis},axisLine:{stroke:y.axis},tickLine:{stroke:y.axis}}),a.jsx(Re,{tick:{fill:y.axis},axisLine:{stroke:y.axis},tickLine:{stroke:y.axis}}),a.jsx(_e,{contentStyle:{backgroundColor:y.tooltipBg,borderColor:y.grid,color:y.tooltipText},wrapperStyle:{outline:"none"}}),a.jsx(Te,{wrapperStyle:{color:y.legend}}),a.jsx(se,{dataKey:"value",fill:y.bar1})]})})}),(()=>{const n=[L(M.monthlyLoans),L(M.monthlyDeposits),L(M.monthlyRepayments)],i=Math.max(...n);return a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx("div",{className:"text-indigo-600 dark:text-indigo-400",children:a.jsx(Ce,{label:"Loans (count)",value:L(M.monthlyLoans),max:i})}),a.jsx("div",{className:"text-emerald-600 dark:text-emerald-400",children:a.jsx(Ce,{label:"Deposits (TZS)",value:L(M.monthlyDeposits),max:i})}),a.jsx("div",{className:"text-blue-600 dark:text-blue-400",children:a.jsx(Ce,{label:"Repayments (TZS)",value:L(M.monthlyRepayments),max:i})})]})})()]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-800 p-4 overflow-x-auto",children:[a.jsx("h3",{className:"font-semibold mb-2 text-slate-900 dark:text-slate-100",children:"Top Borrowers"}),Ge.length===0?a.jsx("p",{className:"text-gray-700 dark:text-slate-300 text-sm",children:"No data available."}):a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"text-left text-gray-700 dark:text-slate-300",children:[a.jsx("th",{className:"py-1 pr-4",children:"Name"}),a.jsx("th",{className:"py-1 pr-4",children:"Outstanding"})]})}),a.jsx("tbody",{className:"text-slate-900 dark:text-slate-100",children:Ge.map(n=>a.jsxs("tr",{className:"border-t border-slate-200 dark:border-slate-700",children:[a.jsx("td",{className:"py-1 pr-4",children:n.name}),a.jsx("td",{className:"py-1 pr-4",children:$(n.outstanding)})]},n.id))})]})]}),a.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-800 p-4 overflow-x-auto",children:[a.jsx("h3",{className:"font-semibold mb-2 text-slate-900 dark:text-slate-100",children:"Upcoming Repayments"}),He.length===0?a.jsx("p",{className:"text-gray-700 dark:text-slate-300 text-sm",children:"No data available."}):a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"text-left text-gray-700 dark:text-slate-300",children:[a.jsx("th",{className:"py-1 pr-4",children:"Borrower"}),a.jsx("th",{className:"py-1 pr-4",children:"Due Date"}),a.jsx("th",{className:"py-1 pr-4",children:"Amount"})]})}),a.jsx("tbody",{className:"text-slate-900 dark:text-slate-100",children:He.map(n=>a.jsxs("tr",{className:"border-t border-slate-200 dark:border-slate-700",children:[a.jsx("td",{className:"py-1 pr-4",children:n.borrower}),a.jsx("td",{className:"py-1 pr-4",children:n.dueDate}),a.jsx("td",{className:"py-1 pr-4",children:$(n.amount)})]},n.id))})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-800 p-4",children:[a.jsx("h3",{className:"font-semibold mb-2 text-slate-900 dark:text-slate-100",children:"Branch Performance"}),Xe.length===0?a.jsx("p",{className:"text-gray-700 dark:text-slate-300 text-sm",children:"No data available."}):a.jsx(Be,{width:"100%",height:260,children:a.jsxs($e,{data:Xe,children:[a.jsx(Ee,{stroke:y.grid,strokeDasharray:"3 3"}),a.jsx(Le,{dataKey:"branch",tick:{fill:y.axis},axisLine:{stroke:y.axis},tickLine:{stroke:y.axis}}),a.jsx(Re,{tick:{fill:y.axis},axisLine:{stroke:y.axis},tickLine:{stroke:y.axis}}),a.jsx(_e,{contentStyle:{backgroundColor:y.tooltipBg,borderColor:y.grid,color:y.tooltipText},wrapperStyle:{outline:"none"}}),a.jsx(Te,{wrapperStyle:{color:y.legend}}),a.jsx(se,{dataKey:"disbursed",fill:y.bar1}),a.jsx(se,{dataKey:"repayments",fill:y.bar2})]})})]}),a.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-800 p-4",children:[a.jsx("h3",{className:"font-semibold mb-2 text-slate-900 dark:text-slate-100",children:"Officer Performance"}),Ze.length===0?a.jsx("p",{className:"text-gray-700 dark:text-slate-300 text-sm",children:"No data available."}):a.jsx(Be,{width:"100%",height:260,children:a.jsxs($e,{data:Ze,children:[a.jsx(Ee,{stroke:y.grid,strokeDasharray:"3 3"}),a.jsx(Le,{dataKey:"officer",tick:{fill:y.axis},axisLine:{stroke:y.axis},tickLine:{stroke:y.axis}}),a.jsx(Re,{tick:{fill:y.axis},axisLine:{stroke:y.axis},tickLine:{stroke:y.axis}}),a.jsx(_e,{contentStyle:{backgroundColor:y.tooltipBg,borderColor:y.grid,color:y.tooltipText},wrapperStyle:{outline:"none"}}),a.jsx(Te,{wrapperStyle:{color:y.legend}}),a.jsx(se,{dataKey:"loans",fill:y.bar1}),a.jsx(se,{dataKey:"collections",fill:y.bar2})]})})]})]})]})}),a.jsx("aside",{className:"lg:sticky lg:top-4 self-start",children:a.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-800 p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(lt,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-300"}),a.jsx("h2",{className:"font-semibold text-slate-900 dark:text-slate-100",children:"Recent Activity"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[a.jsx(Fe,{value:ce,onChange:n=>Pe(n.target.value),className:"h-9"}),a.jsx(Fe,{value:ue,onChange:n=>Bt(n.target.value),className:"h-9"}),a.jsx("button",{className:`ms-btn col-span-2 h-9 text-sm rounded-lg
                           bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100
                           border border-slate-300 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-800/80`,onClick:()=>{Z(1),H({page:1})},children:"Search by date"})]}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-x-0 top-0 h-6 pointer-events-none bg-gradient-to-b from-white to-transparent dark:from-slate-900"}),a.jsx("div",{className:"absolute inset-x-0 bottom-0 h-6 pointer-events-none bg-gradient-to-t from-white to-transparent dark:from-slate-900"}),a.jsx("div",{className:"max-h-[520px] overflow-y-auto pr-1 space-y-3",children:V.length===0?a.jsx("p",{className:"text-gray-700 dark:text-slate-300 text-sm",children:"No activity."}):V.map(n=>{var i,u,O,C,W;return a.jsxs("div",{className:"border rounded p-3 border-slate-200 dark:border-slate-700",children:[a.jsxs("p",{className:"text-sm font-semibold text-slate-900 dark:text-slate-100",children:[n.type," • ",n.entityType," #",n.entityId]}),a.jsx("p",{className:"text-xs text-slate-800 dark:text-slate-200 break-words",children:n.message}),a.jsxs("p",{className:"text-[11px] text-slate-600 dark:text-slate-400 mt-1",children:["by ",((i=n.createdBy)==null?void 0:i.name)||((u=n.createdBy)==null?void 0:u.email)," • ",new Date(n.createdAt).toLocaleString()]}),Array.isArray(n.comments)&&n.comments.length>0&&a.jsx("div",{className:"mt-2 space-y-1",children:n.comments.map(B=>{var z,et;return a.jsxs("div",{className:"bg-gray-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded p-2",children:[a.jsx("p",{className:"text-xs text-gray-900 dark:text-slate-100 break-words",children:B.comment}),a.jsxs("p",{className:"text-[11px] text-gray-600 dark:text-slate-400 mt-0.5",children:["— ",((z=B.createdBy)==null?void 0:z.name)||((et=B.createdBy)==null?void 0:et.email)," • ",new Date(B.createdAt).toLocaleString()]})]},B.id)})}),a.jsxs("div",{className:"mt-2 flex gap-2",children:[a.jsx(gt,{value:Ve[n.id]||"",onChange:B=>Ue(z=>({...z,[n.id]:B.target.value})),placeholder:"Reply…",className:"flex-1 h-9 text-xs"}),a.jsxs("button",{onClick:()=>zt(n.id),disabled:qe[`c-${n.id}`],className:`ms-btn h-9 px-2 text-xs disabled:opacity-50 flex items-center gap-1 rounded-lg
                                     bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100
                                     border border-slate-300 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-800/80`,children:[a.jsx(Ta,{className:"w-3 h-3"})," Reply"]})]}),a.jsxs("div",{className:"mt-2 grid grid-cols-4 gap-2",children:[a.jsxs(he,{value:((O=ge[n.id])==null?void 0:O.assigneeId)||"",onChange:B=>fe(z=>({...z,[n.id]:{...z[n.id]||{},assigneeId:B.target.value}})),className:"col-span-2 h-9 text-xs",children:[a.jsx("option",{value:"",children:"Assign to…"}),d.map(B=>a.jsx("option",{value:B.id,children:B.name||B.email},B.id))]}),a.jsx(Fe,{value:((C=ge[n.id])==null?void 0:C.dueDate)||"",onChange:B=>fe(z=>({...z,[n.id]:{...z[n.id]||{},dueDate:B.target.value}})),className:"h-9 text-xs"}),a.jsxs("button",{onClick:()=>Wt(n.id),disabled:qe[`a-${n.id}`],className:`ms-btn h-9 px-2 text-xs disabled:opacity-50 flex items-center justify-center gap-1 rounded-lg
                                     bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100
                                     border border-slate-300 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-800/80`,children:[a.jsx(Ia,{className:"w-3 h-3"})," Assign"]}),a.jsx(gt,{value:((W=ge[n.id])==null?void 0:W.note)||"",onChange:B=>fe(z=>({...z,[n.id]:{...z[n.id]||{},note:B.target.value}})),placeholder:"Note…",className:"col-span-4 h-9 text-xs"})]})]},n.id)})})]}),q>G&&a.jsxs("div",{className:"flex justify-between items-center mt-3 text-xs text-slate-800 dark:text-slate-200",children:[a.jsxs("span",{children:[Math.min(F*G,q)," of ",q]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>{const n=Math.max(F-1,1);Z(n),H({page:n})},disabled:F===1,className:`ms-btn px-2 py-1 disabled:opacity-50 rounded-lg
                               bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100
                               border border-slate-300 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-800/80`,children:"Prev"}),a.jsx("button",{onClick:()=>{const n=F*G<q?F+1:F;n!==F&&(Z(n),H({page:n}))},disabled:F*G>=q,className:`ms-btn px-2 py-1 disabled:opacity-50 rounded-lg
                               bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100
                               border border-slate-300 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-800/80`,children:"Next"})]})]})]})})]})]})},T=({title:t,value:e,icon:r,tone:s="indigo",to:o=null,delta:d=null,deltaLabel:c="",spark:h=null})=>{const b={indigo:{bg:"from-indigo-50 to-white dark:from-slate-900 dark:to-slate-900",ring:"ring-indigo-100 dark:ring-indigo-900/40",ink:"text-indigo-700 dark:text-indigo-300",badge:"bg-indigo-600/10 text-indigo-600 dark:text-indigo-300",spot:"bg-indigo-400/20"},sky:{bg:"from-sky-50 to-white dark:from-slate-900 dark:to-slate-900",ring:"ring-sky-100 dark:ring-sky-900/40",ink:"text-sky-700 dark:text-sky-300",badge:"bg-sky-600/10 text-sky-600 dark:text-sky-300",spot:"bg-sky-400/20"},blue:{bg:"from-blue-50 to-white dark:from-slate-900 dark:to-slate-900",ring:"ring-blue-100 dark:ring-blue-900/40",ink:"text-blue-700 dark:text-blue-300",badge:"bg-blue-600/10 text-blue-600 dark:text-blue-300",spot:"bg-blue-400/20"},emerald:{bg:"from-emerald-50 to-white dark:from-slate-900 dark:to-slate-900",ring:"ring-emerald-100 dark:ring-emerald-900/40",ink:"text-emerald-700 dark:text-emerald-300",badge:"bg-emerald-600/10 text-emerald-600 dark:text-emerald-300",spot:"bg-emerald-400/20"},cyan:{bg:"from-cyan-50 to-white dark:from-slate-900 dark:to-slate-900",ring:"ring-cyan-100 dark:ring-cyan-900/40",ink:"text-cyan-700 dark:text-cyan-300",badge:"bg-cyan-600/10 text-cyan-600 dark:text-cyan-300",spot:"bg-cyan-400/20"},amber:{bg:"from-amber-50 to-white dark:from-slate-900 dark:to-slate-900",ring:"ring-amber-100 dark:ring-amber-900/40",ink:"text-amber-700 dark:text-amber-300",badge:"bg-amber-600/10 text-amber-600 dark:text-amber-300",spot:"bg-amber-400/20"},violet:{bg:"from-violet-50 to-white dark:from-slate-900 dark:to-slate-900",ring:"ring-violet-100 dark:ring-violet-900/40",ink:"text-violet-700 dark:text-violet-300",badge:"bg-violet-600/10 text-violet-600 dark:text-violet-300",spot:"bg-violet-400/20"},rose:{bg:"from-rose-50 to-white dark:from-slate-900 dark:to-slate-900",ring:"ring-rose-100 dark:ring-rose-900/40",ink:"text-rose-700 dark:text-rose-300",badge:"bg-rose-600/10 text-rose-600 dark:text-rose-300",spot:"bg-rose-400/20"},slate:{bg:"from-slate-50 to-white dark:from-slate-900 dark:to-slate-900",ring:"ring-slate-100 dark:ring-slate-800/60",ink:"text-slate-700 dark:text-slate-300",badge:"bg-slate-600/10 text-slate-600 dark:text-slate-300",spot:"bg-slate-400/20"}}[s]||{bg:"from-slate-50 to-white dark:from-slate-900 dark:to-slate-900",ring:"ring-slate-100 dark:ring-slate-800/60",ink:"text-slate-700 dark:text-slate-300",badge:"bg-slate-600/10 text-slate-600 dark:text-slate-300",spot:"bg-slate-400/20"},x=()=>{if(!Array.isArray(h)||h.length<2)return null;const g=96,v=28,f=2,A=Math.min(...h),j=Math.max(...h),P=Math.max(j-A,1e-6),k=(g-f*2)/(h.length-1),w="M "+h.map((m,S)=>{const N=(f+S*k).toFixed(1),I=(v-f-(m-A)/P*(v-f*2)).toFixed(1);return`${N} ${I}`}).join(" L ");return a.jsx("svg",{width:g,height:v,className:"mt-2 opacity-70",children:a.jsx("path",{d:w,fill:"none",stroke:"currentColor",strokeWidth:"2"})})},p=d==null?"":d>=0?"text-emerald-700 dark:text-emerald-300 bg-emerald-600/10":"text-rose-700 dark:text-rose-300 bg-rose-600/10";return a.jsxs("div",{className:"group relative",children:[o&&a.jsx(je,{to:o,className:"absolute inset-0 z-10 rounded-xl focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500","aria-label":`View ${t} details`,title:`View ${t} details`}),a.jsxs("div",{className:["relative rounded-xl p-5 min-h-[10.5rem] shadow-sm transition-all","bg-gradient-to-br",b.bg,"ring-1",b.ring,o?"hover:shadow-md hover:-translate-y-0.5":""].join(" "),children:[a.jsx("div",{className:`pointer-events-none absolute -top-6 -right-6 h-24 w-24 rounded-full blur-2xl ${b.spot}`}),a.jsxs("div",{className:"relative flex items-start justify-between gap-3",children:[a.jsx("div",{className:`p-3 rounded-full ${b.badge}`,children:r}),d!=null&&a.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[11px] font-medium ${p}`,children:[d>=0?"↑":"↓"," ",Math.abs(d).toLocaleString(),"%",c&&a.jsxs("span",{className:"opacity-70",children:[" ",c]})]})]}),a.jsxs("div",{className:"relative mt-3 min-w-0",children:[a.jsx("h3",{className:`text-sm font-medium ${b.ink} truncate`,children:t}),a.jsx("p",{className:"text-[28px] md:text-[32px] leading-tight font-semibold text-slate-900 dark:text-white font-mono tabular-nums break-words",children:e??"—"})]}),a.jsx("div",{className:"relative text-slate-400 dark:text-slate-500",children:a.jsx(x,{})})]})]})};export{rs as default};
