import{r as o,j as e,E as k,L as v,y,b as w}from"./index-Du_APKB5.js";const h=l=>{const r=Number(l);return Number.isFinite(r)?`TZS ${r.toLocaleString()}`:"TZS —"},c=l=>{if(!l)return"—";const r=new Date(l);return Number.isNaN(r.getTime())?l:r.toLocaleDateString()};function L(){const[l,r]=o.useState(!0),[b,u]=o.useState(""),[x,j]=o.useState([]),[m,N]=o.useState(""),g=async()=>{var t,a,d,n;r(!0),u("");try{const s=await w.get("/payroll"),f=Array.isArray(s.data)?s.data:((t=s.data)==null?void 0:t.items)||((a=s.data)==null?void 0:a.data)||[];j(f)}catch(s){u(((n=(d=s==null?void 0:s.response)==null?void 0:d.data)==null?void 0:n.error)||(s==null?void 0:s.message)||"Failed to load payroll data.")}finally{r(!1)}};o.useEffect(()=>{g()},[]);const i=o.useMemo(()=>{const t=m.trim().toLowerCase();return t?x.filter(a=>{const d=String(a.period||"").toLowerCase(),n=String(a.notes||"").toLowerCase(),s=String(a.branchName||"").toLowerCase();return d.includes(t)||n.includes(t)||s.includes(t)}):x},[x,m]),p=o.useMemo(()=>{let t=0,a=0;for(const d of i)t+=Number(d.staffCount)||0,a+=Number(d.total)||0;return{staff:t,total:a}},[i]);return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-slate-800 dark:text-slate-100",children:"Payroll"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Review payroll periods, headcount and totals."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"relative",children:e.jsx("input",{value:m,onChange:t=>N(t.target.value),placeholder:"Filter by period (YYYY-MM) or text…",className:"w-64 max-w-[70vw] px-3 py-2 text-sm rounded-md border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:outline-none focus:ring-2 focus:ring-blue-200 dark:focus:ring-blue-800"})}),e.jsxs("button",{onClick:g,className:"inline-flex items-center gap-2 h-9 px-3 rounded-md border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-800/80 text-sm",children:[e.jsx(k,{})," Refresh"]}),e.jsxs(v,{to:"/payroll/add",className:"inline-flex items-center gap-2 h-9 px-3 rounded-md bg-blue-600 text-white hover:bg-blue-700 text-sm",children:[e.jsx(y,{})," Add Payroll"]})]})]})}),b&&e.jsx("div",{className:"rounded-xl border border-rose-200 dark:border-rose-900/40 bg-rose-50 dark:bg-rose-900/20 text-rose-800 dark:text-rose-200 p-3 text-sm",children:b}),l?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-3",children:Array.from({length:6}).map((t,a)=>e.jsx("div",{className:"h-24 rounded-xl bg-slate-100 dark:bg-slate-800 animate-pulse"},a))}):i.length===0?e.jsx("div",{className:"rounded-xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-6 text-sm text-slate-600 dark:text-slate-400",children:"No payroll records found."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-4",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500 dark:text-slate-400",children:"Periods"}),e.jsx("div",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:i.length.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500 dark:text-slate-400",children:"Staff (sum)"}),e.jsx("div",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:p.staff.toLocaleString()})]}),e.jsxs("div",{className:"col-span-2 md:col-span-2",children:[e.jsx("div",{className:"text-slate-500 dark:text-slate-400",children:"Total (sum)"}),e.jsx("div",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:h(p.total)})]})]})}),e.jsx("div",{className:"grid gap-3 md:hidden",children:i.map(t=>e.jsxs("div",{className:"rounded-xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"font-semibold text-slate-900 dark:text-slate-100",children:["Period: ",t.period||"—"]}),e.jsxs("div",{className:"text-slate-600 dark:text-slate-400",children:["Staff: ",Number(t.staffCount||0).toLocaleString()]})]}),e.jsx("div",{className:"text-right text-sm font-semibold text-slate-900 dark:text-slate-100",children:h(t.total)})]}),t.processedAt||t.paidAt?e.jsxs("div",{className:"mt-2 text-xs text-slate-500 dark:text-slate-400",children:[t.processedAt&&e.jsxs(e.Fragment,{children:["Processed: ",c(t.processedAt)," "]}),t.paidAt&&e.jsxs("span",{className:"ml-2",children:["Paid: ",c(t.paidAt)]})]}):null,t.notes&&e.jsx("div",{className:"mt-2 text-xs text-slate-600 dark:text-slate-300",children:t.notes})]},t.id||t.period))}),e.jsx("div",{className:"hidden md:block rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left border-b border-slate-200 dark:border-slate-800 text-slate-500 dark:text-slate-400",children:[e.jsx("th",{className:"py-2 px-3",children:"Period"}),e.jsx("th",{className:"py-2 px-3",children:"Staff"}),e.jsx("th",{className:"py-2 px-3",children:"Total"}),e.jsx("th",{className:"py-2 px-3",children:"Processed"}),e.jsx("th",{className:"py-2 px-3",children:"Paid"}),e.jsx("th",{className:"py-2 px-3",children:"Branch"}),e.jsx("th",{className:"py-2 px-3",children:"Notes"})]})}),e.jsx("tbody",{children:i.map(t=>e.jsxs("tr",{className:"border-b border-slate-100 dark:border-slate-800",children:[e.jsx("td",{className:"py-2 px-3 font-medium text-slate-900 dark:text-slate-100",children:t.period||"—"}),e.jsx("td",{className:"py-2 px-3",children:Number(t.staffCount||0).toLocaleString()}),e.jsx("td",{className:"py-2 px-3",children:h(t.total)}),e.jsx("td",{className:"py-2 px-3",children:c(t.processedAt)}),e.jsx("td",{className:"py-2 px-3",children:c(t.paidAt)}),e.jsx("td",{className:"py-2 px-3",children:t.branchName||"—"}),e.jsx("td",{className:"py-2 px-3 whitespace-pre-wrap max-w-[420px]",children:t.notes||"—"})]},t.id||t.period))})]})})]})]})}export{L as default};
