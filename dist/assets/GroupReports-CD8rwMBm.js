import{r as l,j as t,g}from"./index-8DtxmKky.js";function i(s){const r=(s.startsWith("/")?s:`/${s}`).replace(/^\/api\//,"/"),n=r.startsWith("/api/")?r:`/api${r}`;return Array.from(new Set([r,n]))}async function f(s=[],e={}){let r;for(const n of s)try{const a=await g.get(n,e);return a==null?void 0:a.data}catch(a){r=a}throw r||new Error("No endpoint succeeded")}function b(s){const e=(s==null?void 0:s.summary)||s||{},r=a=>Number(a||0),n=a=>typeof a=="string"&&a.trim().endsWith("%")?a:`${Number(a||0).toFixed(2).replace(/\.00$/,"")}%`;return{totalGroups:r(e.totalGroups??e.groups??e.count),activeGroups:r(e.activeGroups??e.active??e.enabled),totalLoans:r(e.totalLoans??e.groupLoans??e.loans),par:n(e.par??e.portfolioAtRisk??e.par30??0)}}const j="w-full px-4 md:px-6 lg:px-8 py-6 min-h-screen bg-white text-slate-900",h="rounded-2xl border-2 border-slate-400 bg-white shadow-lg",c=`${h} p-4`,v=()=>{const[s,e]=l.useState({totalGroups:0,activeGroups:0,totalLoans:0,par:"0%"}),[r,n]=l.useState(!0),[a,d]=l.useState(""),p=async()=>{var m,x,u;try{n(!0),d("");const o=await f([...i("borrowers/groups/reports/summary"),...i("groups/reports/summary"),...i("borrower-groups/reports/summary")]);e(b(o))}catch(o){d(((m=o==null?void 0:o.response)==null?void 0:m.status)===404?"Group report endpoint not implemented.":((u=(x=o==null?void 0:o.response)==null?void 0:x.data)==null?void 0:u.error)||(o==null?void 0:o.message)||"Failed to load group report data."),e({totalGroups:0,activeGroups:0,totalLoans:0,par:"0%"})}finally{n(!1)}};return l.useEffect(()=>{p()},[]),t.jsxs("div",{className:j,children:[t.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[t.jsx("h1",{className:"text-3xl font-extrabold tracking-tight",children:"Group Reports"}),t.jsx("button",{onClick:p,className:"px-3 py-2 rounded-lg border-2 border-slate-400 bg-white hover:bg-slate-50 font-semibold",children:"Refresh"})]}),r?t.jsx("p",{className:"text-slate-700",children:"Loading group analytics..."}):a?t.jsx("p",{className:"text-rose-700",children:a}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:c,children:[t.jsx("div",{className:"text-[12px] font-semibold uppercase tracking-wider text-slate-700",children:"Total Groups"}),t.jsx("div",{className:"mt-1 text-2xl font-extrabold",children:s.totalGroups||0})]}),t.jsxs("div",{className:c,children:[t.jsx("div",{className:"text-[12px] font-semibold uppercase tracking-wider text-slate-700",children:"Active Groups"}),t.jsx("div",{className:"mt-1 text-2xl font-extrabold",children:s.activeGroups||0})]}),t.jsxs("div",{className:c,children:[t.jsx("div",{className:"text-[12px] font-semibold uppercase tracking-wider text-slate-700",children:"Total Group Loans"}),t.jsx("div",{className:"mt-1 text-2xl font-extrabold",children:Number(s.totalLoans||0).toLocaleString()})]}),t.jsxs("div",{className:c,children:[t.jsx("div",{className:"text-[12px] font-semibold uppercase tracking-wider text-slate-700",children:"PAR"}),t.jsx("div",{className:"mt-1 text-2xl font-extrabold text-rose-700",children:s.par||"0%"})]})]}),t.jsx("div",{className:`${h} p-4 mt-4`,children:t.jsx("p",{className:"text-sm text-slate-700",children:"Charts and trends (by branch, officer, performance tiers) will appear here once backend analytics endpoints are available."})})]})]})};export{v as default};
