import{r as s,b as E}from"./index-BtuSn5tU.js";function F(o,h,j){let r,i,u;typeof o=="string"?(r=o,i=h||o,u=j||{}):o&&typeof o=="object"&&(r=o.getUrl,i=o.putUrl||o.getUrl,u=o.initial||{});const c=s.useRef(!0),[l,f]=s.useState(u),[g,m]=s.useState(!!r),[S,w]=s.useState(!1),[U,d]=s.useState(""),p=s.useCallback(n=>{const t=(n==null?void 0:n.data)??n;return t&&typeof t=="object"&&"data"in t&&t.data!=null?t.data:t},[]),y=s.useCallback(async()=>{var n,t;if(r){m(!0),d("");try{const a=await E.get(r),e=p(a);c.current&&f(e??{})}catch(a){c.current&&d(((t=(n=a==null?void 0:a.response)==null?void 0:n.data)==null?void 0:t.error)||(a==null?void 0:a.message)||"Failed to load settings")}finally{c.current&&m(!1)}}},[r,p]),k=s.useCallback(async n=>{var t,a;w(!0),d("");try{const e=n?{...l,...n}:l,b=await E.put(i||r,e),C=p(b);return c.current&&f(C??e??{}),C??e??{}}catch(e){const b=((a=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:a.error)||(e==null?void 0:e.message)||"Failed to save settings";throw c.current&&d(b),new Error(b)}finally{c.current&&w(!1)}},[l,r,i,p]),v=s.useCallback(()=>f(u),[u]);return s.useEffect(()=>(c.current=!0,r&&y(),()=>{c.current=!1}),[r]),s.useMemo(()=>({data:l,setData:f,loading:g,saving:S,error:U,load:y,reload:y,save:k,reset:v}),[l,g,S,U,y,k,v])}export{F as u};
