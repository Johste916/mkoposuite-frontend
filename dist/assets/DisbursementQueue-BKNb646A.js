import{r as c,j as e,g as p}from"./index-BVbJtkKt.js";const t={wrap:"w-full px-4 md:px-6 lg:px-8 py-6 bg-[var(--bg)] text-[var(--fg)]",h1:"text-3xl font-extrabold tracking-tight",sub:"text-sm text-[var(--muted)]",card:"card overflow-hidden",tableWrap:"table-wrap table-frame",th:"bg-[var(--table-head-bg)] text-left text-[12px] uppercase tracking-wide text-[var(--fg)]/90 font-semibold px-3 py-2 border border-[var(--border)] select-none",td:"px-3 py-2 border border-[var(--border)] text-sm text-[var(--fg)]",btn:"inline-flex items-center justify-center rounded-lg border-2 border-[var(--border-strong)] px-3 py-2 bg-[var(--card)] text-[var(--fg)] hover:bg-[var(--chip-soft)] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[var(--ring)] focus-visible:ring-offset-2 focus-visible:ring-offset-[var(--bg)]"},b=(r,n="TZS")=>`‎${n} ${Number(r||0).toLocaleString()}`,f=r=>r?new Date(r).toLocaleDateString():"—";function v(){var h;const[r,n]=c.useState([]),[i,o]=c.useState(!0),[x,u]=c.useState(null),m=async()=>{var s;o(!0);try{const a=await p.get("/loans",{params:{status:"approved"}}),l=Array.isArray(a.data)?a.data:((s=a.data)==null?void 0:s.items)||[];n((l||[]).filter(d=>(d.status||"").toLowerCase()==="approved"))}catch{n([])}finally{o(!1),u(new Date)}};return c.useEffect(()=>{m()},[]),e.jsxs("div",{className:t.wrap,children:[e.jsxs("div",{className:"flex items-end justify-between gap-3 mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:t.h1,children:"Disbursement Queue"}),e.jsx("p",{className:t.sub,children:"Loans awaiting disbursement."}),x&&e.jsxs("p",{className:"text-xs text-[var(--muted)] mt-1",children:["Last updated ",x.toLocaleString()]})]}),e.jsx("button",{onClick:m,className:t.btn,title:"Refresh",children:"Refresh"})]}),e.jsxs("div",{className:`${t.card}`,children:[e.jsx("div",{className:`${t.tableWrap}`,children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:t.th,children:"Ref"}),e.jsx("th",{className:t.th,children:"Borrower"}),e.jsx("th",{className:t.th,children:"Amount"}),e.jsx("th",{className:t.th,children:"Approved On"})]})}),e.jsx("tbody",{children:i?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:`${t.td} text-center py-10 text-[var(--muted)]`,children:"Loading…"})}):r.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:`${t.td} text-center py-10 text-[var(--muted)]`,children:"Empty"})}):r.map((s,a)=>{var l,d;return e.jsxs("tr",{className:`transition-colors ${a%2===0?"bg-[var(--table-row-even)]":"bg-[var(--table-row-odd)]"} hover:bg-[var(--chip-soft)]`,children:[e.jsx("td",{className:t.td,children:s.reference||`L-${s.id}`}),e.jsx("td",{className:t.td,children:((l=s.Borrower)==null?void 0:l.name)||"—"}),e.jsx("td",{className:`${t.td} text-right tabular-nums`,children:b(s.amount,s.currency||"TZS")}),e.jsx("td",{className:t.td,children:f((d=s.approvalDate)==null?void 0:d.slice(0,10))})]},s.id)})})]})}),!i&&r.length>0&&e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-t-2 border-[var(--border-strong)] text-sm",children:[e.jsxs("span",{className:"text-[var(--fg)]",children:[r.length.toLocaleString()," ready for disbursement"]}),e.jsxs("span",{className:"text-[var(--fg)]",children:["Total"," ",b(r.reduce((s,a)=>s+Number(a.amount||0),0),((h=r[0])==null?void 0:h.currency)||"TZS")]})]})]})]})}export{v as default};
