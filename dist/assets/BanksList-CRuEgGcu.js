import{u as E,r,j as e,L,g as u}from"./index-BR01ehMu.js";import{C as M}from"./circle-plus-COBKKW-7.js";import{c as h}from"./createLucideIcon-S-tXfS_2.js";/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],_=h("eye",S);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],T=h("pencil",B);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],R=h("trash-2",D),$="bg-white rounded-2xl shadow-sm ring-1 ring-black/5 p-5 md:p-7",z="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500/40 focus:border-indigo-500 transition-all";function H(){const l=E(),[c,n]=r.useState([]),[f,p]=r.useState({}),[k,x]=r.useState(!0),[o,v]=r.useState(""),i=r.useRef(),d=async s=>{var a,N,j;x(!0);try{const[t,m]=await Promise.all([u.get("/banks",{params:{search:o},signal:s}),u.get("/banks/__internal/overview",{signal:s})]),A=Array.isArray(t.data)?t.data:Array.isArray((a=t.data)==null?void 0:a.items)?t.data.items:Array.isArray((N=t.data)==null?void 0:N.rows)?t.data.rows:[];n(A);const g={},C=((j=m==null?void 0:m.data)==null?void 0:j.items)||[];for(const b of C)g[b.bankId]=b;p(g)}catch(t){if((t==null?void 0:t.code)==="ERR_CANCELED")return;console.error(t),n([]),p({})}finally{x(!1)}};r.useEffect(()=>{const s=new AbortController;return d(s.signal),()=>s.abort()},[]),r.useEffect(()=>{i.current&&clearTimeout(i.current);const s=new AbortController;return i.current=setTimeout(()=>d(s.signal),350),()=>{clearTimeout(i.current),s.abort()}},[o]);const w=async s=>{if(window.confirm("Delete this bank?"))try{await u.delete(`/banks/${s}`);const a=new AbortController;await d(a.signal),a.abort()}catch(a){console.error(a),alert((a==null?void 0:a.normalizedMessage)||"Failed to delete bank")}},y=r.useMemo(()=>Array.isArray(c)?c:[],[c]);return e.jsxs("div",{className:"p-4 md:p-6 lg:p-8",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:"Banks"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Tenant-scoped bank & balance overview (disbursements, repayments, transfers)."})]}),e.jsxs(L,{to:"/banks/add",className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg border hover:bg-gray-50",children:[e.jsx(M,{className:"h-4 w-4"})," Add Bank"]})]}),e.jsxs("section",{className:$,children:[e.jsx("div",{className:"mb-3",children:e.jsx("input",{className:z,placeholder:"Search by name, code, account…",value:o,onChange:s=>v(s.target.value),"aria-label":"Search banks"})}),k?e.jsx("p",{className:"text-sm text-gray-500",children:"Loading…"}):y.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No banks found. Click “Add Bank” to create one."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-600",children:[e.jsx("th",{className:"py-2 pr-4",children:"Name"}),e.jsx("th",{className:"py-2 pr-4",children:"Code"}),e.jsx("th",{className:"py-2 pr-4",children:"Branch"}),e.jsx("th",{className:"py-2 pr-4",children:"Account Name"}),e.jsx("th",{className:"py-2 pr-4",children:"Account #"}),e.jsx("th",{className:"py-2 pr-4",children:"Currency"}),e.jsx("th",{className:"py-2 pr-4",children:"Current"}),e.jsx("th",{className:"py-2 pr-4"})]})}),e.jsx("tbody",{children:y.map(s=>{const a=f[s.id]||{};return e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"py-2 pr-4",children:s.name}),e.jsx("td",{className:"py-2 pr-4",children:s.code||"—"}),e.jsx("td",{className:"py-2 pr-4",children:s.branch||"—"}),e.jsx("td",{className:"py-2 pr-4",children:s.accountName||"—"}),e.jsx("td",{className:"py-2 pr-4",children:s.accountNumber||"—"}),e.jsx("td",{className:"py-2 pr-4",children:s.currency||"—"}),e.jsx("td",{className:"py-2 pr-4 font-medium",children:a.current!=null?F(a.current,s.currency):"—"}),e.jsx("td",{className:"py-2 pr-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>l(`/banks/${s.id}`),className:"px-2 py-1 rounded border hover:bg-gray-50 inline-flex items-center gap-1",title:"View",children:[e.jsx(_,{className:"h-4 w-4"})," View"]}),e.jsxs("button",{onClick:()=>l(`/banks/${s.id}/edit`),className:"px-2 py-1 rounded border hover:bg-gray-50 inline-flex items-center gap-1",title:"Edit",children:[e.jsx(T,{className:"h-4 w-4"})," Edit"]}),e.jsxs("button",{onClick:()=>w(s.id),className:"px-2 py-1 rounded border hover:bg-gray-50 inline-flex items-center gap-1",title:"Delete",children:[e.jsx(R,{className:"h-4 w-4"})," Delete"]})]})})]},s.id)})})]})})]})]})}function F(l,c){const n=Number(l);if(!Number.isFinite(n))return"—";try{return new Intl.NumberFormat(void 0,{style:"currency",currency:c||"TZS"}).format(n)}catch{return n.toLocaleString()}}export{H as default};
