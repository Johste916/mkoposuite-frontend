import{r as i,j as s,g as x}from"./index-Ba7wW-0c.js";function c(e){const r=(e.startsWith("/")?e:`/${e}`).replace(/^\/api\//,"/"),n=r.startsWith("/api/")?r:`/api${r}`;return Array.from(new Set([r,n]))}async function h(e=[],t={}){let r;for(const n of e)try{const a=await x.get(n,t);return a==null?void 0:a.data}catch(a){r=a}throw r||new Error("No endpoint succeeded")}function g(e){const t=(e==null?void 0:e.summary)||e||{},r=a=>Number(a||0),n=a=>typeof a=="string"&&a.trim().endsWith("%")?a:`${Number(a||0).toFixed(2).replace(/\.00$/,"")}%`;return{totalGroups:r(t.totalGroups??t.groups??t.count),activeGroups:r(t.activeGroups??t.active??t.enabled),totalLoans:r(t.totalLoans??t.groupLoans??t.loans),par:n(t.par??t.portfolioAtRisk??t.par30??0)}}const f=()=>{const[e,t]=i.useState({totalGroups:0,activeGroups:0,totalLoans:0,par:"0%"}),[r,n]=i.useState(!0),[a,l]=i.useState(""),d=async()=>{var p,u,m;try{n(!0),l("");const o=await h([...c("borrowers/groups/reports/summary"),...c("groups/reports/summary"),...c("borrower-groups/reports/summary")]);t(g(o))}catch(o){l(((p=o==null?void 0:o.response)==null?void 0:p.status)===404?"Group report endpoint not implemented.":((m=(u=o==null?void 0:o.response)==null?void 0:u.data)==null?void 0:m.error)||(o==null?void 0:o.message)||"Failed to load group report data."),t({totalGroups:0,activeGroups:0,totalLoans:0,par:"0%"})}finally{n(!1)}};return i.useEffect(()=>{d()},[]),s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h1",{className:"text-2xl font-semibold",children:"Group Reports"}),s.jsx("button",{onClick:d,className:"px-3 py-2 rounded bg-slate-100 hover:bg-slate-200",children:"Refresh"})]}),r?s.jsx("p",{className:"text-gray-500",children:"Loading group analytics..."}):a?s.jsx("p",{className:"text-red-600",children:a}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-white rounded shadow p-4",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"Total Groups"}),s.jsx("div",{className:"text-xl font-semibold",children:e.totalGroups||0})]}),s.jsxs("div",{className:"bg-white rounded shadow p-4",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"Active Groups"}),s.jsx("div",{className:"text-xl font-semibold",children:e.activeGroups||0})]}),s.jsxs("div",{className:"bg-white rounded shadow p-4",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"Total Group Loans"}),s.jsx("div",{className:"text-xl font-semibold",children:Number(e.totalLoans||0).toLocaleString()})]}),s.jsxs("div",{className:"bg-white rounded shadow p-4",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"PAR"}),s.jsx("div",{className:"text-xl font-semibold text-red-600",children:e.par||"0%"})]})]}),s.jsx("div",{className:"bg-white rounded shadow p-4",children:s.jsx("p",{className:"text-sm text-gray-600",children:"Charts and trends (by branch, officer, performance tiers) will appear here once backend analytics endpoints are available."})})]})]})};export{f as default};
