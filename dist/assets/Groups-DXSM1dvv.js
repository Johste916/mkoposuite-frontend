import{r as i,j as e,L as l,g as p}from"./index-CecoMAn-.js";async function x(t=[],o={}){let s;for(const a of t)try{const n=await p.get(a,o);return n==null?void 0:n.data}catch(n){s=n}throw s||new Error("No endpoint succeeded")}function h(t){return(Array.isArray(t)?t:(t==null?void 0:t.items)||(t==null?void 0:t.rows)||(t==null?void 0:t.data)||[]).map(s=>{var n,d,c,r;return{id:s.id??s._id??s.groupId??s.code??s.slug??s.uuid??String(Math.random()),name:s.name??s.groupName??s.title??"—",membersCount:s.membersCount??s.memberCount??((n=s.members)==null?void 0:n.length)??s.size??0,branchName:s.branchName??((d=s.branch)==null?void 0:d.name)??"—",totalLoans:s.totalLoans??s.loanCount??((c=s.stats)==null?void 0:c.loans)??0,outstanding:s.totalLoanAmount??s.outstanding??((r=s.stats)==null?void 0:r.outstanding)??0}})}const b=()=>{const[t,o]=i.useState([]),[s,a]=i.useState(!0),[n,d]=i.useState("");i.useEffect(()=>{const r=new AbortController;return(async()=>{try{a(!0);const m=await x(["/borrowers/groups?include=members","/groups?include=members","/borrower-groups?include=members","/api/borrowers/groups?include=members"],{signal:r.signal});o(h(m)),d("")}catch{d("Failed to load groups (endpoint not implemented)."),o([])}finally{a(!1)}})(),()=>r.abort()},[]);const c=r=>`TZS ${Number(r||0).toLocaleString()}`;return e.jsxs("div",{className:"p-4 space-y-4 bg-[var(--bg)] text-[var(--fg)]",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Borrower Groups"}),e.jsx(l,{to:"/borrowers/groups/add",className:"px-3 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:"Add Group"})]}),e.jsx("div",{className:"card overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left muted",children:[e.jsx("th",{className:"px-3 py-2",children:"Name"}),e.jsx("th",{className:"px-3 py-2",children:"Members"}),e.jsx("th",{className:"px-3 py-2",children:"Branch"}),e.jsx("th",{className:"px-3 py-2",children:"Loans"}),e.jsx("th",{className:"px-3 py-2",children:"Outstanding"}),e.jsx("th",{className:"px-3 py-2 text-right pr-4",children:"Actions"})]})}),e.jsx("tbody",{children:s?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"p-4 muted",children:"Loading…"})}):n?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"p-4 text-rose-600 dark:text-rose-400",children:n})}):t.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"p-4 muted",children:"No groups yet."})}):t.map(r=>e.jsxs("tr",{className:"border-t border-[var(--border)]",children:[e.jsx("td",{className:"px-3 py-2",children:r.name}),e.jsx("td",{className:"px-3 py-2",children:r.membersCount}),e.jsx("td",{className:"px-3 py-2",children:r.branchName}),e.jsx("td",{className:"px-3 py-2",children:r.totalLoans}),e.jsx("td",{className:"px-3 py-2",children:c(r.outstanding)}),e.jsx("td",{className:"px-3 py-2 text-right",children:e.jsx(l,{to:`/borrowers/groups/${encodeURIComponent(r.id)}`,className:"text-indigo-600 hover:text-indigo-800 hover:underline dark:text-indigo-400 dark:hover:text-indigo-300",children:"View"})})]},r.id))})]})})]})};export{b as default};
