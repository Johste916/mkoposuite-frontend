import{r as l,g as re,j as a,L as we}from"./index-CeHYLxUd.js";import{D as Xt}from"./download-BWgq5AMA.js";import{C as Be}from"./circle-plus-Cmt0BV_H.js";import{c as X}from"./createLucideIcon-BzVCG4Pe.js";import{i as at,S as Zt,a as Pe,r as Yt,u as gt,R as Jt,b as Qt,c as ea,d as ta,g as aa,e as yt,f as sa,h as ra,j as na,k as ke,l as ia,G as oa,C as la,m as bt,n as ca,L as Ae,o as da,p as ua,t as ma,q as st,s as jt,v as Nt,w as wt,x as kt,y as ha,z as At,A as pa,J as xa,B as te,D as fa,E as va,F as ga,H as ya,I as rt,K as Z,M as ba,N as ie,O as oe,P as ce,Q as ja,T as St,U as Pt,V as It,W as Na,X as wa,Y as nt,Z as ka,_ as Aa,$ as it,a0 as Sa,a1 as ze,a2 as ot,a3 as Pa,a4 as Ia,a5 as Ee,a6 as Le,a7 as Re,a8 as Te,a9 as _e,aa as Me}from"./CartesianChart-CuY2ozxi.js";import{U as Ca}from"./user-plus-DpcSGAUu.js";import{C as Oa}from"./chevron-down-YDxWsvkA.js";import{C as Da}from"./calendar-CkHq3q9Z.js";/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]],lt=X("chart-no-axes-column",Ba);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ea=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],ct=X("clipboard-list",Ea);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const La=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],$e=X("credit-card",La);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ra=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],ae=X("dollar-sign",Ra);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],_a=X("message-square",Ta);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ma=[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]],$a=X("thumbs-down",Ma);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fa=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],dt=X("triangle-alert",Fa);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ka=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],za=X("users",Ka);var Wa="Invariant failed";function Va(t,e){throw new Error(Wa)}var Ua=["x","y"];function We(){return We=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},We.apply(null,arguments)}function ut(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),s.push.apply(s,r)}return s}function pe(t){for(var e=1;e<arguments.length;e++){var s=arguments[e]!=null?arguments[e]:{};e%2?ut(Object(s),!0).forEach(function(r){Ga(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):ut(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function Ga(t,e,s){return(e=qa(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function qa(t){var e=Ha(t,"string");return typeof e=="symbol"?e:e+""}function Ha(t,e){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xa(t,e){if(t==null)return{};var s,r,o=Za(t,e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(t);for(r=0;r<c.length;r++)s=c[r],e.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(o[s]=t[s])}return o}function Za(t,e){if(t==null)return{};var s={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;s[r]=t[r]}return s}function Ya(t,e){var{x:s,y:r}=t,o=Xa(t,Ua),c="".concat(s),d=parseInt(c,10),p="".concat(r),g=parseInt(p,10),h="".concat(e.height||o.height),x=parseInt(h,10),f="".concat(e.width||o.width),y=parseInt(f,10);return pe(pe(pe(pe(pe({},e),o),d?{x:d}:{}),g?{y:g}:{}),{},{height:x,width:y,name:e.name,radius:e.radius})}function Ct(t){return l.createElement(Zt,We({shapeType:"rectangle",propTransformer:Ya,activeClassName:"recharts-active-bar"},t))}var Ja=function(e){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(r,o)=>{if(at(e))return e;var c=at(r)||Pe(r);return c?e(r,o):(c||Va(),s)}},Qa=["onMouseEnter","onMouseLeave","onClick"],es=["value","background","tooltipPosition"],ts=["id"],as=["onMouseEnter","onClick","onMouseLeave"];function le(){return le=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},le.apply(null,arguments)}function mt(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),s.push.apply(s,r)}return s}function L(t){for(var e=1;e<arguments.length;e++){var s=arguments[e]!=null?arguments[e]:{};e%2?mt(Object(s),!0).forEach(function(r){ss(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):mt(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function ss(t,e,s){return(e=rs(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function rs(t){var e=ns(t,"string");return typeof e=="symbol"?e:e+""}function ns(t,e){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Se(t,e){if(t==null)return{};var s,r,o=is(t,e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(t);for(r=0;r<c.length;r++)s=c[r],e.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(o[s]=t[s])}return o}function is(t,e){if(t==null)return{};var s={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;s[r]=t[r]}return s}var os=t=>{var{dataKey:e,name:s,fill:r,legendType:o,hide:c}=t;return[{inactive:c,dataKey:e,type:o,color:r,value:yt(s,e),payload:t}]};function ls(t){var{dataKey:e,stroke:s,strokeWidth:r,fill:o,name:c,hide:d,unit:p}=t;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:s,strokeWidth:r,fill:o,dataKey:e,nameKey:void 0,name:yt(c,e),hide:d,type:t.tooltipType,color:t.fill,unit:p}}}function cs(t){var e=ke(jt),{data:s,dataKey:r,background:o,allOtherBarProps:c}=t,{onMouseEnter:d,onMouseLeave:p,onClick:g}=c,h=Se(c,Qa),x=Nt(d,r),f=wt(p),y=kt(g,r);if(!o||s==null)return null;var v=ha(o,!1);return l.createElement(l.Fragment,null,s.map((A,N)=>{var{value:I,background:j,tooltipPosition:w}=A,m=Se(A,es);if(!j)return null;var P=x(A,N),k=f(A,N),C=y(A,N),B=L(L(L(L(L({option:o,isActive:String(N)===e},m),{},{fill:"#eee"},j),v),At(h,A,N)),{},{onMouseEnter:P,onMouseLeave:k,onClick:C,dataKey:r,index:N,className:"recharts-bar-background-rectangle"});return l.createElement(Ct,le({key:"background-bar-".concat(N)},B))}))}function Ot(t){var{data:e,props:s,showLabels:r}=t,o=fa(s),{id:c}=o,d=Se(o,ts),{shape:p,dataKey:g,activeBar:h}=s,x=ke(jt),f=ke(va),{onMouseEnter:y,onClick:v,onMouseLeave:A}=s,N=Se(s,as),I=Nt(y,g),j=wt(A),w=kt(v,g);return e?l.createElement(l.Fragment,null,e.map((m,P)=>{var k=h&&String(P)===x&&(f==null||g===f),C=k?h:p,B=L(L(L({},d),m),{},{isActive:k,option:C,index:P,dataKey:g});return l.createElement(Ae,le({className:"recharts-bar-rectangle"},At(N,m,P),{onMouseEnter:I(m,P),onMouseLeave:j(m,P),onClick:w(m,P),key:"rectangle-".concat(m==null?void 0:m.x,"-").concat(m==null?void 0:m.y,"-").concat(m==null?void 0:m.value,"-").concat(P)}),l.createElement(Ct,B))}),r&&ga.renderCallByParent(s,e)):null}function ds(t){var{props:e,previousRectanglesRef:s}=t,{data:r,layout:o,isAnimationActive:c,animationBegin:d,animationDuration:p,animationEasing:g,onAnimationEnd:h,onAnimationStart:x}=e,f=s.current,y=pa(e,"recharts-bar-"),[v,A]=l.useState(!1),N=l.useCallback(()=>{typeof h=="function"&&h(),A(!1)},[h]),I=l.useCallback(()=>{typeof x=="function"&&x(),A(!0)},[x]);return l.createElement(xa,{begin:d,duration:p,isActive:c,easing:g,onAnimationEnd:N,onAnimationStart:I,key:y},j=>{var w=j===1?r:r==null?void 0:r.map((m,P)=>{var k=f&&f[P];if(k)return L(L({},m),{},{x:te(k.x,m.x,j),y:te(k.y,m.y,j),width:te(k.width,m.width,j),height:te(k.height,m.height,j)});if(o==="horizontal"){var C=te(0,m.height,j);return L(L({},m),{},{y:m.y+m.height-C,height:C})}var B=te(0,m.width,j);return L(L({},m),{},{width:B})});return j>0&&(s.current=w??null),w==null?null:l.createElement(Ae,null,l.createElement(Ot,{props:e,data:w,showLabels:!v}))})}function us(t){var{data:e,isAnimationActive:s}=t,r=l.useRef(null);return s&&e&&e.length&&(r.current==null||r.current!==e)?l.createElement(ds,{previousRectanglesRef:r,props:t}):l.createElement(Ot,{props:t,data:e,showLabels:!0})}var Dt=0,ms=(t,e)=>{var s=Array.isArray(t.value)?t.value[1]:t.value;return{x:t.x,y:t.y,value:s,errorVal:bt(t,e)}};class hs extends l.PureComponent{render(){var{hide:e,data:s,dataKey:r,className:o,xAxisId:c,yAxisId:d,needClip:p,background:g,id:h}=this.props;if(e)return null;var x=ca("recharts-bar",o),f=h;return l.createElement(Ae,{className:x,id:h},p&&l.createElement("defs",null,l.createElement(da,{clipPathId:f,xAxisId:c,yAxisId:d})),l.createElement(Ae,{className:"recharts-bar-rectangles",clipPath:p?"url(#clipPath-".concat(f,")"):void 0},l.createElement(cs,{data:s,dataKey:r,background:g,allOtherBarProps:this.props}),l.createElement(us,this.props)),this.props.children)}}var ps={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!oa.isSsr,legendType:"rect",minPointSize:Dt,xAxisId:0,yAxisId:0};function xs(t){var{xAxisId:e,yAxisId:s,hide:r,legendType:o,minPointSize:c,activeBar:d,animationBegin:p,animationDuration:g,animationEasing:h,isAnimationActive:x}=t,{needClip:f}=sa(e,s),y=ra(),v=gt(),A=na(t.children,la),N=ke(w=>zs(w,e,s,v,t.id,A));if(y!=="vertical"&&y!=="horizontal")return null;var I,j=N==null?void 0:N[0];return j==null||j.height==null||j.width==null?I=0:I=y==="vertical"?j.height/2:j.width/2,l.createElement(ia,{xAxisId:e,yAxisId:s,data:N,dataPointFormatter:ms,errorBarOffset:I},l.createElement(hs,le({},t,{layout:y,needClip:f,data:N,xAxisId:e,yAxisId:s,hide:r,legendType:o,minPointSize:c,activeBar:d,animationBegin:p,animationDuration:g,animationEasing:h,isAnimationActive:x})))}function fs(t){var{layout:e,barSettings:{dataKey:s,minPointSize:r},pos:o,bandSize:c,xAxis:d,yAxis:p,xAxisTicks:g,yAxisTicks:h,stackedData:x,displayedData:f,offset:y,cells:v}=t,A=e==="horizontal"?p:d,N=x?A.scale.domain():null,I=ua({numericAxis:A});return f.map((j,w)=>{var m,P,k,C,B,Q;x?m=ma(x[w],N):(m=bt(j,s),Array.isArray(m)||(m=[I,m]));var U=Ja(r,Dt)(m[1],w);if(e==="horizontal"){var de,[G,ee]=[p.scale(m[0]),p.scale(m[1])];P=st({axis:d,ticks:g,bandSize:c,offset:o.offset,entry:j,index:w}),k=(de=ee??G)!==null&&de!==void 0?de:void 0,C=o.size;var K=G-ee;if(B=ya(K)?0:K,Q={x:P,y:y.top,width:C,height:y.height},Math.abs(U)>0&&Math.abs(B)<Math.abs(U)){var Y=rt(B||U)*(Math.abs(U)-Math.abs(B));k-=Y,B+=Y}}else{var[q,ue]=[d.scale(m[0]),d.scale(m[1])];if(P=q,k=st({axis:p,ticks:h,bandSize:c,offset:o.offset,entry:j,index:w}),C=ue-q,B=o.size,Q={x:y.left,y:k,width:y.width,height:B},Math.abs(U)>0&&Math.abs(C)<Math.abs(U)){var Ie=rt(C||U)*(Math.abs(U)-Math.abs(C));C+=Ie}}if(P==null||k==null||C==null||B==null)return null;var me=L(L({},j),{},{x:P,y:k,width:C,height:B,value:x?m:m[1],payload:j,background:Q,tooltipPosition:{x:P+C/2,y:k+B/2}},v&&v[w]&&v[w].props);return me}).filter(Boolean)}function ne(t){var e=Yt(t,ps),s=gt();return l.createElement(Jt,{id:e.id,type:"bar"},r=>l.createElement(l.Fragment,null,l.createElement(Qt,{legendPayload:os(e)}),l.createElement(ea,{fn:ls,args:e}),l.createElement(ta,{type:"bar",id:r,data:void 0,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:0,dataKey:e.dataKey,stackId:aa(e.stackId),hide:e.hide,barSize:e.barSize,minPointSize:e.minPointSize,maxBarSize:e.maxBarSize,isPanorama:s}),l.createElement(xs,le({},e,{id:r}))))}ne.displayName="Bar";function ht(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),s.push.apply(s,r)}return s}function je(t){for(var e=1;e<arguments.length;e++){var s=arguments[e]!=null?arguments[e]:{};e%2?ht(Object(s),!0).forEach(function(r){vs(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):ht(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function vs(t,e,s){return(e=gs(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function gs(t){var e=ys(t,"string");return typeof e=="symbol"?e:e+""}function ys(t,e){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var bs=(t,e)=>e,js=(t,e,s)=>s,Ns=(t,e,s,r)=>r,ws=(t,e,s,r,o)=>o,fe=Z([Pt,ws],(t,e)=>t.filter(s=>s.type==="bar").find(s=>s.id===e)),ks=Z([fe],t=>t==null?void 0:t.maxBarSize),As=(t,e,s,r,o,c)=>c,pt=(t,e,s)=>{var r=s??t;if(!Pe(r))return ze(r,e,0)},Ss=Z([ce,Pt,bs,js,Ns],(t,e,s,r,o)=>e.filter(c=>t==="horizontal"?c.xAxisId===s:c.yAxisId===r).filter(c=>c.isPanorama===o).filter(c=>c.hide===!1).filter(c=>c.type==="bar")),Ps=(t,e,s,r)=>{var o=ce(t);return o==="horizontal"?nt(t,"yAxis",s,r):nt(t,"xAxis",e,r)},Is=(t,e,s)=>{var r=ce(t);return r==="horizontal"?it(t,"xAxis",e):it(t,"yAxis",s)},Cs=(t,e,s)=>{var r={},o=t.filter(Sa),c=t.filter(h=>h.stackId==null),d=o.reduce((h,x)=>(h[x.stackId]||(h[x.stackId]=[]),h[x.stackId].push(x),h),r),p=Object.entries(d).map(h=>{var[x,f]=h,y=f.map(A=>A.dataKey),v=pt(e,s,f[0].barSize);return{stackId:x,dataKeys:y,barSize:v}}),g=c.map(h=>{var x=[h.dataKey].filter(y=>y!=null),f=pt(e,s,h.barSize);return{stackId:void 0,dataKeys:x,barSize:f}});return[...p,...g]},Os=Z([Ss,Aa,Is],Cs),Ds=(t,e,s,r,o)=>{var c,d,p=fe(t,e,s,r,o);if(p!=null){var g=ce(t),h=It(t),{maxBarSize:x}=p,f=Pe(x)?h:x,y,v;return g==="horizontal"?(y=ie(t,"xAxis",e,r),v=oe(t,"xAxis",e,r)):(y=ie(t,"yAxis",s,r),v=oe(t,"yAxis",s,r)),(c=(d=St(y,v,!0))!==null&&d!==void 0?d:f)!==null&&c!==void 0?c:0}},Bt=(t,e,s,r)=>{var o=ce(t),c,d;return o==="horizontal"?(c=ie(t,"xAxis",e,r),d=oe(t,"xAxis",e,r)):(c=ie(t,"yAxis",s,r),d=oe(t,"yAxis",s,r)),St(c,d)};function Bs(t,e,s,r,o){var c=r.length;if(!(c<1)){var d=ze(t,s,0,!0),p,g=[];if(ot(r[0].barSize)){var h=!1,x=s/c,f=r.reduce((j,w)=>j+(w.barSize||0),0);f+=(c-1)*d,f>=s&&(f-=(c-1)*d,d=0),f>=s&&x>0&&(h=!0,x*=.9,f=c*x);var y=(s-f)/2>>0,v={offset:y-d,size:0};p=r.reduce((j,w)=>{var m,P={stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:v.offset+v.size+d,size:h?x:(m=w.barSize)!==null&&m!==void 0?m:0}},k=[...j,P];return v=k[k.length-1].position,k},g)}else{var A=ze(e,s,0,!0);s-2*A-(c-1)*d<=0&&(d=0);var N=(s-2*A-(c-1)*d)/c;N>1&&(N>>=0);var I=ot(o)?Math.min(N,o):N;p=r.reduce((j,w,m)=>[...j,{stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:A+(N+d)*m+(N-I)/2,size:I}}],g)}return p}}var Es=(t,e,s,r,o,c,d)=>{var p=Pe(d)?e:d,g=Bs(s,r,o!==c?o:c,t,p);return o!==c&&g!=null&&(g=g.map(h=>je(je({},h),{},{position:je(je({},h.position),{},{offset:h.position.offset-o/2})}))),g},Ls=Z([Os,It,Na,wa,Ds,Bt,ks],Es),Rs=(t,e,s,r)=>ie(t,"xAxis",e,r),Ts=(t,e,s,r)=>ie(t,"yAxis",s,r),_s=(t,e,s,r)=>oe(t,"xAxis",e,r),Ms=(t,e,s,r)=>oe(t,"yAxis",s,r),$s=Z([Ls,fe],(t,e)=>{if(!(t==null||e==null)){var s=t.find(r=>r.stackId===e.stackId&&e.dataKey!=null&&r.dataKeys.includes(e.dataKey));if(s!=null)return s.position}}),Fs=(t,e)=>{var s=ka(e);if(!(!t||s==null||e==null)){var{stackId:r}=e;if(r!=null){var o=t[r];if(o){var{stackedData:c}=o;if(c)return c.find(d=>d.key===s)}}}},Ks=Z([Ps,fe],Fs),zs=Z([ba,Rs,Ts,_s,Ms,$s,ce,ja,Bt,Ks,fe,As],(t,e,s,r,o,c,d,p,g,h,x,f)=>{var{chartData:y,dataStartIndex:v,dataEndIndex:A}=p;if(!(x==null||c==null||d!=="horizontal"&&d!=="vertical"||e==null||s==null||r==null||o==null||g==null)){var{data:N}=x,I;if(N!=null&&N.length>0?I=N:I=y==null?void 0:y.slice(v,A+1),I!=null)return fs({layout:d,barSettings:x,pos:c,bandSize:g,xAxis:e,yAxis:s,xAxisTicks:r,yAxisTicks:o,stackedData:h,displayedData:I,offset:t,cells:f})}}),Ws=["axis","item"],Fe=l.forwardRef((t,e)=>l.createElement(Pa,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Ws,tooltipPayloadSearcher:Ia,categoricalChartProps:t,ref:e}));const _={borrowers:"/borrowers",loans:"/loans",repayments:"/repayments",expectedRepayments:"/repayments",deposits:"/deposits",withdrawals:"/withdrawals",savings:"/savings",defaultedLoans:"/loans",defaultedInterest:"/loans",outstandingLoan:"/loans",outstandingInterest:"/loans",writtenOff:"/loans",par:"/loans"},xt="ms_dash_filters_v1",ft="ms_dash_auto_refresh_v1";function J(t){const s=(t.startsWith("/")?t:`/${t}`).replace(/^\/api\//,"/"),r=s.startsWith("/api/")?s:`/api${s}`;return Array.from(new Set([s,r]))}function se(t){return(t==null?void 0:t.name)==="CanceledError"||(t==null?void 0:t.code)==="ERR_CANCELED"||/abort|cancell?ed/i.test((t==null?void 0:t.message)||"")}async function Ne(t=[],e={}){let s;for(const r of t)try{const o=await re.get(r,e);return o==null?void 0:o.data}catch(o){s=o}throw s||new Error("No endpoint succeeded")}function Vs(t){return(Array.isArray(t)?t:(t==null?void 0:t.items)||(t==null?void 0:t.rows)||(t==null?void 0:t.data)||[]).map(s=>({id:s.id??s._id??s.branchId??s.code??String(s.name||"branch"),name:s.name??s.title??s.label??String(s.code||"—")}))}function Us(t){return(Array.isArray(t)?t:(t==null?void 0:t.items)||(t==null?void 0:t.rows)||(t==null?void 0:t.data)||[]).map(s=>({id:s.id??s._id??s.userId??String(s.email||s.phone||"user"),name:s.name||[s.firstName,s.lastName].filter(Boolean).join(" ").trim()||s.username||s.email||s.phone||"—",roles:(s.roles||s.Roles||[]).map(r=>(r.name||r.code||"").toString().toLowerCase()),title:(s.title||s.jobTitle||"").toString().toLowerCase()}))}function Gs(t){const e=[...t.roles||[],t.title||""].join(" ");return/loan.*officer|credit.*officer|field.*officer/i.test(e)}function qs(t){const e=(t==null?void 0:t.summary)||t||{},s=o=>Number(o||0),r=o=>{if(o==null)return 0;const c=String(o).trim().replace("%",""),d=Number(c);return Number.isFinite(d)?d:0};return{totalBorrowers:s(e.totalBorrowers??e.borrowers??e.clients),totalLoans:s(e.totalLoans??e.loans),totalDisbursed:s(e.totalDisbursed??e.disbursed),totalPaid:s(e.totalPaid??e.paid),totalRepaid:s(e.totalRepaid??e.repaid??e.collections),totalExpectedRepayments:s(e.totalExpectedRepayments??e.expectedRepayments),totalDeposits:s(e.totalDeposits??e.deposits),totalWithdrawals:s(e.totalWithdrawals??e.withdrawals),netSavings:s(e.netSavings??(e.totalDeposits||0)-(e.totalWithdrawals||0)),defaultedLoan:s(e.defaultedLoan??e.defaulted??e.nplPrincipal),defaultedInterest:s(e.defaultedInterest??e.nplInterest),outstandingLoan:s(e.outstandingLoan??e.outstandingPrincipal??e.outstanding),outstandingInterest:s(e.outstandingInterest??e.accruedInterest),writtenOff:s(e.writtenOff??e.writeOffs),parPercent:r(e.parPercent??e.par??e.par30??e.portfolioAtRisk),topBorrowers:Array.isArray(e.topBorrowers)?e.topBorrowers:[],upcomingRepayments:Array.isArray(e.upcomingRepayments)?e.upcomingRepayments:[],branchPerformance:Array.isArray(e.branchPerformance)?e.branchPerformance:[],officerPerformance:Array.isArray(e.officerPerformance)?e.officerPerformance:[]}}const Hs=()=>{const[t,e]=l.useState(()=>typeof document<"u"&&document.documentElement.classList.contains("dark"));return l.useEffect(()=>{if(typeof document>"u")return;const s=document.documentElement,r=new MutationObserver(()=>{e(s.classList.contains("dark"))});return r.observe(s,{attributes:!0,attributeFilter:["class"]}),()=>r.disconnect()},[]),t},Xs=new Intl.NumberFormat(void 0,{maximumFractionDigits:0}),S={container:"w-full px-4 md:px-6 lg:px-8 py-6 text-slate-900",h1:"text-3xl font-extrabold tracking-tight",card:"rounded-2xl border-2 border-slate-300 bg-white shadow",btn:"inline-flex items-center justify-center rounded-lg border-2 border-slate-300 px-3 py-2 hover:bg-slate-50",tableWrap:"overflow-x-auto rounded-2xl border-2 border-slate-300 bg-white shadow",th:"bg-slate-100 text-left text-[13px] uppercase tracking-wide text-slate-700 font-semibold px-3 py-2 border-2 border-slate-200",td:"px-3 py-2 border-2 border-slate-200 text-sm"},Ve="h-10 w-full rounded-lg border-2 text-sm outline-none transition bg-white text-slate-900 border-slate-300 focus:ring-2 focus:ring-indigo-500/40",xe=({className:t="",children:e,...s})=>a.jsxs("div",{className:`relative ${t}`,children:[a.jsx("select",{...s,className:`${Ve} pr-9 appearance-none bg-none ms-select`,style:{backgroundImage:"none"},children:e}),a.jsx(Oa,{className:"pointer-events-none absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-600","aria-hidden":"true"})]}),Ke=({className:t="",...e})=>a.jsxs("div",{className:`relative ${t}`,children:[a.jsx("input",{type:"date",...e,className:`${Ve} pr-9 appearance-none bg-none ms-date`,style:{backgroundImage:"none"}}),a.jsx(Da,{className:"pointer-events-none absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-600","aria-hidden":"true"})]}),vt=({className:t="",...e})=>a.jsx("input",{...e,className:`${Ve} ${t}`}),rr=()=>{const t=Hs(),[e,s]=l.useState(null),[r,o]=l.useState([]),[c,d]=l.useState([]),[p,g]=l.useState(""),[h,x]=l.useState(""),[f,y]=l.useState(""),[v,A]=l.useState(0),[N,I]=l.useState(null),[j,w]=l.useState(null),[m,P]=l.useState(Date.now()),[k,C]=l.useState([]),[B,Q]=l.useState(!1),[U,de]=l.useState([]),[G,ee]=l.useState(0),[K,Y]=l.useState(1),q=10,[ue,Ie]=l.useState(""),[me,Et]=l.useState(""),[Ue,Ge]=l.useState({}),[ve,ge]=l.useState({}),[qe,ye]=l.useState({}),[$,Lt]=l.useState(null),[He,Rt]=l.useState([]),[Xe,Tt]=l.useState([]),[Ze,_t]=l.useState([]),[Ye,Mt]=l.useState([]),[$t,Ft]=l.useState(!0),[Kt,Je]=l.useState([]),z=(n,i="info")=>{const u=Math.random().toString(36).slice(2);Je(O=>[...O,{id:u,msg:n,type:i}]),setTimeout(()=>Je(O=>O.filter(D=>D.id!==u)),3500)},R=n=>{const i=Number(n);return Number.isFinite(i)?i:0},F=n=>{const i=R(n);return Number.isNaN(i)?"TZS —":`TZS ${Xs.format(i)}`},T=(n,i={})=>{try{const u=new URLSearchParams;p&&u.set("branchId",p),h&&u.set("officerId",h),f&&u.set("timeRange",f),Object.entries(i).forEach(([D,V])=>{V!=null&&String(V)!==""&&u.set(D,V)});const O=u.toString();return O?`${n}?${O}`:n}catch{return n}},zt=n=>{var i;return((i=r.find(u=>String(u.id)===String(n)))==null?void 0:i.name)||(n?`Branch #${n}`:"All branches")};l.useEffect(()=>{try{const n=localStorage.getItem(xt);if(n){const i=JSON.parse(n);g(i.branchId||""),x(i.officerId||""),y(i.timeRange||"")}}catch{}try{const n=localStorage.getItem(ft);n&&A(Number(n)||0)}catch{}},[]),l.useEffect(()=>{const n={branchId:p,officerId:h,timeRange:f};localStorage.setItem(xt,JSON.stringify(n))},[p,h,f]),l.useEffect(()=>{localStorage.setItem(ft,String(v||0))},[v]);const Qe=l.useCallback(async n=>{try{const[i,u]=await Promise.all([Ne([...J("branches"),...J("org/branches")],{signal:n}),Ne([...J("users?role=loan_officer"),...J("admin/staff?role=loan_officer")],{signal:n}).catch(()=>Ne([...J("users"),...J("admin/staff")],{signal:n}))]),O=Vs(i),D=Us(u),V=D.filter(Gs);o(O),d(V.length?V:D)}catch(i){se(i)||(console.error("Filter fetch error:",(i==null?void 0:i.message)||i),z("Failed to load filters","error"))}},[]),Ce=l.useCallback(async n=>{try{const i=await Ne([...J("dashboard/summary")],{signal:n,params:{branchId:p,officerId:h,timeRange:f}});s(qs(i))}catch(i){se(i)||(console.error("Dashboard summary error:",(i==null?void 0:i.message)||i),z("Failed to load summary","error"))}},[p,h,f]),he=l.useCallback(async n=>{Q(!0);try{const i=await re.get("/dashboard/communications",{signal:n}).catch(()=>null);i!=null&&i.data&&Array.isArray(i.data)?C(i.data):C(Array.isArray(e==null?void 0:e.generalCommunications)?e.generalCommunications:[])}finally{Q(!1)}},[e]),H=l.useCallback(async(n={},i)=>{var u,O;try{const D=await re.get("/dashboard/activity",{params:{page:n.page??K,pageSize:q,dateFrom:ue||void 0,dateTo:me||void 0},signal:i});de(((u=D.data)==null?void 0:u.items)||[]),ee(((O=D.data)==null?void 0:O.total)||0)}catch(D){se(D)||(console.error("Activity fetch error:",(D==null?void 0:D.message)||D),z("Failed to load activity","error"))}},[K,ue,me]),Oe=l.useCallback(async n=>{try{const i=await re.get("/dashboard/monthly-trends",{signal:n});Lt(i.data||{})}catch(i){se(i)||(console.error("Monthly trends error:",(i==null?void 0:i.message)||i),z("Failed to load trends","error"))}},[]);l.useEffect(()=>{const n=new AbortController;return(async()=>{try{await Qe(n.signal)}catch{}})(),()=>n.abort()},[Qe]);const be=l.useCallback(async n=>{await Promise.all([Ce(n),H({},n),Oe(n)]),I(new Date),v>0&&w(Date.now()+v*6e4)},[Ce,H,Oe,v]);l.useEffect(()=>{const n=new AbortController;return(async()=>{try{await be(n.signal)}catch(i){se(i)||(console.error("Dashboard fetch error:",(i==null?void 0:i.message)||i),z("Failed to load dashboard data","error"))}finally{Ft(!1)}})(),()=>n.abort()},[be]),l.useEffect(()=>{if(!e)return;const n=new AbortController;return he(n.signal).catch(i=>{se(i)||(console.error("Comms fetch error:",(i==null?void 0:i.message)||i),z("Failed to load communications","error"))}),()=>n.abort()},[e,he]),l.useEffect(()=>{e&&(Array.isArray(e.topBorrowers)&&Rt(e.topBorrowers),Array.isArray(e.upcomingRepayments)&&Tt(e.upcomingRepayments),Array.isArray(e.branchPerformance)&&_t(e.branchPerformance),Array.isArray(e.officerPerformance)&&Mt(e.officerPerformance))},[e]),l.useEffect(()=>{if(!v||v<=0){w(null);return}const i=setInterval(()=>{const u=new AbortController;Promise.all([be(u.signal),he(u.signal)]).catch(()=>{}).finally(()=>u.abort())},v*6e4);return w(Date.now()+v*6e4),()=>clearInterval(i)},[v,be,he]),l.useEffect(()=>{const n=setInterval(()=>P(Date.now()),1e3);return()=>clearInterval(n)},[]);const Wt=async n=>{const i=`c-${n}`;ye(u=>({...u,[i]:!0}));try{const u=(Ue[n]||"").trim();if(!u)return;await re.post(`/dashboard/activity/${n}/comment`,{comment:u}),Ge(O=>({...O,[n]:""})),await H(),z("Reply posted","success")}catch(u){console.error("Add comment error:",(u==null?void 0:u.message)||u),z("Failed to post reply","error")}finally{ye(u=>({...u,[i]:!1}))}},Vt=async n=>{const i=`a-${n}`;ye(u=>({...u,[i]:!0}));try{const u=ve[n]||{};if(!u.assigneeId)return;await re.post(`/dashboard/activity/${n}/assign`,{assigneeId:u.assigneeId,dueDate:u.dueDate||null,note:u.note||""}),ge(O=>({...O,[n]:{assigneeId:"",dueDate:"",note:""}})),await H(),z("Task assigned","success")}catch(u){console.error("Assign task error:",(u==null?void 0:u.message)||u),z("Failed to assign task","error")}finally{ye(u=>({...u,[i]:!1}))}},De=({label:n,value:i,max:u})=>{const O=R(i),D=R(u),V=D>0?Math.round(O/D*100):0;return a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between text-xs text-slate-600",children:[a.jsx("span",{children:n}),a.jsx("span",{className:"tabular-nums",children:O.toLocaleString()})]}),a.jsx("div",{className:"h-2 w-full bg-slate-100 rounded",children:a.jsx("div",{className:"h-2 rounded transition-[width] duration-500",style:{width:`${V}%`,backgroundColor:"currentColor"}})})]})},Ut=({className:n=""})=>a.jsx("div",{className:`animate-pulse bg-slate-100 rounded ${n}`}),Gt=()=>{const n=k.flatMap(i=>(i.attachments||[]).map(u=>u.fileUrl)).filter(Boolean);n.length!==0&&(n.forEach((i,u)=>{setTimeout(()=>window.open(i,"_blank","noopener,noreferrer"),u*150)}),z(`Opening ${n.length} attachment${n.length>1?"s":""}…`,"info"))},b=t?{grid:"#334155",axis:"#cbd5e1",legend:"#e2e8f0",tooltipBg:"#0b1220",tooltipText:"#e2e8f0",bar1:"#60a5fa",bar2:"#34d399"}:{grid:"#e2e8f0",axis:"#334155",legend:"#334155",tooltipBg:"#ffffff",tooltipText:"#0f172a",bar1:"#2563eb",bar2:"#10b981"},et=j?Math.max(0,Math.floor((j-m)/1e3)):0,qt=String(Math.floor(et/60)).padStart(2,"0"),Ht=String(et%60).padStart(2,"0");return a.jsx("div",{className:S.container,children:a.jsxs("div",{className:"space-y-6",children:[a.jsx("style",{children:`
          /* Select: remove native arrow across browsers */
          select.ms-select {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: none !important;
          }
          /* Legacy Edge/IE */
          select.ms-select::-ms-expand { display: none; }

          /* Date input: hide native calendar button so our icon is the only one */
          input.ms-date[type="date"] {
            -webkit-appearance: none;
            appearance: none;
            background-image: none !important;
          }
          input.ms-date[type="date"]::-webkit-calendar-picker-indicator {
            opacity: 0;
            display: none;
          }
        `}),a.jsxs("div",{className:`${S.card} p-4 md:p-6`,children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-end md:justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:S.h1,children:"Dashboard"}),a.jsx("p",{className:"text-sm text-slate-700 mt-1",children:"Quick snapshot of borrowers, loans, repayments and savings."}),a.jsx("p",{className:"text-xs text-slate-600 mt-1",children:N?`Last updated ${N.toLocaleString()}`:"Loading…"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsxs(xe,{"aria-label":"Filter by branch",value:p,onChange:n=>g(n.target.value),className:"min-w-[11rem]",children:[a.jsx("option",{value:"",children:"All Branches"}),r.map(n=>a.jsx("option",{value:n.id,children:n.name},n.id))]}),a.jsxs(xe,{"aria-label":"Filter by loan officer",value:h,onChange:n=>x(n.target.value),className:"min-w-[12rem]",children:[a.jsx("option",{value:"",children:"All Loan Officers"}),c.map(n=>a.jsx("option",{value:n.id,children:n.name||n.email},n.id))]}),a.jsxs(xe,{"aria-label":"Filter by time range",value:f,onChange:n=>y(n.target.value),className:"min-w-[10rem]",children:[a.jsx("option",{value:"",children:"All Time"}),a.jsx("option",{value:"today",children:"Today"}),a.jsx("option",{value:"week",children:"This Week"}),a.jsx("option",{value:"month",children:"This Month"}),a.jsx("option",{value:"quarter",children:"This Quarter"}),a.jsx("option",{value:"semiAnnual",children:"Semi-Annual"}),a.jsx("option",{value:"annual",children:"Annual"})]}),a.jsxs(xe,{"aria-label":"Auto refresh interval",value:v,onChange:n=>A(Number(n.target.value)),className:"min-w-[12rem]",children:[a.jsx("option",{value:0,children:"No Auto-Refresh"}),a.jsx("option",{value:1,children:"Every 1 min"}),a.jsx("option",{value:5,children:"Every 5 mins"}),a.jsx("option",{value:15,children:"Every 15 mins"})]}),a.jsx("button",{className:S.btn,onClick:()=>{const n=new AbortController;Promise.all([Ce(n.signal),H({page:1},n.signal),Oe(n.signal),he(n.signal)]).then(()=>{Y(1),I(new Date),v>0&&w(Date.now()+v*6e4),z("Dashboard refreshed","success")}).catch(()=>z("Refresh failed","error")).finally(()=>n.abort())},"aria-label":"Refresh dashboard",children:"Refresh"})]})]}),v>0&&j&&a.jsxs("div",{className:"mt-3 inline-flex items-center gap-2 rounded-full border-2 border-slate-300 px-2.5 py-1 text-xs text-slate-800",children:["Auto-refresh in ",qt,":",Ht]})]}),a.jsx("div",{className:"fixed right-4 top-4 z-50 space-y-2",children:Kt.map(n=>a.jsx("div",{className:`px-3 py-2 rounded shadow text-sm text-white ${n.type==="error"?"bg-red-600":n.type==="success"?"bg-emerald-600":"bg-slate-800"}`,children:n.msg},n.id))}),((k==null?void 0:k.length)??0)>0&&a.jsxs("div",{className:`${S.card} overflow-hidden`,children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b-2 border-slate-200 bg-slate-50",children:[a.jsx("div",{className:"text-xs font-semibold text-slate-700",children:"General Communications"}),k.some(n=>Array.isArray(n.attachments)&&n.attachments.length>0)&&a.jsxs("button",{onClick:Gt,className:`${S.btn} h-7 px-2 text-xs`,title:"Open all attachments",disabled:B,children:[a.jsx(Xt,{className:"w-3 h-3"})," Download all"]})]}),a.jsxs("div",{className:"relative h-10",children:[a.jsx("style",{children:"@keyframes ms-marquee{0%{transform:translateX(100%)}100%{transform:translateX(-100%)}}"}),a.jsx("div",{className:"absolute whitespace-nowrap will-change-transform text-sm text-slate-900 flex items-center gap-8 px-3",style:{animation:"ms-marquee 18s linear infinite"},children:k.map((n,i)=>a.jsxs("span",{className:"inline-flex items-center gap-2",children:[n.type&&a.jsx("span",{className:"text-[11px] px-1.5 py-0.5 border-2 rounded bg-white border-slate-300",children:n.type}),n.priority&&a.jsx("span",{className:"text-[11px] px-1.5 py-0.5 border-2 rounded bg-white border-slate-300",children:n.priority}),n.audienceRole&&a.jsxs("span",{className:"text-[11px] px-1.5 py-0.5 border-2 rounded bg-white border-slate-300",children:["role: ",n.audienceRole]}),typeof n.audienceBranchId<"u"&&n.audienceBranchId!==null&&a.jsx("span",{className:"text-[11px] px-1.5 py-0.5 border-2 rounded bg-white border-slate-300",children:zt(n.audienceBranchId)}),a.jsx("span",{className:"inline-block w-1.5 h-1.5 rounded-full bg-blue-600"}),a.jsx("span",{className:"truncate",children:n.text})]},n.id||n.text||i))})]})]}),a.jsxs("div",{className:"flex flex-wrap gap-3",children:[a.jsxs(we,{to:"/loans/add",className:S.btn,children:[a.jsx(Be,{className:"w-4 h-4"})," Add Loan"]}),a.jsxs(we,{to:"/borrowers/add",className:S.btn,children:[a.jsx(Be,{className:"w-4 h-4"})," Add Borrower"]}),a.jsxs(we,{to:"/repayments/new",className:S.btn,children:[a.jsx(Be,{className:"w-4 h-4"})," Record Repayment"]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr_360px] gap-6",children:[a.jsx("main",{className:"space-y-6",children:$t?a.jsx("div",{className:"grid gap-6 [grid-template-columns:repeat(auto-fit,minmax(230px,1fr))]",children:Array.from({length:8}).map((n,i)=>a.jsx(Ut,{className:"h-32"},i))}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid gap-6 [grid-template-columns:repeat(auto-fit,minmax(230px,1fr))]",children:[a.jsx(M,{tone:"indigo",title:"Total Borrowers",value:R(e==null?void 0:e.totalBorrowers).toLocaleString(),icon:a.jsx(za,{className:"w-6 h-6"}),to:T(_.borrowers)}),a.jsx(M,{tone:"sky",title:"Total Loans",value:R(e==null?void 0:e.totalLoans).toLocaleString(),icon:a.jsx($e,{className:"w-6 h-6"}),to:T(_.loans)}),a.jsx(M,{tone:"blue",title:"Total Disbursed",value:F(e==null?void 0:e.totalDisbursed),icon:a.jsx($e,{className:"w-6 h-6"}),to:T(_.loans,{tab:"disbursed"})}),a.jsx(M,{tone:"emerald",title:"Total Paid",value:F(e==null?void 0:e.totalPaid),icon:a.jsx(ae,{className:"w-6 h-6"}),to:T(_.repayments,{tab:"paid"})}),a.jsx(M,{tone:"emerald",title:"Total Repaid",value:F(e==null?void 0:e.totalRepaid),icon:a.jsx(ae,{className:"w-6 h-6"}),to:T(_.repayments,{tab:"paid"})}),a.jsx(M,{tone:"indigo",title:"Expected Repayments",value:F(e==null?void 0:e.totalExpectedRepayments),icon:a.jsx(ct,{className:"w-6 h-6"}),to:T(_.expectedRepayments,{tab:"expected"})}),a.jsx(M,{tone:"cyan",title:"Total Deposits",value:F(e==null?void 0:e.totalDeposits),icon:a.jsx(ae,{className:"w-6 h-6"}),to:T(_.deposits)}),a.jsx(M,{tone:"amber",title:"Total Withdrawals",value:F(e==null?void 0:e.totalWithdrawals),icon:a.jsx(ae,{className:"w-6 h-6"}),to:T(_.withdrawals)}),a.jsx(M,{tone:"blue",title:"Net Savings",value:F(e==null?void 0:e.netSavings),icon:a.jsx(ae,{className:"w-6 h-6"}),to:T(_.savings)}),a.jsx(M,{tone:"rose",title:"Defaulted Loan",value:F(e==null?void 0:e.defaultedLoan),icon:a.jsx(dt,{className:"w-6 h-6"}),to:T(_.defaultedLoans,{tab:"defaulted"})}),a.jsx(M,{tone:"rose",title:"Defaulted Interest",value:F(e==null?void 0:e.defaultedInterest),icon:a.jsx(dt,{className:"w-6 h-6"}),to:T(_.defaultedInterest,{tab:"defaulted-interest"})}),a.jsx(M,{tone:"violet",title:"Outstanding Loan",value:F(e==null?void 0:e.outstandingLoan),icon:a.jsx($e,{className:"w-6 h-6"}),to:T(_.outstandingLoan,{tab:"outstanding"})}),a.jsx(M,{tone:"violet",title:"Outstanding Interest",value:F(e==null?void 0:e.outstandingInterest),icon:a.jsx(ae,{className:"w-6 h-6"}),to:T(_.outstandingInterest,{tab:"outstanding-interest"})}),a.jsx(M,{tone:"slate",title:"Written Off",value:F(e==null?void 0:e.writtenOff),icon:a.jsx($a,{className:"w-6 h-6"}),to:T(_.writtenOff,{tab:"written-off"})}),a.jsx(M,{tone:"indigo",title:"PAR (Portfolio at Risk)",value:`${R(e==null?void 0:e.parPercent)}%`,icon:a.jsx(lt,{className:"w-6 h-6"}),to:T(_.par,{tab:"par"})})]}),$&&a.jsxs("div",{className:`${S.card} p-4`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(lt,{className:"w-5 h-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:`Monthly Trends${$.month||$.year?` — ${$.month||""} ${$.year||""}`:""}`})]}),a.jsx("div",{className:"mb-4",children:a.jsx(Ee,{width:"100%",height:260,children:a.jsxs(Fe,{data:[{name:"Loans",value:R($.monthlyLoans)},{name:"Deposits",value:R($.monthlyDeposits)},{name:"Repayments",value:R($.monthlyRepayments)}],children:[a.jsx(Le,{stroke:b.grid,strokeDasharray:"3 3"}),a.jsx(Re,{dataKey:"name",tick:{fill:b.axis},axisLine:{stroke:b.axis},tickLine:{stroke:b.axis}}),a.jsx(Te,{tick:{fill:b.axis},axisLine:{stroke:b.axis},tickLine:{stroke:b.axis}}),a.jsx(_e,{contentStyle:{backgroundColor:b.tooltipBg,borderColor:b.grid,color:b.tooltipText},wrapperStyle:{outline:"none"}}),a.jsx(Me,{wrapperStyle:{color:b.legend}}),a.jsx(ne,{dataKey:"value",fill:b.bar1})]})})}),(()=>{const n=[R($.monthlyLoans),R($.monthlyDeposits),R($.monthlyRepayments)],i=Math.max(...n);return a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx("div",{className:"text-indigo-600",children:a.jsx(De,{label:"Loans (count)",value:R($.monthlyLoans),max:i})}),a.jsx("div",{className:"text-emerald-600",children:a.jsx(De,{label:"Deposits (TZS)",value:R($.monthlyDeposits),max:i})}),a.jsx("div",{className:"text-blue-600",children:a.jsx(De,{label:"Repayments (TZS)",value:R($.monthlyRepayments),max:i})})]})})()]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:S.tableWrap,children:[a.jsx("div",{className:"p-4 border-b-2 border-slate-200",children:a.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Top Borrowers"})}),He.length===0?a.jsx("div",{className:"p-4 text-sm text-slate-700",children:"No data available."}):a.jsxs("table",{className:"min-w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:S.th,children:"Name"}),a.jsx("th",{className:S.th,children:"Outstanding"})]})}),a.jsx("tbody",{children:He.map(n=>a.jsxs("tr",{children:[a.jsx("td",{className:S.td,children:n.name}),a.jsx("td",{className:S.td,children:F(n.outstanding)})]},n.id))})]})]}),a.jsxs("div",{className:S.tableWrap,children:[a.jsx("div",{className:"p-4 border-b-2 border-slate-200",children:a.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Upcoming Repayments"})}),Xe.length===0?a.jsx("div",{className:"p-4 text-sm text-slate-700",children:"No data available."}):a.jsxs("table",{className:"min-w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:S.th,children:"Borrower"}),a.jsx("th",{className:S.th,children:"Due Date"}),a.jsx("th",{className:S.th,children:"Amount"})]})}),a.jsx("tbody",{children:Xe.map(n=>a.jsxs("tr",{children:[a.jsx("td",{className:S.td,children:n.borrower}),a.jsx("td",{className:S.td,children:n.dueDate}),a.jsx("td",{className:S.td,children:F(n.amount)})]},n.id))})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:`${S.card} p-4`,children:[a.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Branch Performance"}),Ze.length===0?a.jsx("p",{className:"text-slate-700 text-sm",children:"No data available."}):a.jsx(Ee,{width:"100%",height:260,children:a.jsxs(Fe,{data:Ze,children:[a.jsx(Le,{stroke:b.grid,strokeDasharray:"3 3"}),a.jsx(Re,{dataKey:"branch",tick:{fill:b.axis},axisLine:{stroke:b.axis},tickLine:{stroke:b.axis}}),a.jsx(Te,{tick:{fill:b.axis},axisLine:{stroke:b.axis},tickLine:{stroke:b.axis}}),a.jsx(_e,{contentStyle:{backgroundColor:b.tooltipBg,borderColor:b.grid,color:b.tooltipText},wrapperStyle:{outline:"none"}}),a.jsx(Me,{wrapperStyle:{color:b.legend}}),a.jsx(ne,{dataKey:"disbursed",fill:b.bar1}),a.jsx(ne,{dataKey:"repayments",fill:b.bar2})]})})]}),a.jsxs("div",{className:`${S.card} p-4`,children:[a.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Officer Performance"}),Ye.length===0?a.jsx("p",{className:"text-slate-700 text-sm",children:"No data available."}):a.jsx(Ee,{width:"100%",height:260,children:a.jsxs(Fe,{data:Ye,children:[a.jsx(Le,{stroke:b.grid,strokeDasharray:"3 3"}),a.jsx(Re,{dataKey:"officer",tick:{fill:b.axis},axisLine:{stroke:b.axis},tickLine:{stroke:b.axis}}),a.jsx(Te,{tick:{fill:b.axis},axisLine:{stroke:b.axis},tickLine:{stroke:b.axis}}),a.jsx(_e,{contentStyle:{backgroundColor:b.tooltipBg,borderColor:b.grid,color:b.tooltipText},wrapperStyle:{outline:"none"}}),a.jsx(Me,{wrapperStyle:{color:b.legend}}),a.jsx(ne,{dataKey:"loans",fill:b.bar1}),a.jsx(ne,{dataKey:"collections",fill:b.bar2})]})})]})]})]})}),a.jsx("aside",{className:"lg:sticky lg:top-4 self-start",children:a.jsxs("div",{className:`${S.card} p-4`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(ct,{className:"w-5 h-5 text-indigo-600"}),a.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Recent Activity"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[a.jsx(Ke,{value:ue,onChange:n=>Ie(n.target.value),className:"h-9"}),a.jsx(Ke,{value:me,onChange:n=>Et(n.target.value),className:"h-9"}),a.jsx("button",{className:`${S.btn} col-span-2 h-9 text-sm`,onClick:()=>{Y(1),H({page:1})},children:"Search by date"})]}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-x-0 top-0 h-6 pointer-events-none bg-gradient-to-b from-white to-transparent"}),a.jsx("div",{className:"absolute inset-x-0 bottom-0 h-6 pointer-events-none bg-gradient-to-t from-white to-transparent"}),a.jsx("div",{className:"max-h-[520px] overflow-y-auto pr-1 space-y-3",children:U.length===0?a.jsx("p",{className:"text-slate-700 text-sm",children:"No activity."}):U.map(n=>{var i,u,O,D,V;return a.jsxs("div",{className:"rounded-xl border-2 border-slate-200 p-3",children:[a.jsxs("p",{className:"text-sm font-semibold text-slate-900",children:[n.type," • ",n.entityType," #",n.entityId]}),a.jsx("p",{className:"text-xs text-slate-800 break-words",children:n.message}),a.jsxs("p",{className:"text-[11px] text-slate-600 mt-1",children:["by ",((i=n.createdBy)==null?void 0:i.name)||((u=n.createdBy)==null?void 0:u.email)," • ",new Date(n.createdAt).toLocaleString()]}),Array.isArray(n.comments)&&n.comments.length>0&&a.jsx("div",{className:"mt-2 space-y-1",children:n.comments.map(E=>{var W,tt;return a.jsxs("div",{className:"bg-slate-50 border-2 border-slate-200 rounded p-2",children:[a.jsx("p",{className:"text-xs text-slate-900 break-words",children:E.comment}),a.jsxs("p",{className:"text-[11px] text-slate-600 mt-0.5",children:["— ",((W=E.createdBy)==null?void 0:W.name)||((tt=E.createdBy)==null?void 0:tt.email)," • ",new Date(E.createdAt).toLocaleString()]})]},E.id)})}),a.jsxs("div",{className:"mt-2 flex gap-2",children:[a.jsx(vt,{value:Ue[n.id]||"",onChange:E=>Ge(W=>({...W,[n.id]:E.target.value})),placeholder:"Reply…",className:"flex-1 h-9 text-xs"}),a.jsxs("button",{onClick:()=>Wt(n.id),disabled:qe[`c-${n.id}`],className:`${S.btn} h-9 px-2 text-xs disabled:opacity-50 gap-1`,children:[a.jsx(_a,{className:"w-3 h-3"})," Reply"]})]}),a.jsxs("div",{className:"mt-2 grid grid-cols-4 gap-2",children:[a.jsxs(xe,{value:((O=ve[n.id])==null?void 0:O.assigneeId)||"",onChange:E=>ge(W=>({...W,[n.id]:{...W[n.id]||{},assigneeId:E.target.value}})),className:"col-span-2 h-9 text-xs",children:[a.jsx("option",{value:"",children:"Assign to…"}),c.map(E=>a.jsx("option",{value:E.id,children:E.name||E.email},E.id))]}),a.jsx(Ke,{value:((D=ve[n.id])==null?void 0:D.dueDate)||"",onChange:E=>ge(W=>({...W,[n.id]:{...W[n.id]||{},dueDate:E.target.value}})),className:"h-9 text-xs"}),a.jsxs("button",{onClick:()=>Vt(n.id),disabled:qe[`a-${n.id}`],className:`${S.btn} h-9 px-2 text-xs disabled:opacity-50 gap-1`,children:[a.jsx(Ca,{className:"w-3 h-3"})," Assign"]}),a.jsx(vt,{value:((V=ve[n.id])==null?void 0:V.note)||"",onChange:E=>ge(W=>({...W,[n.id]:{...W[n.id]||{},note:E.target.value}})),placeholder:"Note…",className:"col-span-4 h-9 text-xs"})]})]},n.id)})})]}),G>q&&a.jsxs("div",{className:"flex justify-between items-center mt-3 text-xs text-slate-800",children:[a.jsxs("span",{children:[Math.min(K*q,G)," of ",G]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>{const n=Math.max(K-1,1);Y(n),H({page:n})},disabled:K===1,className:`${S.btn} px-2 py-1 disabled:opacity-50`,children:"Prev"}),a.jsx("button",{onClick:()=>{const n=K*q<G?K+1:K;n!==K&&(Y(n),H({page:n}))},disabled:K*q>=G,className:`${S.btn} px-2 py-1 disabled:opacity-50`,children:"Next"})]})]})]})})]})]})})},M=({title:t,value:e,icon:s,tone:r="indigo",to:o=null,delta:c=null,deltaLabel:d="",spark:p=null})=>{const g={indigo:"text-indigo-700 ring-indigo-200",sky:"text-sky-700 ring-sky-200",blue:"text-blue-700 ring-blue-200",emerald:"text-emerald-700 ring-emerald-200",cyan:"text-cyan-700 ring-cyan-200",amber:"text-amber-700 ring-amber-200",violet:"text-violet-700 ring-violet-200",rose:"text-rose-700 ring-rose-200",slate:"text-slate-700 ring-slate-200"}[r]||"text-slate-700 ring-slate-200",h=()=>{if(!Array.isArray(p)||p.length<2)return null;const f=96,y=28,v=2,A=Math.min(...p),N=Math.max(...p),I=Math.max(N-A,1e-6),j=(f-v*2)/(p.length-1),w="M "+p.map((m,P)=>{const k=(v+P*j).toFixed(1),C=(y-v-(m-A)/I*(y-v*2)).toFixed(1);return`${k} ${C}`}).join(" L ");return a.jsx("svg",{width:f,height:y,className:"mt-2 opacity-70",children:a.jsx("path",{d:w,fill:"none",stroke:"currentColor",strokeWidth:"2"})})},x=c==null?"":c>=0?"text-emerald-700 bg-emerald-50 ring-1 ring-emerald-200":"text-rose-700 bg-rose-50 ring-1 ring-rose-200";return a.jsxs("div",{className:"group relative",children:[o&&a.jsx(we,{to:o,className:"absolute inset-0 z-10 rounded-2xl focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500","aria-label":`View ${t} details`,title:`View ${t} details`}),a.jsxs("div",{className:"relative rounded-2xl border-2 border-slate-300 bg-white p-5 min-h-[10.5rem] shadow transition-all group-hover:shadow-md group-hover:-translate-y-0.5",children:[a.jsxs("div",{className:"relative flex items-start justify-between gap-3",children:[a.jsx("div",{className:`p-3 rounded-full bg-white ring-2 ${g}`,children:s}),c!=null&&a.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[11px] font-medium ${x}`,children:[c>=0?"↑":"↓"," ",Math.abs(c).toLocaleString(),"%",d&&a.jsxs("span",{className:"opacity-70",children:[" ",d]})]})]}),a.jsxs("div",{className:"relative mt-3 min-w-0",children:[a.jsx("h3",{className:`text-sm font-semibold ${g.split(" ")[0]} truncate`,children:t}),a.jsx("p",{className:"text-[28px] md:text-[32px] leading-tight font-semibold text-slate-900 font-mono tabular-nums break-words",children:e??"—"})]}),a.jsx("div",{className:"relative text-slate-400",children:a.jsx(h,{})})]})]})};export{rr as default};
