import{r as e,b as w}from"./index-uOcrLdeq.js";function J({url:d,params:r={},initialPage:A=1,initialLimit:b=20}){const[o,E]=e.useState(A),[n,x]=e.useState(b),[c,C]=e.useState(r.q||""),[L,f]=e.useState(!0),[M,m]=e.useState(""),[N,u]=e.useState([]),[P,l]=e.useState(0),[R,i]=e.useState(null),y=e.useMemo(()=>({...r,page:o,limit:n,q:c||void 0}),[r,o,n,c]),g=e.useMemo(()=>w.path(d||"/"),[d]),S=async s=>{var h,p,q;f(!0),m("");try{const t=await w.get(g,{params:y,signal:s}),a=t==null?void 0:t.data;Array.isArray(a)?(u(a),l(a.length),i(null)):a&&Array.isArray(a.data)?(u(a.data),l(((h=a.pagination)==null?void 0:h.total)??a.data.length??0),i(a.summary??null)):(u([]),l(0),i(null))}catch(t){(t==null?void 0:t.name)!=="CanceledError"&&(t==null?void 0:t.message)!=="canceled"&&m(((q=(p=t==null?void 0:t.response)==null?void 0:p.data)==null?void 0:q.error)||t.message||"Request failed")}finally{(!s||!s.aborted)&&f(!1)}};return e.useEffect(()=>{const s=new AbortController;return S(s.signal),()=>s.abort()},[g,JSON.stringify(y)]),{rows:N,total:P,page:o,setPage:E,limit:n,setLimit:x,q:c,setQ:C,loading:L,error:M,summary:R,refresh:()=>S()}}export{J as u};
