import{r as m,j as e,g as h}from"./index-CSL_HVM5.js";function u(t){const s=(t.startsWith("/")?t:`/${t}`).replace(/^\/api\//,"/"),n=s.startsWith("/api/")?s:`/api${s}`;return Array.from(new Set([s,n]))}async function y(t=[],l,s={}){let n;for(const d of t)try{const a=await h.post(d,l,s);return a==null?void 0:a.data}catch(a){n=a}throw n||new Error("No endpoint succeeded")}const w=()=>{const[t,l]=m.useState(null),[s,n]=m.useState(!1),[d,a]=m.useState(""),f=async i=>{var p,o;if(i.preventDefault(),a(""),!t)return;const r=new FormData;r.append("file",t);try{n(!0),await y([...u("borrowers/groups/import"),...u("groups/import"),...u("borrower-groups/import")],r,{headers:{"Content-Type":"multipart/form-data"}}),a("✅ Import uploaded. Processing…"),l(null)}catch(c){const b=((o=(p=c==null?void 0:c.response)==null?void 0:p.data)==null?void 0:o.error)||(c==null?void 0:c.message)||"Import failed.";a(`❌ ${b}`)}finally{n(!1)}},x=()=>{const i=`name,branchId,officerId,meetingDay,notes,members
Group A,1,,monday,Example notes,"254700000001;254700000002"
Group B,1,,friday,,
`,r=new Blob([i],{type:"text/csv;charset=utf-8"}),p=URL.createObjectURL(r),o=document.createElement("a");o.href=p,o.download="group_import_sample.csv",document.body.appendChild(o),o.click(),URL.revokeObjectURL(p),o.remove()};return e.jsxs("div",{className:"max-w-2xl p-4 space-y-4",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Group Imports"}),e.jsx("div",{className:"bg-white rounded shadow p-4 space-y-4",children:e.jsxs("form",{onSubmit:f,className:"space-y-3",children:[e.jsx("input",{type:"file",accept:".csv,.xlsx",onChange:i=>{var r;return l(((r=i.target.files)==null?void 0:r[0])||null)},className:"block w-full"}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Accepted: CSV/XLSX. Columns: ",e.jsx("b",{children:"name, branchId, officerId, meetingDay, notes, members"})," ","(meetingDay must be lowercase to match DB enum: monday…sunday; members can be a semicolon-separated list of borrower identifiers or phone numbers)."]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",disabled:!t||s,className:"px-3 py-2 bg-blue-600 text-white rounded disabled:opacity-60",children:s?"Uploading…":"Upload"}),e.jsx("button",{type:"button",onClick:x,className:"px-3 py-2 border rounded",children:"Download Sample"})]}),d&&e.jsx("div",{className:"text-sm",children:d})]})})]})};export{w as default};
