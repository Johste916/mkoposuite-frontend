import{r as l,g as se,j as a,L as we}from"./index-CGp3nliO.js";import{D as Xt}from"./download-dHirQmdj.js";import{C as De}from"./circle-plus-DKN16Ljb.js";import{c as X}from"./createLucideIcon-EGpy3i_p.js";import{i as at,S as Zt,a as Pe,r as Yt,u as gt,R as Jt,b as Qt,c as ea,d as ta,g as aa,e as yt,f as ra,h as sa,j as na,k as ke,l as ia,G as oa,C as la,m as bt,n as ca,L as Ae,o as da,p as ua,t as ma,q as rt,s as jt,v as Nt,w as wt,x as kt,y as pa,z as At,A as ha,J as fa,B as te,D as xa,E as va,F as ga,H as ya,I as st,K as Z,M as ba,N as ie,O as oe,P as ce,Q as ja,T as St,U as Pt,V as Ct,W as Na,X as wa,Y as nt,Z as ka,_ as Aa,$ as it,a0 as Sa,a1 as ze,a2 as ot,a3 as Pa,a4 as Ca,a5 as Ee,a6 as Le,a7 as Re,a8 as Te,a9 as _e,aa as Me}from"./CartesianChart-Bq-BoJEZ.js";import{U as Ia}from"./user-plus-CNDmeKfy.js";import{C as Oa}from"./chevron-down-D9m5XHMt.js";import{C as Ba}from"./calendar-CFS_u_dX.js";/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Da=[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]],lt=X("chart-no-axes-column",Da);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ea=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],ct=X("clipboard-list",Ea);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const La=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],$e=X("credit-card",La);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ra=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],ae=X("dollar-sign",Ra);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],_a=X("message-square",Ta);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ma=[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]],$a=X("thumbs-down",Ma);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fa=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],dt=X("triangle-alert",Fa);/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ka=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],za=X("users",Ka);var Wa="Invariant failed";function Va(t,e){throw new Error(Wa)}var Ua=["x","y"];function We(){return We=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},We.apply(null,arguments)}function ut(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,s)}return r}function he(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ut(Object(r),!0).forEach(function(s){Ga(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ut(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Ga(t,e,r){return(e=qa(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qa(t){var e=Ha(t,"string");return typeof e=="symbol"?e:e+""}function Ha(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xa(t,e){if(t==null)return{};var r,s,o=Za(t,e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(t);for(s=0;s<c.length;s++)r=c[s],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}function Za(t,e){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;r[s]=t[s]}return r}function Ya(t,e){var{x:r,y:s}=t,o=Xa(t,Ua),c="".concat(r),d=parseInt(c,10),h="".concat(s),g=parseInt(h,10),p="".concat(e.height||o.height),f=parseInt(p,10),x="".concat(e.width||o.width),y=parseInt(x,10);return he(he(he(he(he({},e),o),d?{x:d}:{}),g?{y:g}:{}),{},{height:f,width:y,name:e.name,radius:e.radius})}function It(t){return l.createElement(Zt,We({shapeType:"rectangle",propTransformer:Ya,activeClassName:"recharts-active-bar"},t))}var Ja=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(s,o)=>{if(at(e))return e;var c=at(s)||Pe(s);return c?e(s,o):(c||Va(),r)}},Qa=["onMouseEnter","onMouseLeave","onClick"],er=["value","background","tooltipPosition"],tr=["id"],ar=["onMouseEnter","onClick","onMouseLeave"];function le(){return le=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},le.apply(null,arguments)}function mt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,s)}return r}function L(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?mt(Object(r),!0).forEach(function(s){rr(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):mt(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function rr(t,e,r){return(e=sr(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sr(t){var e=nr(t,"string");return typeof e=="symbol"?e:e+""}function nr(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Se(t,e){if(t==null)return{};var r,s,o=ir(t,e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(t);for(s=0;s<c.length;s++)r=c[s],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}function ir(t,e){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;r[s]=t[s]}return r}var or=t=>{var{dataKey:e,name:r,fill:s,legendType:o,hide:c}=t;return[{inactive:c,dataKey:e,type:o,color:s,value:yt(r,e),payload:t}]};function lr(t){var{dataKey:e,stroke:r,strokeWidth:s,fill:o,name:c,hide:d,unit:h}=t;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:s,fill:o,dataKey:e,nameKey:void 0,name:yt(c,e),hide:d,type:t.tooltipType,color:t.fill,unit:h}}}function cr(t){var e=ke(jt),{data:r,dataKey:s,background:o,allOtherBarProps:c}=t,{onMouseEnter:d,onMouseLeave:h,onClick:g}=c,p=Se(c,Qa),f=Nt(d,s),x=wt(h),y=kt(g,s);if(!o||r==null)return null;var v=pa(o,!1);return l.createElement(l.Fragment,null,r.map((A,N)=>{var{value:C,background:j,tooltipPosition:w}=A,m=Se(A,er);if(!j)return null;var P=f(A,N),k=x(A,N),I=y(A,N),D=L(L(L(L(L({option:o,isActive:String(N)===e},m),{},{fill:"#eee"},j),v),At(p,A,N)),{},{onMouseEnter:P,onMouseLeave:k,onClick:I,dataKey:s,index:N,className:"recharts-bar-background-rectangle"});return l.createElement(It,le({key:"background-bar-".concat(N)},D))}))}function Ot(t){var{data:e,props:r,showLabels:s}=t,o=xa(r),{id:c}=o,d=Se(o,tr),{shape:h,dataKey:g,activeBar:p}=r,f=ke(jt),x=ke(va),{onMouseEnter:y,onClick:v,onMouseLeave:A}=r,N=Se(r,ar),C=Nt(y,g),j=wt(A),w=kt(v,g);return e?l.createElement(l.Fragment,null,e.map((m,P)=>{var k=p&&String(P)===f&&(x==null||g===x),I=k?p:h,D=L(L(L({},d),m),{},{isActive:k,option:I,index:P,dataKey:g});return l.createElement(Ae,le({className:"recharts-bar-rectangle"},At(N,m,P),{onMouseEnter:C(m,P),onMouseLeave:j(m,P),onClick:w(m,P),key:"rectangle-".concat(m==null?void 0:m.x,"-").concat(m==null?void 0:m.y,"-").concat(m==null?void 0:m.value,"-").concat(P)}),l.createElement(It,D))}),s&&ga.renderCallByParent(r,e)):null}function dr(t){var{props:e,previousRectanglesRef:r}=t,{data:s,layout:o,isAnimationActive:c,animationBegin:d,animationDuration:h,animationEasing:g,onAnimationEnd:p,onAnimationStart:f}=e,x=r.current,y=ha(e,"recharts-bar-"),[v,A]=l.useState(!1),N=l.useCallback(()=>{typeof p=="function"&&p(),A(!1)},[p]),C=l.useCallback(()=>{typeof f=="function"&&f(),A(!0)},[f]);return l.createElement(fa,{begin:d,duration:h,isActive:c,easing:g,onAnimationEnd:N,onAnimationStart:C,key:y},j=>{var w=j===1?s:s==null?void 0:s.map((m,P)=>{var k=x&&x[P];if(k)return L(L({},m),{},{x:te(k.x,m.x,j),y:te(k.y,m.y,j),width:te(k.width,m.width,j),height:te(k.height,m.height,j)});if(o==="horizontal"){var I=te(0,m.height,j);return L(L({},m),{},{y:m.y+m.height-I,height:I})}var D=te(0,m.width,j);return L(L({},m),{},{width:D})});return j>0&&(r.current=w??null),w==null?null:l.createElement(Ae,null,l.createElement(Ot,{props:e,data:w,showLabels:!v}))})}function ur(t){var{data:e,isAnimationActive:r}=t,s=l.useRef(null);return r&&e&&e.length&&(s.current==null||s.current!==e)?l.createElement(dr,{previousRectanglesRef:s,props:t}):l.createElement(Ot,{props:t,data:e,showLabels:!0})}var Bt=0,mr=(t,e)=>{var r=Array.isArray(t.value)?t.value[1]:t.value;return{x:t.x,y:t.y,value:r,errorVal:bt(t,e)}};class pr extends l.PureComponent{render(){var{hide:e,data:r,dataKey:s,className:o,xAxisId:c,yAxisId:d,needClip:h,background:g,id:p}=this.props;if(e)return null;var f=ca("recharts-bar",o),x=p;return l.createElement(Ae,{className:f,id:p},h&&l.createElement("defs",null,l.createElement(da,{clipPathId:x,xAxisId:c,yAxisId:d})),l.createElement(Ae,{className:"recharts-bar-rectangles",clipPath:h?"url(#clipPath-".concat(x,")"):void 0},l.createElement(cr,{data:r,dataKey:s,background:g,allOtherBarProps:this.props}),l.createElement(ur,this.props)),this.props.children)}}var hr={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!oa.isSsr,legendType:"rect",minPointSize:Bt,xAxisId:0,yAxisId:0};function fr(t){var{xAxisId:e,yAxisId:r,hide:s,legendType:o,minPointSize:c,activeBar:d,animationBegin:h,animationDuration:g,animationEasing:p,isAnimationActive:f}=t,{needClip:x}=ra(e,r),y=sa(),v=gt(),A=na(t.children,la),N=ke(w=>zr(w,e,r,v,t.id,A));if(y!=="vertical"&&y!=="horizontal")return null;var C,j=N==null?void 0:N[0];return j==null||j.height==null||j.width==null?C=0:C=y==="vertical"?j.height/2:j.width/2,l.createElement(ia,{xAxisId:e,yAxisId:r,data:N,dataPointFormatter:mr,errorBarOffset:C},l.createElement(pr,le({},t,{layout:y,needClip:x,data:N,xAxisId:e,yAxisId:r,hide:s,legendType:o,minPointSize:c,activeBar:d,animationBegin:h,animationDuration:g,animationEasing:p,isAnimationActive:f})))}function xr(t){var{layout:e,barSettings:{dataKey:r,minPointSize:s},pos:o,bandSize:c,xAxis:d,yAxis:h,xAxisTicks:g,yAxisTicks:p,stackedData:f,displayedData:x,offset:y,cells:v}=t,A=e==="horizontal"?h:d,N=f?A.scale.domain():null,C=ua({numericAxis:A});return x.map((j,w)=>{var m,P,k,I,D,Q;f?m=ma(f[w],N):(m=bt(j,r),Array.isArray(m)||(m=[C,m]));var U=Ja(s,Bt)(m[1],w);if(e==="horizontal"){var de,[G,ee]=[h.scale(m[0]),h.scale(m[1])];P=rt({axis:d,ticks:g,bandSize:c,offset:o.offset,entry:j,index:w}),k=(de=ee??G)!==null&&de!==void 0?de:void 0,I=o.size;var K=G-ee;if(D=ya(K)?0:K,Q={x:P,y:y.top,width:I,height:y.height},Math.abs(U)>0&&Math.abs(D)<Math.abs(U)){var Y=st(D||U)*(Math.abs(U)-Math.abs(D));k-=Y,D+=Y}}else{var[q,ue]=[d.scale(m[0]),d.scale(m[1])];if(P=q,k=rt({axis:h,ticks:p,bandSize:c,offset:o.offset,entry:j,index:w}),I=ue-q,D=o.size,Q={x:y.left,y:k,width:y.width,height:D},Math.abs(U)>0&&Math.abs(I)<Math.abs(U)){var Ce=st(I||U)*(Math.abs(U)-Math.abs(I));I+=Ce}}if(P==null||k==null||I==null||D==null)return null;var me=L(L({},j),{},{x:P,y:k,width:I,height:D,value:f?m:m[1],payload:j,background:Q,tooltipPosition:{x:P+I/2,y:k+D/2}},v&&v[w]&&v[w].props);return me}).filter(Boolean)}function ne(t){var e=Yt(t,hr),r=gt();return l.createElement(Jt,{id:e.id,type:"bar"},s=>l.createElement(l.Fragment,null,l.createElement(Qt,{legendPayload:or(e)}),l.createElement(ea,{fn:lr,args:e}),l.createElement(ta,{type:"bar",id:s,data:void 0,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:0,dataKey:e.dataKey,stackId:aa(e.stackId),hide:e.hide,barSize:e.barSize,minPointSize:e.minPointSize,maxBarSize:e.maxBarSize,isPanorama:r}),l.createElement(fr,le({},e,{id:s}))))}ne.displayName="Bar";function pt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,s)}return r}function je(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?pt(Object(r),!0).forEach(function(s){vr(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):pt(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function vr(t,e,r){return(e=gr(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gr(t){var e=yr(t,"string");return typeof e=="symbol"?e:e+""}function yr(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var br=(t,e)=>e,jr=(t,e,r)=>r,Nr=(t,e,r,s)=>s,wr=(t,e,r,s,o)=>o,xe=Z([Pt,wr],(t,e)=>t.filter(r=>r.type==="bar").find(r=>r.id===e)),kr=Z([xe],t=>t==null?void 0:t.maxBarSize),Ar=(t,e,r,s,o,c)=>c,ht=(t,e,r)=>{var s=r??t;if(!Pe(s))return ze(s,e,0)},Sr=Z([ce,Pt,br,jr,Nr],(t,e,r,s,o)=>e.filter(c=>t==="horizontal"?c.xAxisId===r:c.yAxisId===s).filter(c=>c.isPanorama===o).filter(c=>c.hide===!1).filter(c=>c.type==="bar")),Pr=(t,e,r,s)=>{var o=ce(t);return o==="horizontal"?nt(t,"yAxis",r,s):nt(t,"xAxis",e,s)},Cr=(t,e,r)=>{var s=ce(t);return s==="horizontal"?it(t,"xAxis",e):it(t,"yAxis",r)},Ir=(t,e,r)=>{var s={},o=t.filter(Sa),c=t.filter(p=>p.stackId==null),d=o.reduce((p,f)=>(p[f.stackId]||(p[f.stackId]=[]),p[f.stackId].push(f),p),s),h=Object.entries(d).map(p=>{var[f,x]=p,y=x.map(A=>A.dataKey),v=ht(e,r,x[0].barSize);return{stackId:f,dataKeys:y,barSize:v}}),g=c.map(p=>{var f=[p.dataKey].filter(y=>y!=null),x=ht(e,r,p.barSize);return{stackId:void 0,dataKeys:f,barSize:x}});return[...h,...g]},Or=Z([Sr,Aa,Cr],Ir),Br=(t,e,r,s,o)=>{var c,d,h=xe(t,e,r,s,o);if(h!=null){var g=ce(t),p=Ct(t),{maxBarSize:f}=h,x=Pe(f)?p:f,y,v;return g==="horizontal"?(y=ie(t,"xAxis",e,s),v=oe(t,"xAxis",e,s)):(y=ie(t,"yAxis",r,s),v=oe(t,"yAxis",r,s)),(c=(d=St(y,v,!0))!==null&&d!==void 0?d:x)!==null&&c!==void 0?c:0}},Dt=(t,e,r,s)=>{var o=ce(t),c,d;return o==="horizontal"?(c=ie(t,"xAxis",e,s),d=oe(t,"xAxis",e,s)):(c=ie(t,"yAxis",r,s),d=oe(t,"yAxis",r,s)),St(c,d)};function Dr(t,e,r,s,o){var c=s.length;if(!(c<1)){var d=ze(t,r,0,!0),h,g=[];if(ot(s[0].barSize)){var p=!1,f=r/c,x=s.reduce((j,w)=>j+(w.barSize||0),0);x+=(c-1)*d,x>=r&&(x-=(c-1)*d,d=0),x>=r&&f>0&&(p=!0,f*=.9,x=c*f);var y=(r-x)/2>>0,v={offset:y-d,size:0};h=s.reduce((j,w)=>{var m,P={stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:v.offset+v.size+d,size:p?f:(m=w.barSize)!==null&&m!==void 0?m:0}},k=[...j,P];return v=k[k.length-1].position,k},g)}else{var A=ze(e,r,0,!0);r-2*A-(c-1)*d<=0&&(d=0);var N=(r-2*A-(c-1)*d)/c;N>1&&(N>>=0);var C=ot(o)?Math.min(N,o):N;h=s.reduce((j,w,m)=>[...j,{stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:A+(N+d)*m+(N-C)/2,size:C}}],g)}return h}}var Er=(t,e,r,s,o,c,d)=>{var h=Pe(d)?e:d,g=Dr(r,s,o!==c?o:c,t,h);return o!==c&&g!=null&&(g=g.map(p=>je(je({},p),{},{position:je(je({},p.position),{},{offset:p.position.offset-o/2})}))),g},Lr=Z([Or,Ct,Na,wa,Br,Dt,kr],Er),Rr=(t,e,r,s)=>ie(t,"xAxis",e,s),Tr=(t,e,r,s)=>ie(t,"yAxis",r,s),_r=(t,e,r,s)=>oe(t,"xAxis",e,s),Mr=(t,e,r,s)=>oe(t,"yAxis",r,s),$r=Z([Lr,xe],(t,e)=>{if(!(t==null||e==null)){var r=t.find(s=>s.stackId===e.stackId&&e.dataKey!=null&&s.dataKeys.includes(e.dataKey));if(r!=null)return r.position}}),Fr=(t,e)=>{var r=ka(e);if(!(!t||r==null||e==null)){var{stackId:s}=e;if(s!=null){var o=t[s];if(o){var{stackedData:c}=o;if(c)return c.find(d=>d.key===r)}}}},Kr=Z([Pr,xe],Fr),zr=Z([ba,Rr,Tr,_r,Mr,$r,ce,ja,Dt,Kr,xe,Ar],(t,e,r,s,o,c,d,h,g,p,f,x)=>{var{chartData:y,dataStartIndex:v,dataEndIndex:A}=h;if(!(f==null||c==null||d!=="horizontal"&&d!=="vertical"||e==null||r==null||s==null||o==null||g==null)){var{data:N}=f,C;if(N!=null&&N.length>0?C=N:C=y==null?void 0:y.slice(v,A+1),C!=null)return xr({layout:d,barSettings:f,pos:c,bandSize:g,xAxis:e,yAxis:r,xAxisTicks:s,yAxisTicks:o,stackedData:p,displayedData:C,offset:t,cells:x})}}),Wr=["axis","item"],Fe=l.forwardRef((t,e)=>l.createElement(Pa,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Wr,tooltipPayloadSearcher:Ca,categoricalChartProps:t,ref:e}));const _={borrowers:"/borrowers",loans:"/loans",repayments:"/repayments",expectedRepayments:"/repayments",deposits:"/deposits",withdrawals:"/withdrawals",savings:"/savings",defaultedLoans:"/loans",defaultedInterest:"/loans",outstandingLoan:"/loans",outstandingInterest:"/loans",writtenOff:"/loans",par:"/loans"},ft="ms_dash_filters_v1",xt="ms_dash_auto_refresh_v1";function J(t){const r=(t.startsWith("/")?t:`/${t}`).replace(/^\/api\//,"/"),s=r.startsWith("/api/")?r:`/api${r}`;return Array.from(new Set([r,s]))}function re(t){return(t==null?void 0:t.name)==="CanceledError"||(t==null?void 0:t.code)==="ERR_CANCELED"||/abort|cancell?ed/i.test((t==null?void 0:t.message)||"")}async function Ne(t=[],e={}){let r;for(const s of t)try{const o=await se.get(s,e);return o==null?void 0:o.data}catch(o){r=o}throw r||new Error("No endpoint succeeded")}function Vr(t){return(Array.isArray(t)?t:(t==null?void 0:t.items)||(t==null?void 0:t.rows)||(t==null?void 0:t.data)||[]).map(r=>({id:r.id??r._id??r.branchId??r.code??String(r.name||"branch"),name:r.name??r.title??r.label??String(r.code||"—")}))}function Ur(t){return(Array.isArray(t)?t:(t==null?void 0:t.items)||(t==null?void 0:t.rows)||(t==null?void 0:t.data)||[]).map(r=>({id:r.id??r._id??r.userId??String(r.email||r.phone||"user"),name:r.name||[r.firstName,r.lastName].filter(Boolean).join(" ").trim()||r.username||r.email||r.phone||"—",roles:(r.roles||r.Roles||[]).map(s=>(s.name||s.code||"").toString().toLowerCase()),title:(r.title||r.jobTitle||"").toString().toLowerCase()}))}function Gr(t){const e=[...t.roles||[],t.title||""].join(" ");return/loan.*officer|credit.*officer|field.*officer/i.test(e)}function qr(t){const e=(t==null?void 0:t.summary)||t||{},r=o=>Number(o||0),s=o=>{if(o==null)return 0;const c=String(o).trim().replace("%",""),d=Number(c);return Number.isFinite(d)?d:0};return{totalBorrowers:r(e.totalBorrowers??e.borrowers??e.clients),totalLoans:r(e.totalLoans??e.loans),totalDisbursed:r(e.totalDisbursed??e.disbursed),totalPaid:r(e.totalPaid??e.paid),totalRepaid:r(e.totalRepaid??e.repaid??e.collections),totalExpectedRepayments:r(e.totalExpectedRepayments??e.expectedRepayments),totalDeposits:r(e.totalDeposits??e.deposits),totalWithdrawals:r(e.totalWithdrawals??e.withdrawals),netSavings:r(e.netSavings??(e.totalDeposits||0)-(e.totalWithdrawals||0)),defaultedLoan:r(e.defaultedLoan??e.defaulted??e.nplPrincipal),defaultedInterest:r(e.defaultedInterest??e.nplInterest),outstandingLoan:r(e.outstandingLoan??e.outstandingPrincipal??e.outstanding),outstandingInterest:r(e.outstandingInterest??e.accruedInterest),writtenOff:r(e.writtenOff??e.writeOffs),parPercent:s(e.parPercent??e.par??e.par30??e.portfolioAtRisk),topBorrowers:Array.isArray(e.topBorrowers)?e.topBorrowers:[],upcomingRepayments:Array.isArray(e.upcomingRepayments)?e.upcomingRepayments:[],branchPerformance:Array.isArray(e.branchPerformance)?e.branchPerformance:[],officerPerformance:Array.isArray(e.officerPerformance)?e.officerPerformance:[]}}const Hr=()=>{const[t,e]=l.useState(()=>typeof document<"u"&&document.documentElement.classList.contains("dark"));return l.useEffect(()=>{if(typeof document>"u")return;const r=document.documentElement,s=new MutationObserver(()=>e(r.classList.contains("dark")));return s.observe(r,{attributes:!0,attributeFilter:["class"]}),()=>s.disconnect()},[]),t},Xr=new Intl.NumberFormat(void 0,{maximumFractionDigits:0}),S={container:"w-full px-4 md:px-6 lg:px-8 py-6",h1:"text-3xl font-extrabold tracking-tight",card:"card",btn:"inline-flex items-center justify-center rounded-lg px-3 py-2 font-semibold transition border-2 border-[var(--border-strong)] bg-[var(--card)] text-[var(--fg)] hover:bg-[var(--chip-soft)]",tableWrap:"overflow-x-auto rounded-2xl border-2 shadow bg-[var(--card)] border-[var(--border-strong)]",th:"bg-[var(--table-head-bg)] text-left text-[13px] uppercase tracking-wide font-semibold px-3 py-2 border border-[var(--border)] text-[var(--fg)] opacity-90",td:"px-3 py-2 border border-[var(--border)] text-sm text-[var(--fg)]"},Ve="h-10 w-full rounded-lg text-sm outline-none transition border-2 bg-[var(--input-bg)] text-[var(--input-fg)] border-[var(--input-border)] focus:ring-2 focus:ring-[var(--ring)]",fe=({className:t="",children:e,...r})=>a.jsxs("div",{className:`relative ${t}`,children:[a.jsx("select",{...r,className:`${Ve} pr-9 appearance-none bg-none ms-select`,children:e}),a.jsx(Oa,{className:"pointer-events-none absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--muted)]","aria-hidden":"true"})]}),Ke=({className:t="",...e})=>a.jsxs("div",{className:`relative ${t}`,children:[a.jsx("input",{type:"date",...e,className:`${Ve} pr-9 appearance-none bg-none ms-date`}),a.jsx(Ba,{className:"pointer-events-none absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--muted)]","aria-hidden":"true"})]}),vt=({className:t="",...e})=>a.jsx("input",{...e,className:`${Ve} ${t}`}),ss=()=>{const t=Hr(),[e,r]=l.useState(null),[s,o]=l.useState([]),[c,d]=l.useState([]),[h,g]=l.useState(""),[p,f]=l.useState(""),[x,y]=l.useState(""),[v,A]=l.useState(0),[N,C]=l.useState(null),[j,w]=l.useState(null),[m,P]=l.useState(Date.now()),[k,I]=l.useState([]),[D,Q]=l.useState(!1),[U,de]=l.useState([]),[G,ee]=l.useState(0),[K,Y]=l.useState(1),q=10,[ue,Ce]=l.useState(""),[me,Et]=l.useState(""),[Ue,Ge]=l.useState({}),[ve,ge]=l.useState({}),[qe,ye]=l.useState({}),[$,Lt]=l.useState(null),[He,Rt]=l.useState([]),[Xe,Tt]=l.useState([]),[Ze,_t]=l.useState([]),[Ye,Mt]=l.useState([]),[$t,Ft]=l.useState(!0),[Kt,Je]=l.useState([]),z=(n,i="info")=>{const u=Math.random().toString(36).slice(2);Je(O=>[...O,{id:u,msg:n,type:i}]),setTimeout(()=>Je(O=>O.filter(B=>B.id!==u)),3500)},R=n=>{const i=Number(n);return Number.isFinite(i)?i:0},F=n=>{const i=R(n);return Number.isNaN(i)?"TZS —":`TZS ${Xr.format(i)}`},T=(n,i={})=>{try{const u=new URLSearchParams;h&&u.set("branchId",h),p&&u.set("officerId",p),x&&u.set("timeRange",x),Object.entries(i).forEach(([B,V])=>{V!=null&&String(V)!==""&&u.set(B,V)});const O=u.toString();return O?`${n}?${O}`:n}catch{return n}},zt=n=>{var i;return((i=s.find(u=>String(u.id)===String(n)))==null?void 0:i.name)||(n?`Branch #${n}`:"All branches")};l.useEffect(()=>{try{const n=localStorage.getItem(ft);if(n){const i=JSON.parse(n);g(i.branchId||""),f(i.officerId||""),y(i.timeRange||"")}}catch{}try{const n=localStorage.getItem(xt);n&&A(Number(n)||0)}catch{}},[]),l.useEffect(()=>{const n={branchId:h,officerId:p,timeRange:x};localStorage.setItem(ft,JSON.stringify(n))},[h,p,x]),l.useEffect(()=>{localStorage.setItem(xt,String(v||0))},[v]);const Qe=l.useCallback(async n=>{try{const[i,u]=await Promise.all([Ne([...J("branches"),...J("org/branches")],{signal:n}),Ne([...J("users?role=loan_officer"),...J("admin/staff?role=loan_officer")],{signal:n}).catch(()=>Ne([...J("users"),...J("admin/staff")],{signal:n}))]),O=Vr(i),B=Ur(u),V=B.filter(Gr);o(O),d(V.length?V:B)}catch(i){re(i)||(console.error("Filter fetch error:",(i==null?void 0:i.message)||i),z("Failed to load filters","error"))}},[]),Ie=l.useCallback(async n=>{try{const i=await Ne([...J("dashboard/summary")],{signal:n,params:{branchId:h,officerId:p,timeRange:x}});r(qr(i))}catch(i){re(i)||(console.error("Dashboard summary error:",(i==null?void 0:i.message)||i),z("Failed to load summary","error"))}},[h,p,x]),pe=l.useCallback(async n=>{Q(!0);try{const i=await se.get("/dashboard/communications",{signal:n}).catch(()=>null);i!=null&&i.data&&Array.isArray(i.data)?I(i.data):I(Array.isArray(e==null?void 0:e.generalCommunications)?e.generalCommunications:[])}finally{Q(!1)}},[e]),H=l.useCallback(async(n={},i)=>{var u,O;try{const B=await se.get("/dashboard/activity",{params:{page:n.page??K,pageSize:q,dateFrom:ue||void 0,dateTo:me||void 0},signal:i});de(((u=B.data)==null?void 0:u.items)||[]),ee(((O=B.data)==null?void 0:O.total)||0)}catch(B){re(B)||(console.error("Activity fetch error:",(B==null?void 0:B.message)||B),z("Failed to load activity","error"))}},[K,ue,me]),Oe=l.useCallback(async n=>{try{const i=await se.get("/dashboard/monthly-trends",{signal:n});Lt(i.data||{})}catch(i){re(i)||(console.error("Monthly trends error:",(i==null?void 0:i.message)||i),z("Failed to load trends","error"))}},[]);l.useEffect(()=>{const n=new AbortController;return(async()=>{try{await Qe(n.signal)}catch{}})(),()=>n.abort()},[Qe]);const be=l.useCallback(async n=>{await Promise.all([Ie(n),H({},n),Oe(n)]),C(new Date),v>0&&w(Date.now()+v*6e4)},[Ie,H,Oe,v]);l.useEffect(()=>{const n=new AbortController;return(async()=>{try{await be(n.signal)}catch(i){re(i)||(console.error("Dashboard fetch error:",(i==null?void 0:i.message)||i),z("Failed to load dashboard data","error"))}finally{Ft(!1)}})(),()=>n.abort()},[be]),l.useEffect(()=>{if(!e)return;const n=new AbortController;return pe(n.signal).catch(i=>{re(i)||(console.error("Comms fetch error:",(i==null?void 0:i.message)||i),z("Failed to load communications","error"))}),()=>n.abort()},[e,pe]),l.useEffect(()=>{e&&(Array.isArray(e.topBorrowers)&&Rt(e.topBorrowers),Array.isArray(e.upcomingRepayments)&&Tt(e.upcomingRepayments),Array.isArray(e.branchPerformance)&&_t(e.branchPerformance),Array.isArray(e.officerPerformance)&&Mt(e.officerPerformance))},[e]),l.useEffect(()=>{if(!v||v<=0){w(null);return}const i=setInterval(()=>{const u=new AbortController;Promise.all([be(u.signal),pe(u.signal)]).catch(()=>{}).finally(()=>u.abort())},v*6e4);return w(Date.now()+v*6e4),()=>clearInterval(i)},[v,be,pe]),l.useEffect(()=>{const n=setInterval(()=>P(Date.now()),1e3);return()=>clearInterval(n)},[]);const Wt=async n=>{const i=`c-${n}`;ye(u=>({...u,[i]:!0}));try{const u=(Ue[n]||"").trim();if(!u)return;await se.post(`/dashboard/activity/${n}/comment`,{comment:u}),Ge(O=>({...O,[n]:""})),await H(),z("Reply posted","success")}catch(u){console.error("Add comment error:",(u==null?void 0:u.message)||u),z("Failed to post reply","error")}finally{ye(u=>({...u,[i]:!1}))}},Vt=async n=>{const i=`a-${n}`;ye(u=>({...u,[i]:!0}));try{const u=ve[n]||{};if(!u.assigneeId)return;await se.post(`/dashboard/activity/${n}/assign`,{assigneeId:u.assigneeId,dueDate:u.dueDate||null,note:u.note||""}),ge(O=>({...O,[n]:{assigneeId:"",dueDate:"",note:""}})),await H(),z("Task assigned","success")}catch(u){console.error("Assign task error:",(u==null?void 0:u.message)||u),z("Failed to assign task","error")}finally{ye(u=>({...u,[i]:!1}))}},Be=({label:n,value:i,max:u})=>{const O=R(i),B=R(u),V=B>0?Math.round(O/B*100):0;return a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between text-xs text-[var(--muted)]",children:[a.jsx("span",{children:n}),a.jsx("span",{className:"tabular-nums text-[var(--fg)]/80",children:O.toLocaleString()})]}),a.jsx("div",{className:"h-2 w-full rounded bg-[var(--table-head-bg)]",children:a.jsx("div",{className:"h-2 rounded transition-[width] duration-500",style:{width:`${V}%`,backgroundColor:"currentColor"}})})]})},Ut=({className:n=""})=>a.jsx("div",{className:`animate-pulse rounded bg-[var(--table-head-bg)] ${n}`}),Gt=()=>{const n=k.flatMap(i=>(i.attachments||[]).map(u=>u.fileUrl)).filter(Boolean);n.length!==0&&(n.forEach((i,u)=>{setTimeout(()=>window.open(i,"_blank","noopener,noreferrer"),u*150)}),z(`Opening ${n.length} attachment${n.length>1?"s":""}…`,"info"))},b=t?{grid:"#334155",axis:"#cbd5e1",legend:"#e2e8f0",tooltipBg:"#0b1220",tooltipText:"#e2e8f0",bar1:"#60a5fa",bar2:"#34d399"}:{grid:"#e2e8f0",axis:"#334155",legend:"#334155",tooltipBg:"#ffffff",tooltipText:"#0f172a",bar1:"#2563eb",bar2:"#10b981"},et=j?Math.max(0,Math.floor((j-m)/1e3)):0,qt=String(Math.floor(et/60)).padStart(2,"0"),Ht=String(et%60).padStart(2,"0");return a.jsx("div",{className:S.container,children:a.jsxs("div",{className:"space-y-6",style:{color:"var(--fg)"},children:[a.jsx("style",{children:`
          select.ms-select{ -webkit-appearance:none; -moz-appearance:none; appearance:none; background-image:none!important; }
          select.ms-select::-ms-expand{ display:none; }
          input.ms-date[type="date"]{ -webkit-appearance:none; appearance:none; background-image:none!important; }
          input.ms-date[type="date"]::-webkit-calendar-picker-indicator{ opacity:0; display:none; }
        `}),a.jsxs("div",{className:`${S.card} p-4 md:p-6`,children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-end md:justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:S.h1,children:"Dashboard"}),a.jsx("p",{className:"text-sm mt-1",style:{color:"var(--muted)"},children:"Quick snapshot of borrowers, loans, repayments and savings."}),a.jsx("p",{className:"text-xs mt-1",style:{color:"var(--muted)"},children:N?`Last updated ${N.toLocaleString()}`:"Loading…"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsxs(fe,{"aria-label":"Filter by branch",value:h,onChange:n=>g(n.target.value),className:"min-w-[11rem]",children:[a.jsx("option",{value:"",children:"All Branches"}),s.map(n=>a.jsx("option",{value:n.id,children:n.name},n.id))]}),a.jsxs(fe,{"aria-label":"Filter by loan officer",value:p,onChange:n=>f(n.target.value),className:"min-w-[12rem]",children:[a.jsx("option",{value:"",children:"All Loan Officers"}),c.map(n=>a.jsx("option",{value:n.id,children:n.name||n.email},n.id))]}),a.jsxs(fe,{"aria-label":"Filter by time range",value:x,onChange:n=>y(n.target.value),className:"min-w-[10rem]",children:[a.jsx("option",{value:"",children:"All Time"}),a.jsx("option",{value:"today",children:"Today"}),a.jsx("option",{value:"week",children:"This Week"}),a.jsx("option",{value:"month",children:"This Month"}),a.jsx("option",{value:"quarter",children:"This Quarter"}),a.jsx("option",{value:"semiAnnual",children:"Semi-Annual"}),a.jsx("option",{value:"annual",children:"Annual"})]}),a.jsxs(fe,{"aria-label":"Auto refresh interval",value:v,onChange:n=>A(Number(n.target.value)),className:"min-w-[12rem]",children:[a.jsx("option",{value:0,children:"No Auto-Refresh"}),a.jsx("option",{value:1,children:"Every 1 min"}),a.jsx("option",{value:5,children:"Every 5 mins"}),a.jsx("option",{value:15,children:"Every 15 mins"})]}),a.jsx("button",{className:S.btn,onClick:()=>{const n=new AbortController;Promise.all([Ie(n.signal),H({page:1},n.signal),Oe(n.signal),pe(n.signal)]).then(()=>{Y(1),C(new Date),v>0&&w(Date.now()+v*6e4),z("Dashboard refreshed","success")}).catch(()=>z("Refresh failed","error")).finally(()=>n.abort())},"aria-label":"Refresh dashboard",children:"Refresh"})]})]}),v>0&&j&&a.jsxs("div",{className:"mt-3 inline-flex items-center gap-2 rounded-full px-2.5 py-1 text-xs",style:{border:"2px solid var(--border-strong)",color:"var(--fg)"},children:["Auto-refresh in ",qt,":",Ht]})]}),a.jsx("div",{className:"fixed right-4 top-4 z-50 space-y-2",children:Kt.map(n=>a.jsx("div",{className:`px-3 py-2 rounded shadow text-sm text-white ${n.type==="error"?"bg-red-600":n.type==="success"?"bg-emerald-600":"bg-slate-800"}`,children:n.msg},n.id))}),((k==null?void 0:k.length)??0)>0&&a.jsxs("div",{className:`${S.card} overflow-hidden`,children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b",style:{borderColor:"var(--border)",background:"var(--table-head-bg)"},children:[a.jsx("div",{className:"text-xs font-semibold",style:{color:"var(--muted)"},children:"General Communications"}),k.some(n=>Array.isArray(n.attachments)&&n.attachments.length>0)&&a.jsxs("button",{onClick:Gt,className:`${S.btn} h-7 px-2 text-xs`,title:"Open all attachments",disabled:D,children:[a.jsx(Xt,{className:"w-3 h-3"})," Download all"]})]}),a.jsxs("div",{className:"relative h-10",children:[a.jsx("style",{children:"@keyframes ms-marquee{0%{transform:translateX(100%)}100%{transform:translateX(-100%)}}"}),a.jsx("div",{className:"absolute whitespace-nowrap will-change-transform text-sm flex items-center gap-8 px-3",style:{animation:"ms-marquee 18s linear infinite",color:"var(--fg)"},children:k.map((n,i)=>a.jsxs("span",{className:"inline-flex items-center gap-2",children:[n.type&&a.jsx("span",{className:"text-[11px] px-1.5 py-0.5 rounded border",style:{background:"var(--card)",borderColor:"var(--border)"},children:n.type}),n.priority&&a.jsx("span",{className:"text-[11px] px-1.5 py-0.5 rounded border",style:{background:"var(--card)",borderColor:"var(--border)"},children:n.priority}),n.audienceRole&&a.jsxs("span",{className:"text-[11px] px-1.5 py-0.5 rounded border",style:{background:"var(--card)",borderColor:"var(--border)"},children:["role: ",n.audienceRole]}),typeof n.audienceBranchId<"u"&&n.audienceBranchId!==null&&a.jsx("span",{className:"text-[11px] px-1.5 py-0.5 rounded border",style:{background:"var(--card)",borderColor:"var(--border)"},children:zt(n.audienceBranchId)}),a.jsx("span",{className:"inline-block w-1.5 h-1.5 rounded-full bg-blue-600"}),a.jsx("span",{className:"truncate",children:n.text})]},n.id||n.text||i))})]})]}),a.jsxs("div",{className:"flex flex-wrap gap-3",children:[a.jsxs(we,{to:"/loans/add",className:S.btn,children:[a.jsx(De,{className:"w-4 h-4"})," Add Loan"]}),a.jsxs(we,{to:"/borrowers/add",className:S.btn,children:[a.jsx(De,{className:"w-4 h-4"})," Add Borrower"]}),a.jsxs(we,{to:"/repayments/new",className:S.btn,children:[a.jsx(De,{className:"w-4 h-4"})," Record Repayment"]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr_360px] gap-6",children:[a.jsx("main",{className:"space-y-6",children:$t?a.jsx("div",{className:"grid gap-6 [grid-template-columns:repeat(auto-fit,minmax(230px,1fr))]",children:Array.from({length:8}).map((n,i)=>a.jsx(Ut,{className:"h-32"},i))}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid gap-6 [grid-template-columns:repeat(auto-fit,minmax(230px,1fr))]",children:[a.jsx(M,{tone:"indigo",title:"Total Borrowers",value:R(e==null?void 0:e.totalBorrowers).toLocaleString(),icon:a.jsx(za,{className:"w-6 h-6"}),to:T(_.borrowers)}),a.jsx(M,{tone:"sky",title:"Total Loans",value:R(e==null?void 0:e.totalLoans).toLocaleString(),icon:a.jsx($e,{className:"w-6 h-6"}),to:T(_.loans)}),a.jsx(M,{tone:"blue",title:"Total Disbursed",value:F(e==null?void 0:e.totalDisbursed),icon:a.jsx($e,{className:"w-6 h-6"}),to:T(_.loans,{tab:"disbursed"})}),a.jsx(M,{tone:"emerald",title:"Total Paid",value:F(e==null?void 0:e.totalPaid),icon:a.jsx(ae,{className:"w-6 h-6"}),to:T(_.repayments,{tab:"paid"})}),a.jsx(M,{tone:"emerald",title:"Total Repaid",value:F(e==null?void 0:e.totalRepaid),icon:a.jsx(ae,{className:"w-6 h-6"}),to:T(_.repayments,{tab:"paid"})}),a.jsx(M,{tone:"indigo",title:"Expected Repayments",value:F(e==null?void 0:e.totalExpectedRepayments),icon:a.jsx(ct,{className:"w-6 h-6"}),to:T(_.expectedRepayments,{tab:"expected"})}),a.jsx(M,{tone:"cyan",title:"Total Deposits",value:F(e==null?void 0:e.totalDeposits),icon:a.jsx(ae,{className:"w-6 h-6"}),to:T(_.deposits)}),a.jsx(M,{tone:"amber",title:"Total Withdrawals",value:F(e==null?void 0:e.totalWithdrawals),icon:a.jsx(ae,{className:"w-6 h-6"}),to:T(_.withdrawals)}),a.jsx(M,{tone:"blue",title:"Net Savings",value:F(e==null?void 0:e.netSavings),icon:a.jsx(ae,{className:"w-6 h-6"}),to:T(_.savings)}),a.jsx(M,{tone:"rose",title:"Defaulted Loan",value:F(e==null?void 0:e.defaultedLoan),icon:a.jsx(dt,{className:"w-6 h-6"}),to:T(_.defaultedLoans,{tab:"defaulted"})}),a.jsx(M,{tone:"rose",title:"Defaulted Interest",value:F(e==null?void 0:e.defaultedInterest),icon:a.jsx(dt,{className:"w-6 h-6"}),to:T(_.defaultedInterest,{tab:"defaulted-interest"})}),a.jsx(M,{tone:"violet",title:"Outstanding Loan",value:F(e==null?void 0:e.outstandingLoan),icon:a.jsx($e,{className:"w-6 h-6"}),to:T(_.outstandingLoan,{tab:"outstanding"})}),a.jsx(M,{tone:"violet",title:"Outstanding Interest",value:F(e==null?void 0:e.outstandingInterest),icon:a.jsx(ae,{className:"w-6 h-6"}),to:T(_.outstandingInterest,{tab:"outstanding-interest"})}),a.jsx(M,{tone:"slate",title:"Written Off",value:F(e==null?void 0:e.writtenOff),icon:a.jsx($a,{className:"w-6 h-6"}),to:T(_.writtenOff,{tab:"written-off"})}),a.jsx(M,{tone:"indigo",title:"PAR (Portfolio at Risk)",value:`${R(e==null?void 0:e.parPercent)}%`,icon:a.jsx(lt,{className:"w-6 h-6"}),to:T(_.par,{tab:"par"})})]}),$&&a.jsxs("div",{className:`${S.card} p-4`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(lt,{className:"w-5 h-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold",children:`Monthly Trends${$.month||$.year?` — ${$.month||""} ${$.year||""}`:""}`})]}),a.jsx("div",{className:"mb-4",children:a.jsx(Ee,{width:"100%",height:260,children:a.jsxs(Fe,{data:[{name:"Loans",value:R($.monthlyLoans)},{name:"Deposits",value:R($.monthlyDeposits)},{name:"Repayments",value:R($.monthlyRepayments)}],children:[a.jsx(Le,{stroke:b.grid,strokeDasharray:"3 3"}),a.jsx(Re,{dataKey:"name",tick:{fill:b.axis},axisLine:{stroke:b.axis},tickLine:{stroke:b.axis}}),a.jsx(Te,{tick:{fill:b.axis},axisLine:{stroke:b.axis},tickLine:{stroke:b.axis}}),a.jsx(_e,{contentStyle:{backgroundColor:b.tooltipBg,borderColor:b.grid,color:b.tooltipText},wrapperStyle:{outline:"none"}}),a.jsx(Me,{wrapperStyle:{color:b.legend}}),a.jsx(ne,{dataKey:"value",fill:b.bar1})]})})}),(()=>{const n=[R($.monthlyLoans),R($.monthlyDeposits),R($.monthlyRepayments)],i=Math.max(...n);return a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx("div",{className:"text-indigo-600",children:a.jsx(Be,{label:"Loans (count)",value:R($.monthlyLoans),max:i})}),a.jsx("div",{className:"text-emerald-600",children:a.jsx(Be,{label:"Deposits (TZS)",value:R($.monthlyDeposits),max:i})}),a.jsx("div",{className:"text-blue-600",children:a.jsx(Be,{label:"Repayments (TZS)",value:R($.monthlyRepayments),max:i})})]})})()]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:S.tableWrap,children:[a.jsx("div",{className:"p-4 border-b",style:{borderColor:"var(--border)"},children:a.jsx("h3",{className:"text-lg font-semibold",children:"Top Borrowers"})}),He.length===0?a.jsx("div",{className:"p-4 text-sm",style:{color:"var(--muted)"},children:"No data available."}):a.jsxs("table",{className:"min-w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:S.th,children:"Name"}),a.jsx("th",{className:S.th,children:"Outstanding"})]})}),a.jsx("tbody",{children:He.map(n=>a.jsxs("tr",{children:[a.jsx("td",{className:S.td,children:n.name}),a.jsx("td",{className:S.td,children:F(n.outstanding)})]},n.id))})]})]}),a.jsxs("div",{className:S.tableWrap,children:[a.jsx("div",{className:"p-4 border-b",style:{borderColor:"var(--border)"},children:a.jsx("h3",{className:"text-lg font-semibold",children:"Upcoming Repayments"})}),Xe.length===0?a.jsx("div",{className:"p-4 text-sm",style:{color:"var(--muted)"},children:"No data available."}):a.jsxs("table",{className:"min-w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:S.th,children:"Borrower"}),a.jsx("th",{className:S.th,children:"Due Date"}),a.jsx("th",{className:S.th,children:"Amount"})]})}),a.jsx("tbody",{children:Xe.map(n=>a.jsxs("tr",{children:[a.jsx("td",{className:S.td,children:n.borrower}),a.jsx("td",{className:S.td,children:n.dueDate}),a.jsx("td",{className:S.td,children:F(n.amount)})]},n.id))})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:`${S.card} p-4`,children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Branch Performance"}),Ze.length===0?a.jsx("p",{className:"text-sm",style:{color:"var(--muted)"},children:"No data available."}):a.jsx(Ee,{width:"100%",height:260,children:a.jsxs(Fe,{data:Ze,children:[a.jsx(Le,{stroke:b.grid,strokeDasharray:"3 3"}),a.jsx(Re,{dataKey:"branch",tick:{fill:b.axis},axisLine:{stroke:b.axis},tickLine:{stroke:b.axis}}),a.jsx(Te,{tick:{fill:b.axis},axisLine:{stroke:b.axis},tickLine:{stroke:b.axis}}),a.jsx(_e,{contentStyle:{backgroundColor:b.tooltipBg,borderColor:b.grid,color:b.tooltipText},wrapperStyle:{outline:"none"}}),a.jsx(Me,{wrapperStyle:{color:b.legend}}),a.jsx(ne,{dataKey:"disbursed",fill:b.bar1}),a.jsx(ne,{dataKey:"repayments",fill:b.bar2})]})})]}),a.jsxs("div",{className:`${S.card} p-4`,children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Officer Performance"}),Ye.length===0?a.jsx("p",{className:"text-sm",style:{color:"var(--muted)"},children:"No data available."}):a.jsx(Ee,{width:"100%",height:260,children:a.jsxs(Fe,{data:Ye,children:[a.jsx(Le,{stroke:b.grid,strokeDasharray:"3 3"}),a.jsx(Re,{dataKey:"officer",tick:{fill:b.axis},axisLine:{stroke:b.axis},tickLine:{stroke:b.axis}}),a.jsx(Te,{tick:{fill:b.axis},axisLine:{stroke:b.axis},tickLine:{stroke:b.axis}}),a.jsx(_e,{contentStyle:{backgroundColor:b.tooltipBg,borderColor:b.grid,color:b.tooltipText},wrapperStyle:{outline:"none"}}),a.jsx(Me,{wrapperStyle:{color:b.legend}}),a.jsx(ne,{dataKey:"loans",fill:b.bar1}),a.jsx(ne,{dataKey:"collections",fill:b.bar2})]})})]})]})]})}),a.jsx("aside",{className:"lg:sticky lg:top-4 self-start",children:a.jsxs("div",{className:`${S.card} p-4`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(ct,{className:"w-5 h-5 text-indigo-600"}),a.jsx("h2",{className:"text-lg font-semibold",children:"Recent Activity"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[a.jsx(Ke,{value:ue,onChange:n=>Ce(n.target.value),className:"h-9"}),a.jsx(Ke,{value:me,onChange:n=>Et(n.target.value),className:"h-9"}),a.jsx("button",{className:`${S.btn} col-span-2 h-9 text-sm`,onClick:()=>{Y(1),H({page:1})},children:"Search by date"})]}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-x-0 top-0 h-6 pointer-events-none bg-gradient-to-b from-[var(--card)] to-transparent"}),a.jsx("div",{className:"absolute inset-x-0 bottom-0 h-6 pointer-events-none bg-gradient-to-t from-[var(--card)] to-transparent"}),a.jsx("div",{className:"max-h-[520px] overflow-y-auto pr-1 space-y-3",children:U.length===0?a.jsx("p",{className:"text-sm",style:{color:"var(--muted)"},children:"No activity."}):U.map(n=>{var i,u,O,B,V;return a.jsxs("div",{className:"rounded-xl p-3 border-2",style:{borderColor:"var(--border)"},children:[a.jsxs("p",{className:"text-sm font-semibold",children:[n.type," • ",n.entityType," #",n.entityId]}),a.jsx("p",{className:"text-xs break-words",style:{color:"var(--fg)"},children:n.message}),a.jsxs("p",{className:"text-[11px] mt-1",style:{color:"var(--muted)"},children:["by ",((i=n.createdBy)==null?void 0:i.name)||((u=n.createdBy)==null?void 0:u.email)," • ",new Date(n.createdAt).toLocaleString()]}),Array.isArray(n.comments)&&n.comments.length>0&&a.jsx("div",{className:"mt-2 space-y-1",children:n.comments.map(E=>{var W,tt;return a.jsxs("div",{className:"rounded p-2 border-2",style:{background:"var(--table-row-even)",borderColor:"var(--border)"},children:[a.jsx("p",{className:"text-xs break-words",style:{color:"var(--fg)"},children:E.comment}),a.jsxs("p",{className:"text-[11px] mt-0.5",style:{color:"var(--muted)"},children:["— ",((W=E.createdBy)==null?void 0:W.name)||((tt=E.createdBy)==null?void 0:tt.email)," • ",new Date(E.createdAt).toLocaleString()]})]},E.id)})}),a.jsxs("div",{className:"mt-2 flex gap-2",children:[a.jsx(vt,{value:Ue[n.id]||"",onChange:E=>Ge(W=>({...W,[n.id]:E.target.value})),placeholder:"Reply…",className:"flex-1 h-9 text-xs"}),a.jsxs("button",{onClick:()=>Wt(n.id),disabled:qe[`c-${n.id}`],className:`${S.btn} h-9 px-2 text-xs disabled:opacity-50 gap-1`,children:[a.jsx(_a,{className:"w-3 h-3"})," Reply"]})]}),a.jsxs("div",{className:"mt-2 grid grid-cols-4 gap-2",children:[a.jsxs(fe,{value:((O=ve[n.id])==null?void 0:O.assigneeId)||"",onChange:E=>ge(W=>({...W,[n.id]:{...W[n.id]||{},assigneeId:E.target.value}})),className:"col-span-2 h-9 text-xs",children:[a.jsx("option",{value:"",children:"Assign to…"}),c.map(E=>a.jsx("option",{value:E.id,children:E.name||E.email},E.id))]}),a.jsx(Ke,{value:((B=ve[n.id])==null?void 0:B.dueDate)||"",onChange:E=>ge(W=>({...W,[n.id]:{...W[n.id]||{},dueDate:E.target.value}})),className:"h-9 text-xs"}),a.jsxs("button",{onClick:()=>Vt(n.id),disabled:qe[`a-${n.id}`],className:`${S.btn} h-9 px-2 text-xs disabled:opacity-50 gap-1`,children:[a.jsx(Ia,{className:"w-3 h-3"})," Assign"]}),a.jsx(vt,{value:((V=ve[n.id])==null?void 0:V.note)||"",onChange:E=>ge(W=>({...W,[n.id]:{...W[n.id]||{},note:E.target.value}})),placeholder:"Note…",className:"col-span-4 h-9 text-xs"})]})]},n.id)})})]}),G>q&&a.jsxs("div",{className:"flex justify-between items-center mt-3 text-xs",style:{color:"var(--fg)"},children:[a.jsxs("span",{children:[Math.min(K*q,G)," of ",G]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>{const n=Math.max(K-1,1);Y(n),H({page:n})},disabled:K===1,className:`${S.btn} px-2 py-1 disabled:opacity-50`,children:"Prev"}),a.jsx("button",{onClick:()=>{const n=K*q<G?K+1:K;n!==K&&(Y(n),H({page:n}))},disabled:K*q>=G,className:`${S.btn} px-2 py-1 disabled:opacity-50`,children:"Next"})]})]})]})})]})]})})},M=({title:t,value:e,icon:r,tone:s="indigo",to:o=null,delta:c=null,deltaLabel:d="",spark:h=null})=>{const g={indigo:"text-indigo-600",sky:"text-sky-600",blue:"text-blue-600",emerald:"text-emerald-600",cyan:"text-cyan-600",amber:"text-amber-600",violet:"text-violet-600",rose:"text-rose-600",slate:"text-slate-500"}[s]||"text-slate-500",p=()=>{if(!Array.isArray(h)||h.length<2)return null;const x=96,y=28,v=2,A=Math.min(...h),N=Math.max(...h),C=Math.max(N-A,1e-6),j=(x-v*2)/(h.length-1),w="M "+h.map((m,P)=>{const k=(v+P*j).toFixed(1),I=(y-v-(m-A)/C*(y-v*2)).toFixed(1);return`${k} ${I}`}).join(" L ");return a.jsx("svg",{width:x,height:y,className:"mt-2 opacity-70",children:a.jsx("path",{d:w,fill:"none",stroke:"currentColor",strokeWidth:"2"})})},f=c==null?"":c>=0?"text-emerald-700 bg-emerald-50 ring-1 ring-emerald-200":"text-rose-700 bg-rose-50 ring-1 ring-rose-200";return a.jsxs("div",{className:"group relative",children:[o&&a.jsx(we,{to:o,className:"absolute inset-0 z-10 rounded-2xl focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[var(--ring)]","aria-label":`View ${t} details`,title:`View ${t} details`}),a.jsxs("div",{className:"relative rounded-2xl p-5 min-h-[10.5rem] shadow transition-all group-hover:shadow-md group-hover:-translate-y-0.5 border-2",style:{background:"var(--card)",borderColor:"var(--border-strong)",color:"var(--fg)"},children:[a.jsxs("div",{className:"relative flex items-start justify-between gap-3",children:[a.jsx("div",{className:`p-3 rounded-full ring-2 ${g}`,style:{background:"var(--card)",boxShadow:"0 1px 0 rgba(0,0,0,.04)"},children:r}),c!=null&&a.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[11px] font-medium ${f}`,children:[c>=0?"↑":"↓"," ",Math.abs(c).toLocaleString(),"%",d&&a.jsxs("span",{className:"opacity-70",children:[" ",d]})]})]}),a.jsxs("div",{className:"relative mt-3 min-w-0",children:[a.jsx("h3",{className:`text-sm font-semibold truncate ${g}`,children:t}),a.jsx("p",{className:"text-[28px] md:text-[32px] leading-tight font-semibold font-mono tabular-nums break-words",children:e??"—"})]}),a.jsx("div",{className:`relative ${g}`,children:a.jsx(p,{})})]})]})};export{ss as default};
