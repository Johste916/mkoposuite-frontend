import{r,j as e}from"./index-C05W7U9P.js";import{S as g}from"./settings-BpXznUQF.js";import"./index-BazTo4xA.js";function A(){const[l,j]=r.useState([]),[m,x]=r.useState(""),[o,n]=r.useState(""),[c,u]=r.useState(!1),[i,y]=r.useState({name:""}),[b,N]=r.useState(!1),h=async()=>{var t,a;u(!0),n("");try{const s=await g.getLoanCategories();j(s||[])}catch(s){n(((a=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:a.message)||s.message)}finally{u(!1)}};r.useEffect(()=>{h()},[]);const w=async()=>{var t,a;if(i.name.trim()){N(!0),n("");try{await g.createLoanCategory({name:i.name.trim()}),y({name:""}),await h()}catch(s){n(((a=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:a.message)||s.message)}finally{N(!1)}}},v=async(t,a)=>{var s,d;try{await g.updateLoanCategory(t,{name:a}),await h()}catch(p){n(((d=(s=p==null?void 0:p.response)==null?void 0:s.data)==null?void 0:d.message)||p.message)}},C=async t=>{var a,s;if(confirm("Delete category?"))try{await g.deleteLoanCategory(t),await h()}catch(d){n(((s=(a=d==null?void 0:d.response)==null?void 0:a.data)==null?void 0:s.message)||d.message)}},f=l.filter(t=>{var a;return(a=t.name)==null?void 0:a.toLowerCase().includes(m.toLowerCase())});return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("header",{className:"bg-white dark:bg-slate-900 border rounded-2xl p-4",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Loan Categories"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("input",{className:"rounded border px-3 py-2 text-sm",placeholder:"Search…",value:m,onChange:t=>x(t.target.value)}),e.jsx("input",{className:"rounded border px-3 py-2 text-sm",placeholder:"New category name",value:i.name,onChange:t=>y({name:t.target.value})}),e.jsx("button",{className:"px-3 py-1.5 rounded bg-blue-600 text-white text-sm",onClick:w,disabled:b,children:b?"Saving…":"Add"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 border rounded-2xl p-4",children:[o&&e.jsx("div",{className:"text-sm text-rose-600 mb-2",children:o}),c?e.jsx("div",{className:"text-sm text-slate-500",children:"Loading…"}):e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-slate-500",children:[e.jsx("th",{className:"py-2",children:"Name"}),e.jsx("th",{className:"py-2 w-40",children:"Action"})]})}),e.jsxs("tbody",{children:[f.map(t=>e.jsx(S,{c:t,onUpdate:v,onDelete:C},t.id)),f.length===0&&e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 text-slate-500",children:"No results."}),e.jsx("td",{})]})]})]})]})]})}function S({c:l,onUpdate:j,onDelete:m}){const[x,o]=r.useState(l.name||""),[n,c]=r.useState(!1),u=async()=>{await j(l.id,x),c(!1)};return e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"py-2",children:n?e.jsx("input",{className:"rounded border px-2 py-1 text-sm",value:x,onChange:i=>o(i.target.value)}):l.name}),e.jsx("td",{className:"py-2",children:n?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white text-xs mr-2",onClick:u,children:"Save"}),e.jsx("button",{className:"px-2 py-1 rounded bg-slate-100 text-xs",onClick:()=>{c(!1),o(l.name||"")},children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"px-2 py-1 rounded bg-slate-100 text-xs mr-2",onClick:()=>c(!0),children:"Edit"}),e.jsx("button",{className:"px-2 py-1 rounded bg-rose-600 text-white text-xs",onClick:()=>m(l.id),children:"Delete"})]})})]})}export{A as default};
