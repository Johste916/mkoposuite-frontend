import{r as c,j as e,L as i,g as p}from"./index-2ZVrRahO.js";async function m(s=[],o={}){let t;for(const n of s)try{const a=await p.get(n,o);return a==null?void 0:a.data}catch(a){t=a}throw t||new Error("No endpoint succeeded")}function h(s){return(Array.isArray(s)?s:(s==null?void 0:s.items)||(s==null?void 0:s.rows)||(s==null?void 0:s.data)||[]).map(t=>{var n,a,l,d;return{id:t.id??t._id??t.groupId??t.code??String(Math.random()),name:t.name??t.groupName??t.title??"—",membersCount:t.membersCount??t.memberCount??((n=t.members)==null?void 0:n.length)??t.size??0,branchName:t.branchName??((a=t.branch)==null?void 0:a.name)??"—",totalLoans:t.totalLoans??t.loanCount??((l=t.stats)==null?void 0:l.loans)??0,outstanding:t.totalLoanAmount??t.outstanding??((d=t.stats)==null?void 0:d.outstanding)??0}})}const j=()=>{const[s,o]=c.useState([]),[t,n]=c.useState(!0),[a,l]=c.useState("");c.useEffect(()=>{const r=new AbortController;return(async()=>{try{n(!0);const x=await m(["/borrowers/groups","/groups","/borrower-groups","/api/borrowers/groups"],{signal:r.signal});o(h(x)),l("")}catch{l("Failed to load groups (endpoint not implemented)."),o([])}finally{n(!1)}})(),()=>r.abort()},[]);const d=r=>`TZS ${Number(r||0).toLocaleString()}`;return e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Borrower Groups"}),e.jsx(i,{to:"/borrowers/groups/add",className:"px-3 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:"Add Group"})]}),e.jsx("div",{className:"bg-white rounded-xl shadow border overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left",children:"Name"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Members"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Branch"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Loans"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Outstanding"}),e.jsx("th",{className:"px-3 py-2 text-right pr-4",children:"Actions"})]})}),e.jsx("tbody",{children:t?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"p-4 text-gray-500",children:"Loading…"})}):a?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"p-4 text-red-600",children:a})}):s.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"p-4 text-gray-500",children:"No groups yet."})}):s.map(r=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-3 py-2",children:r.name}),e.jsx("td",{className:"px-3 py-2",children:r.membersCount}),e.jsx("td",{className:"px-3 py-2",children:r.branchName}),e.jsx("td",{className:"px-3 py-2",children:r.totalLoans}),e.jsx("td",{className:"px-3 py-2",children:d(r.outstanding)}),e.jsx("td",{className:"px-3 py-2 text-right",children:e.jsx(i,{to:`/borrowers/groups/${encodeURIComponent(r.id)}`,className:"text-indigo-600 hover:text-indigo-800 hover:underline",children:"View"})})]},r.id))})]})})]})};export{j as default};
