import{r as l,j as e,b as d}from"./index-CMgmpHUd.js";function w(){const[b,x]=l.useState(!0),[n,i]=l.useState(!1),[u,m]=l.useState(""),[g,h]=l.useState(""),[c,o]=l.useState(""),[p,a]=l.useState(""),f=async()=>{x(!0),a("");try{const{data:t}=await d.get("/auth/2fa/status");i(!!t.enabled)}catch{a("Failed to load 2FA status")}finally{x(!1)}};l.useEffect(()=>{f()},[]);const j=async()=>{var t,r;a("");try{const{data:s}=await d.post("/auth/2fa/setup");m(s.secret),h(s.otpauthUrl)}catch(s){a(((r=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:r.message)||"Failed to start setup")}},v=async()=>{var t,r;a("");try{await d.post("/auth/2fa/verify",{token:c}),i(!0),m(""),h(""),o("")}catch(s){a(((r=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:r.message)||"Invalid code")}},y=async()=>{var t,r;a("");try{await d.post("/auth/2fa/disable",{token:c}),i(!1),o("")}catch(s){a(((r=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:r.message)||"Failed to disable")}};return b?e.jsx("div",{className:"p-4 text-sm text-slate-500",children:"Loading…"}):e.jsxs("div",{className:"bg-white dark:bg-slate-900 border rounded-2xl p-4 max-w-xl",children:[e.jsx("h1",{className:"text-lg font-semibold",children:"Two-Factor Authentication"}),e.jsxs("p",{className:"text-sm text-slate-500 mt-1",children:["Status: ",e.jsx("span",{className:n?"text-green-600":"text-rose-600",children:n?"Enabled":"Disabled"})]}),!!p&&e.jsx("div",{className:"mt-3 text-sm text-rose-600",children:p}),!n&&e.jsx("div",{className:"mt-4 space-y-3",children:u?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Secret:"}),e.jsx("div",{className:"font-mono break-all",children:u}),e.jsx("div",{className:"mt-1 text-slate-500",children:"Scan the QR (using “Enter a setup key”) or paste secret in your authenticator app."})]}),e.jsx("div",{className:"text-xs break-all",children:g}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"border rounded px-2 py-1 text-sm",placeholder:"Enter 6-digit code",value:c,onChange:t=>o(t.target.value)}),e.jsx("button",{onClick:v,className:"px-3 py-1.5 rounded bg-emerald-600 text-white hover:bg-emerald-700",children:"Verify & Turn On"})]})]}):e.jsx("button",{onClick:j,className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Enable 2FA"})}),n&&e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx("div",{className:"text-sm text-slate-500",children:"To disable, confirm a current code from your authenticator app."}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"border rounded px-2 py-1 text-sm",placeholder:"Enter 6-digit code",value:c,onChange:t=>o(t.target.value)}),e.jsx("button",{onClick:y,className:"px-3 py-1.5 rounded bg-rose-600 text-white hover:bg-rose-700",children:"Disable 2FA"})]})]})]})}export{w as default};
