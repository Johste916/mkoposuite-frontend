import{i as b,u as N,r as o,g as d,j as e,L as g}from"./index-BR01ehMu.js";import{S as j}from"./save-B_rpl3CG.js";import"./createLucideIcon-S-tXfS_2.js";const y="bg-white rounded-2xl shadow-sm ring-1 ring-black/5 p-5 md:p-7",c="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500/40 focus:border-indigo-500 transition-all";function C(){const{id:i}=b(),r=!!i,h=N(),[a,t]=o.useState({name:"",code:"",branch:"",accountName:"",accountNumber:"",swift:"",phone:"",address:"",currency:"TZS",openingBalance:"",currentBalance:"",isActive:!0}),[u,x]=o.useState(!1),[p,m]=o.useState(r);o.useEffect(()=>{if(!r)return;const s=new AbortController;return(async()=>{m(!0);try{const l=(await d.get(`/banks/${i}`,{signal:s.signal})).data||{};t({name:l.name||"",code:l.code||"",branch:l.branch||"",accountName:l.accountName||"",accountNumber:l.accountNumber||"",swift:l.swift||"",phone:l.phone||"",address:l.address||"",currency:l.currency||"TZS",openingBalance:l.openingBalance??"",currentBalance:l.currentBalance??"",isActive:l.isActive!==!1})}catch(n){(n==null?void 0:n.code)!=="ERR_CANCELED"&&(console.error(n),alert((n==null?void 0:n.normalizedMessage)||"Failed to load bank"))}finally{m(!1)}})(),()=>s.abort()},[i,r]);const v=async s=>{if(s.preventDefault(),!a.name.trim())return alert("Bank name is required.");x(!0);try{const n={...a,openingBalance:a.openingBalance===""?r?null:0:Number(a.openingBalance),currentBalance:a.currentBalance===""?r?null:a.openingBalance===""?0:Number(a.openingBalance):Number(a.currentBalance)};r?await d.put(`/banks/${i}`,n):await d.post("/banks",n),h("/banks")}catch(n){console.error(n),alert((n==null?void 0:n.normalizedMessage)||"Failed to save bank")}finally{x(!1)}};return e.jsxs("div",{className:"p-4 md:p-6 lg:p-8",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:r?"Edit Bank":"Add Bank"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Banks are used for disbursing loans and receiving repayments."})]}),e.jsx(g,{to:"/banks",className:"text-indigo-600 hover:underline text-sm",children:"Back to Banks"})]}),e.jsx("form",{onSubmit:v,className:y,children:p?e.jsx("p",{className:"text-sm text-gray-500",children:"Loading…"}):e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Name"}),e.jsx("input",{className:c,value:a.name,onChange:s=>t({...a,name:s.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Code (optional)"}),e.jsx("input",{className:c,value:a.code,onChange:s=>t({...a,code:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Branch (optional)"}),e.jsx("input",{className:c,value:a.branch,onChange:s=>t({...a,branch:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Account Name (optional)"}),e.jsx("input",{className:c,value:a.accountName,onChange:s=>t({...a,accountName:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Account Number (optional)"}),e.jsx("input",{className:c,value:a.accountNumber,onChange:s=>t({...a,accountNumber:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"SWIFT (optional)"}),e.jsx("input",{className:c,value:a.swift,onChange:s=>t({...a,swift:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Phone (optional)"}),e.jsx("input",{className:c,value:a.phone,onChange:s=>t({...a,phone:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Currency"}),e.jsx("input",{className:c,value:a.currency,onChange:s=>t({...a,currency:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Opening Balance"}),e.jsx("input",{type:"number",step:"0.01",className:c,value:a.openingBalance,onChange:s=>t({...a,openingBalance:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Current Balance (optional)"}),e.jsx("input",{type:"number",step:"0.01",className:c,value:a.currentBalance,onChange:s=>t({...a,currentBalance:s.target.value})})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Address (optional)"}),e.jsx("textarea",{className:`${c} min-h-[84px]`,value:a.address,onChange:s=>t({...a,address:s.target.value})})]}),e.jsxs("div",{className:"md:col-span-2 flex items-center gap-2",children:[e.jsx("input",{id:"active",type:"checkbox",checked:a.isActive,onChange:s=>t({...a,isActive:s.target.checked})}),e.jsx("label",{htmlFor:"active",className:"text-sm text-gray-700",children:"Active"})]}),e.jsxs("div",{className:"md:col-span-2 flex justify-end gap-3 pt-2",children:[e.jsx(g,{to:"/banks",className:"px-4 py-2 rounded-xl border hover:bg-gray-50",children:"Cancel"}),e.jsxs("button",{disabled:u,type:"submit",className:"inline-flex items-center gap-2 px-4 py-2 rounded-xl bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-60 disabled:cursor-not-allowed shadow-sm",children:[e.jsx(j,{className:"h-4 w-4"}),u?"Saving…":"Save"]})]})]})})]})}export{C as default};
