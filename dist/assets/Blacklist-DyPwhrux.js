import{r,j as e,g as d}from"./index-BVWWaTks.js";const N=()=>{const[c,i]=r.useState([]),[b,x]=r.useState(!0),[p,m]=r.useState(""),[s,h]=r.useState({borrowerId:"",reason:"",until:""}),o=async t=>{var a,u;try{x(!0);const l=await d.get("/borrowers/blacklist/list",{signal:t}),y=Array.isArray(l.data)?l.data:((a=l.data)==null?void 0:a.items)||((u=l.data)==null?void 0:u.data)||[];i(y),m("")}catch{m("Failed to load blacklist"),i([])}finally{x(!1)}};r.useEffect(()=>{const t=new AbortController;return o(t.signal),()=>t.abort()},[]);const n=t=>h(a=>({...a,[t.target.name]:t.target.value})),g=async t=>{if(t.preventDefault(),!!s.borrowerId)try{await d.post(`/borrowers/${encodeURIComponent(s.borrowerId)}/blacklist`,{reason:s.reason||null,until:s.until||null}),h({borrowerId:"",reason:"",until:""}),await o()}catch{alert("Failed to blacklist")}},j=async t=>{try{await d.delete(`/borrowers/${encodeURIComponent(t)}/blacklist`),await o()}catch{}};return e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Blacklist"}),e.jsxs("form",{onSubmit:g,className:"bg-white rounded-xl border shadow p-4 space-y-3 max-w-2xl",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsx("input",{name:"borrowerId",placeholder:"Borrower ID",className:"border rounded-lg px-3 py-2",value:s.borrowerId,onChange:n,required:!0}),e.jsx("input",{name:"reason",placeholder:"Reason",className:"border rounded-lg px-3 py-2",value:s.reason,onChange:n}),e.jsx("input",{name:"until",type:"date",className:"border rounded-lg px-3 py-2",value:s.until,onChange:n})]}),e.jsx("button",{className:"px-4 py-2 rounded-lg bg-rose-600 text-white hover:bg-rose-700",children:"Add to Blacklist"})]}),e.jsx("div",{className:"bg-white rounded-xl shadow border overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left",children:"Borrower"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Reason"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Until"}),e.jsx("th",{className:"px-3 py-2 text-right pr-4",children:"Actions"})]})}),e.jsx("tbody",{children:b?e.jsx("tr",{children:e.jsx("td",{className:"p-4 text-gray-500",colSpan:4,children:"Loading…"})}):p?e.jsx("tr",{children:e.jsx("td",{className:"p-4 text-red-600",colSpan:4,children:p})}):c.length===0?e.jsx("tr",{children:e.jsx("td",{className:"p-4 text-gray-500",colSpan:4,children:"No blacklisted borrowers."})}):c.map(t=>{const a=t.name||`${t.firstName||""} ${t.lastName||""}`.trim()||t.id;return e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-3 py-2",children:a}),e.jsx("td",{className:"px-3 py-2",children:t.reason||"—"}),e.jsx("td",{className:"px-3 py-2",children:t.until?new Date(t.until).toLocaleDateString():"—"}),e.jsx("td",{className:"px-3 py-2 text-right",children:e.jsx("button",{className:"px-2 py-1 border rounded hover:bg-gray-50",onClick:()=>j(t.id),children:"Remove"})})]},t.id)})})]})})]})};export{N as default};
