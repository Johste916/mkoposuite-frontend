import{r as a,j as e}from"./index-DzNpvMXd.js";import{u as b}from"./repayments-ByRlRBb-.js";function C(){const[o,f]=a.useState(null),[d,j]=a.useState("YYYY-MM-DD"),[i,g]=a.useState(""),[r,v]=a.useState(!1),[c,n]=a.useState(""),[m,p]=a.useState(null),[u,x]=a.useState(!1),y=async s=>{var t,h;if(s.preventDefault(),!o)return n("Choose a CSV file.");x(!0),n(""),p(null);try{const l=await b(o,{dateFormat:d,method:i||void 0,waivePenalties:r?"1":"0"});p(l),n("Uploaded.")}catch(l){n(((h=(t=l==null?void 0:l.response)==null?void 0:t.data)==null?void 0:h.error)||"Upload failed")}finally{x(!1)}};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white border rounded-xl shadow p-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Upload Repayments CSV"}),e.jsx("p",{className:"text-sm text-gray-500",children:"CSV columns: loanReference (or loanId), amount, date, method, notes"}),e.jsxs("form",{onSubmit:y,className:"grid md:grid-cols-3 gap-4 mt-4",children:[e.jsxs("div",{className:"space-y-1 md:col-span-2",children:[e.jsx("label",{className:"text-sm",children:"CSV File"}),e.jsx("input",{type:"file",accept:".csv",onChange:s=>{var t;return f((t=s.target.files)==null?void 0:t[0])}})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm",children:"Date format"}),e.jsx("input",{className:"w-full border rounded px-3 py-2",value:d,onChange:s=>j(s.target.value),placeholder:"YYYY-MM-DD"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm",children:"Default Method (optional)"}),e.jsxs("select",{className:"w-full border rounded px-3 py-2",value:i,onChange:s=>g(s.target.value),children:[e.jsx("option",{value:"",children:"(use per-row)"}),e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"mobile_money",children:"Mobile Money"}),e.jsx("option",{value:"bank",children:"Bank Transfer"})]})]}),e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:r,onChange:s=>v(s.target.checked)}),e.jsx("span",{className:"text-sm",children:"Waive penalties for all rows"})]}),e.jsx("div",{className:"md:col-span-3 flex gap-2 justify-end",children:e.jsx("button",{type:"submit",className:"px-3 py-2 rounded bg-blue-600 text-white disabled:opacity-60",disabled:u,children:u?"Uploadingâ€¦":"Upload"})})]}),!!c&&e.jsx("div",{className:"mt-3 text-sm",children:c}),!!m&&e.jsx("pre",{className:"mt-3 p-3 bg-gray-50 border rounded text-xs overflow-auto",children:JSON.stringify(m,null,2)})]})})}export{C as default};
