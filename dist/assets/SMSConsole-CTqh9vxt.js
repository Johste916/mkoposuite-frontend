import{r as t,j as s,b as r}from"./index-Bebmb2Ue.js";function b(){const[n,y]=t.useState(""),[i,l]=t.useState(""),[c,o]=t.useState(!1),[h,x]=t.useState(null),[g,a]=t.useState(""),[u,j]=t.useState([]);async function p(){a("");try{const e=await r.getFirst(["/sms/balance","/billing/sms/balance","/notifications/sms/balance"]);x(e)}catch{x(null)}}async function m(){try{const e=await r.getFirst(["/sms/messages","/notifications/sms/messages","/communications/sms"]),d=Array.isArray(e)?e:e.items||e.messages||[];j(d.slice(0,50))}catch{j([])}}t.useEffect(()=>{p(),m()},[]);async function f(){if(!(!n.trim()||!i.trim())){o(!0),a("");try{const e={to:n.trim(),text:i.trim()},d=await r.postFirst(["/sms/send","/communications/sms/send","/notifications/sms"],e);return l(""),await m(),d}catch(e){a(e.normalizedMessage||"Failed to send SMS.")}finally{o(!1)}}}return s.jsxs("div",{style:{padding:16},children:[s.jsx("h1",{children:"SMS Console"}),h&&s.jsxs("div",{className:"card",style:{border:"1px solid #ddd",padding:12,borderRadius:8,marginBottom:12},children:[s.jsx("b",{children:"Balance:"})," ",s.jsx("code",{children:JSON.stringify(h)})]}),s.jsxs("div",{className:"card",style:{border:"1px solid #ddd",padding:16,borderRadius:8,marginBottom:16},children:[s.jsx("h3",{style:{marginTop:0},children:"Send SMS"}),s.jsxs("div",{style:{display:"grid",gap:8,maxWidth:520},children:[s.jsx("input",{placeholder:"Phone number (E.164 preferred, e.g. +2557...)",value:n,onChange:e=>y(e.target.value)}),s.jsx("textarea",{placeholder:"Message text",rows:3,value:i,onChange:e=>l(e.target.value)}),s.jsx("div",{children:s.jsx("button",{onClick:f,disabled:c,children:c?"Sending…":"Send"})}),g?s.jsx("p",{style:{color:"crimson"},children:g}):null]})]}),s.jsx("h3",{children:"Recent Messages"}),u.length===0?s.jsx("p",{style:{opacity:.7},children:"No messages yet."}):s.jsxs("table",{width:"100%",cellPadding:8,children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{align:"left",children:"ID"}),s.jsx("th",{align:"left",children:"To"}),s.jsx("th",{align:"left",children:"Status"}),s.jsx("th",{align:"left",children:"Text"}),s.jsx("th",{align:"left",children:"At"})]})}),s.jsx("tbody",{children:u.map(e=>s.jsxs("tr",{children:[s.jsx("td",{children:e.id||e.messageId}),s.jsx("td",{children:e.to||e.phone||e.msisdn}),s.jsx("td",{children:e.status||e.deliveryStatus||"—"}),s.jsx("td",{children:e.text||e.body}),s.jsx("td",{children:e.createdAt||e.sentAt||e.timestamp})]},e.id||e.messageId))})]})]})}export{b as default};
